{"ast":null,"code":"/*!\n * Viewer.js v1.11.6\n * https://fengyuanchen.github.io/viewerjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2023-09-17T03:16:38.052Z\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.Viewer = factory());\n})(this, function () {\n  'use strict';\n\n  function ownKeys(e, r) {\n    var t = Object.keys(e);\n\n    if (Object.getOwnPropertySymbols) {\n      var o = Object.getOwnPropertySymbols(e);\n      r && (o = o.filter(function (r) {\n        return Object.getOwnPropertyDescriptor(e, r).enumerable;\n      })), t.push.apply(t, o);\n    }\n\n    return t;\n  }\n\n  function _objectSpread2(e) {\n    for (var r = 1; r < arguments.length; r++) {\n      var t = null != arguments[r] ? arguments[r] : {};\n      r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n        _defineProperty(e, r, t[r]);\n      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n        Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n      });\n    }\n\n    return e;\n  }\n\n  function _typeof(o) {\n    \"@babel/helpers - typeof\";\n\n    return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n      return typeof o;\n    } : function (o) {\n      return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n    }, _typeof(o);\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    Object.defineProperty(Constructor, \"prototype\", {\n      writable: false\n    });\n    return Constructor;\n  }\n\n  function _defineProperty(obj, key, value) {\n    key = _toPropertyKey(key);\n\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function _toPrimitive(input, hint) {\n    if (typeof input !== \"object\" || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || \"default\");\n      if (typeof res !== \"object\") return res;\n      throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n    }\n\n    return (hint === \"string\" ? String : Number)(input);\n  }\n\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, \"string\");\n\n    return typeof key === \"symbol\" ? key : String(key);\n  }\n\n  var DEFAULTS = {\n    /**\n     * Enable a modal backdrop, specify `static` for a backdrop\n     * which doesn't close the modal on click.\n     * @type {boolean}\n     */\n    backdrop: true,\n\n    /**\n     * Show the button on the top-right of the viewer.\n     * @type {boolean}\n     */\n    button: true,\n\n    /**\n     * Show the navbar.\n     * @type {boolean | number}\n     */\n    navbar: true,\n\n    /**\n     * Specify the visibility and the content of the title.\n     * @type {boolean | number | Function | Array}\n     */\n    title: true,\n\n    /**\n     * Show the toolbar.\n     * @type {boolean | number | Object}\n     */\n    toolbar: true,\n\n    /**\n     * Custom class name(s) to add to the viewer's root element.\n     * @type {string}\n     */\n    className: '',\n\n    /**\n     * Define where to put the viewer in modal mode.\n     * @type {string | Element}\n     */\n    container: 'body',\n\n    /**\n     * Filter the images for viewing. Return true if the image is viewable.\n     * @type {Function}\n     */\n    filter: null,\n\n    /**\n     * Enable to request fullscreen when play.\n     * {@link https://developer.mozilla.org/en-US/docs/Web/API/FullscreenOptions}\n     * @type {boolean|FullscreenOptions}\n     */\n    fullscreen: true,\n\n    /**\n     * Define the extra attributes to inherit from the original image.\n     * @type {Array}\n     */\n    inheritedAttributes: ['crossOrigin', 'decoding', 'isMap', 'loading', 'referrerPolicy', 'sizes', 'srcset', 'useMap'],\n\n    /**\n     * Define the initial coverage of the viewing image.\n     * @type {number}\n     */\n    initialCoverage: 0.9,\n\n    /**\n     * Define the initial index of the image for viewing.\n     * @type {number}\n     */\n    initialViewIndex: 0,\n\n    /**\n     * Enable inline mode.\n     * @type {boolean}\n     */\n    inline: false,\n\n    /**\n     * The amount of time to delay between automatically cycling an image when playing.\n     * @type {number}\n     */\n    interval: 5000,\n\n    /**\n     * Enable keyboard support.\n     * @type {boolean}\n     */\n    keyboard: true,\n\n    /**\n     * Focus the viewer when initialized.\n     * @type {boolean}\n     */\n    focus: true,\n\n    /**\n     * Indicate if show a loading spinner when load image or not.\n     * @type {boolean}\n     */\n    loading: true,\n\n    /**\n     * Indicate if enable loop viewing or not.\n     * @type {boolean}\n     */\n    loop: true,\n\n    /**\n     * Min width of the viewer in inline mode.\n     * @type {number}\n     */\n    minWidth: 200,\n\n    /**\n     * Min height of the viewer in inline mode.\n     * @type {number}\n     */\n    minHeight: 100,\n\n    /**\n     * Enable to move the image.\n     * @type {boolean}\n     */\n    movable: true,\n\n    /**\n     * Enable to rotate the image.\n     * @type {boolean}\n     */\n    rotatable: true,\n\n    /**\n     * Enable to scale the image.\n     * @type {boolean}\n     */\n    scalable: true,\n\n    /**\n     * Enable to zoom the image.\n     * @type {boolean}\n     */\n    zoomable: true,\n\n    /**\n     * Enable to zoom the current image by dragging on the touch screen.\n     * @type {boolean}\n     */\n    zoomOnTouch: true,\n\n    /**\n     * Enable to zoom the image by wheeling mouse.\n     * @type {boolean}\n     */\n    zoomOnWheel: true,\n\n    /**\n     * Enable to slide to the next or previous image by swiping on the touch screen.\n     * @type {boolean}\n     */\n    slideOnTouch: true,\n\n    /**\n     * Indicate if toggle the image size between its natural size\n     * and initial size when double click on the image or not.\n     * @type {boolean}\n     */\n    toggleOnDblclick: true,\n\n    /**\n     * Show the tooltip with image ratio (percentage) when zoom in or zoom out.\n     * @type {boolean}\n     */\n    tooltip: true,\n\n    /**\n     * Enable CSS3 Transition for some special elements.\n     * @type {boolean}\n     */\n    transition: true,\n\n    /**\n     * Define the CSS `z-index` value of viewer in modal mode.\n     * @type {number}\n     */\n    zIndex: 2015,\n\n    /**\n     * Define the CSS `z-index` value of viewer in inline mode.\n     * @type {number}\n     */\n    zIndexInline: 0,\n\n    /**\n     * Define the ratio when zoom the image by wheeling mouse.\n     * @type {number}\n     */\n    zoomRatio: 0.1,\n\n    /**\n     * Define the min ratio of the image when zoom out.\n     * @type {number}\n     */\n    minZoomRatio: 0.01,\n\n    /**\n     * Define the max ratio of the image when zoom in.\n     * @type {number}\n     */\n    maxZoomRatio: 100,\n\n    /**\n     * Define where to get the original image URL for viewing.\n     * @type {string | Function}\n     */\n    url: 'src',\n\n    /**\n     * Event shortcuts.\n     * @type {Function}\n     */\n    ready: null,\n    show: null,\n    shown: null,\n    hide: null,\n    hidden: null,\n    view: null,\n    viewed: null,\n    move: null,\n    moved: null,\n    rotate: null,\n    rotated: null,\n    scale: null,\n    scaled: null,\n    zoom: null,\n    zoomed: null,\n    play: null,\n    stop: null\n  };\n  var TEMPLATE = '<div class=\"viewer-container\" tabindex=\"-1\" touch-action=\"none\">' + '<div class=\"viewer-canvas\"></div>' + '<div class=\"viewer-footer\">' + '<div class=\"viewer-title\"></div>' + '<div class=\"viewer-toolbar\"></div>' + '<div class=\"viewer-navbar\">' + '<ul class=\"viewer-list\" role=\"navigation\"></ul>' + '</div>' + '</div>' + '<div class=\"viewer-tooltip\" role=\"alert\" aria-hidden=\"true\"></div>' + '<div class=\"viewer-button\" data-viewer-action=\"mix\" role=\"button\"></div>' + '<div class=\"viewer-player\"></div>' + '</div>';\n  var IS_BROWSER = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  var WINDOW = IS_BROWSER ? window : {};\n  var IS_TOUCH_DEVICE = IS_BROWSER && WINDOW.document.documentElement ? 'ontouchstart' in WINDOW.document.documentElement : false;\n  var HAS_POINTER_EVENT = IS_BROWSER ? 'PointerEvent' in WINDOW : false;\n  var NAMESPACE = 'viewer'; // Actions\n\n  var ACTION_MOVE = 'move';\n  var ACTION_SWITCH = 'switch';\n  var ACTION_ZOOM = 'zoom'; // Classes\n\n  var CLASS_ACTIVE = \"\".concat(NAMESPACE, \"-active\");\n  var CLASS_CLOSE = \"\".concat(NAMESPACE, \"-close\");\n  var CLASS_FADE = \"\".concat(NAMESPACE, \"-fade\");\n  var CLASS_FIXED = \"\".concat(NAMESPACE, \"-fixed\");\n  var CLASS_FULLSCREEN = \"\".concat(NAMESPACE, \"-fullscreen\");\n  var CLASS_FULLSCREEN_EXIT = \"\".concat(NAMESPACE, \"-fullscreen-exit\");\n  var CLASS_HIDE = \"\".concat(NAMESPACE, \"-hide\");\n  var CLASS_HIDE_MD_DOWN = \"\".concat(NAMESPACE, \"-hide-md-down\");\n  var CLASS_HIDE_SM_DOWN = \"\".concat(NAMESPACE, \"-hide-sm-down\");\n  var CLASS_HIDE_XS_DOWN = \"\".concat(NAMESPACE, \"-hide-xs-down\");\n  var CLASS_IN = \"\".concat(NAMESPACE, \"-in\");\n  var CLASS_INVISIBLE = \"\".concat(NAMESPACE, \"-invisible\");\n  var CLASS_LOADING = \"\".concat(NAMESPACE, \"-loading\");\n  var CLASS_MOVE = \"\".concat(NAMESPACE, \"-move\");\n  var CLASS_OPEN = \"\".concat(NAMESPACE, \"-open\");\n  var CLASS_SHOW = \"\".concat(NAMESPACE, \"-show\");\n  var CLASS_TRANSITION = \"\".concat(NAMESPACE, \"-transition\"); // Native events\n\n  var EVENT_CLICK = 'click';\n  var EVENT_DBLCLICK = 'dblclick';\n  var EVENT_DRAG_START = 'dragstart';\n  var EVENT_FOCUSIN = 'focusin';\n  var EVENT_KEY_DOWN = 'keydown';\n  var EVENT_LOAD = 'load';\n  var EVENT_ERROR = 'error';\n  var EVENT_TOUCH_END = IS_TOUCH_DEVICE ? 'touchend touchcancel' : 'mouseup';\n  var EVENT_TOUCH_MOVE = IS_TOUCH_DEVICE ? 'touchmove' : 'mousemove';\n  var EVENT_TOUCH_START = IS_TOUCH_DEVICE ? 'touchstart' : 'mousedown';\n  var EVENT_POINTER_DOWN = HAS_POINTER_EVENT ? 'pointerdown' : EVENT_TOUCH_START;\n  var EVENT_POINTER_MOVE = HAS_POINTER_EVENT ? 'pointermove' : EVENT_TOUCH_MOVE;\n  var EVENT_POINTER_UP = HAS_POINTER_EVENT ? 'pointerup pointercancel' : EVENT_TOUCH_END;\n  var EVENT_RESIZE = 'resize';\n  var EVENT_TRANSITION_END = 'transitionend';\n  var EVENT_WHEEL = 'wheel'; // Custom events\n\n  var EVENT_READY = 'ready';\n  var EVENT_SHOW = 'show';\n  var EVENT_SHOWN = 'shown';\n  var EVENT_HIDE = 'hide';\n  var EVENT_HIDDEN = 'hidden';\n  var EVENT_VIEW = 'view';\n  var EVENT_VIEWED = 'viewed';\n  var EVENT_MOVE = 'move';\n  var EVENT_MOVED = 'moved';\n  var EVENT_ROTATE = 'rotate';\n  var EVENT_ROTATED = 'rotated';\n  var EVENT_SCALE = 'scale';\n  var EVENT_SCALED = 'scaled';\n  var EVENT_ZOOM = 'zoom';\n  var EVENT_ZOOMED = 'zoomed';\n  var EVENT_PLAY = 'play';\n  var EVENT_STOP = 'stop'; // Data keys\n\n  var DATA_ACTION = \"\".concat(NAMESPACE, \"Action\"); // RegExps\n\n  var REGEXP_SPACES = /\\s\\s*/; // Misc\n\n  var BUTTONS = ['zoom-in', 'zoom-out', 'one-to-one', 'reset', 'prev', 'play', 'next', 'rotate-left', 'rotate-right', 'flip-horizontal', 'flip-vertical'];\n  /**\n   * Check if the given value is a string.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a string, else `false`.\n   */\n\n  function isString(value) {\n    return typeof value === 'string';\n  }\n  /**\n   * Check if the given value is not a number.\n   */\n\n\n  var isNaN = Number.isNaN || WINDOW.isNaN;\n  /**\n   * Check if the given value is a number.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a number, else `false`.\n   */\n\n  function isNumber(value) {\n    return typeof value === 'number' && !isNaN(value);\n  }\n  /**\n   * Check if the given value is undefined.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is undefined, else `false`.\n   */\n\n\n  function isUndefined(value) {\n    return typeof value === 'undefined';\n  }\n  /**\n   * Check if the given value is an object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is an object, else `false`.\n   */\n\n\n  function isObject(value) {\n    return _typeof(value) === 'object' && value !== null;\n  }\n\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n  /**\n   * Check if the given value is a plain object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a plain object, else `false`.\n   */\n\n  function isPlainObject(value) {\n    if (!isObject(value)) {\n      return false;\n    }\n\n    try {\n      var _constructor = value.constructor;\n      var prototype = _constructor.prototype;\n      return _constructor && prototype && hasOwnProperty.call(prototype, 'isPrototypeOf');\n    } catch (error) {\n      return false;\n    }\n  }\n  /**\n   * Check if the given value is a function.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a function, else `false`.\n   */\n\n\n  function isFunction(value) {\n    return typeof value === 'function';\n  }\n  /**\n   * Iterate the given data.\n   * @param {*} data - The data to iterate.\n   * @param {Function} callback - The process function for each element.\n   * @returns {*} The original data.\n   */\n\n\n  function forEach(data, callback) {\n    if (data && isFunction(callback)) {\n      if (Array.isArray(data) || isNumber(data.length)\n      /* array-like */\n      ) {\n        var length = data.length;\n        var i;\n\n        for (i = 0; i < length; i += 1) {\n          if (callback.call(data, data[i], i, data) === false) {\n            break;\n          }\n        }\n      } else if (isObject(data)) {\n        Object.keys(data).forEach(function (key) {\n          callback.call(data, data[key], key, data);\n        });\n      }\n    }\n\n    return data;\n  }\n  /**\n   * Extend the given object.\n   * @param {*} obj - The object to be extended.\n   * @param {*} args - The rest objects which will be merged to the first object.\n   * @returns {Object} The extended object.\n   */\n\n\n  var assign = Object.assign || function assign(obj) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    if (isObject(obj) && args.length > 0) {\n      args.forEach(function (arg) {\n        if (isObject(arg)) {\n          Object.keys(arg).forEach(function (key) {\n            obj[key] = arg[key];\n          });\n        }\n      });\n    }\n\n    return obj;\n  };\n\n  var REGEXP_SUFFIX = /^(?:width|height|left|top|marginLeft|marginTop)$/;\n  /**\n   * Apply styles to the given element.\n   * @param {Element} element - The target element.\n   * @param {Object} styles - The styles for applying.\n   */\n\n  function setStyle(element, styles) {\n    var style = element.style;\n    forEach(styles, function (value, property) {\n      if (REGEXP_SUFFIX.test(property) && isNumber(value)) {\n        value += 'px';\n      }\n\n      style[property] = value;\n    });\n  }\n  /**\n   * Escape a string for using in HTML.\n   * @param {String} value - The string to escape.\n   * @returns {String} Returns the escaped string.\n   */\n\n\n  function escapeHTMLEntities(value) {\n    return isString(value) ? value.replace(/&(?!amp;|quot;|#39;|lt;|gt;)/g, '&amp;').replace(/\"/g, '&quot;').replace(/'/g, '&#39;').replace(/</g, '&lt;').replace(/>/g, '&gt;') : value;\n  }\n  /**\n   * Check if the given element has a special class.\n   * @param {Element} element - The element to check.\n   * @param {string} value - The class to search.\n   * @returns {boolean} Returns `true` if the special class was found.\n   */\n\n\n  function hasClass(element, value) {\n    if (!element || !value) {\n      return false;\n    }\n\n    return element.classList ? element.classList.contains(value) : element.className.indexOf(value) > -1;\n  }\n  /**\n   * Add classes to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be added.\n   */\n\n\n  function addClass(element, value) {\n    if (!element || !value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        addClass(elem, value);\n      });\n      return;\n    }\n\n    if (element.classList) {\n      element.classList.add(value);\n      return;\n    }\n\n    var className = element.className.trim();\n\n    if (!className) {\n      element.className = value;\n    } else if (className.indexOf(value) < 0) {\n      element.className = \"\".concat(className, \" \").concat(value);\n    }\n  }\n  /**\n   * Remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be removed.\n   */\n\n\n  function removeClass(element, value) {\n    if (!element || !value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        removeClass(elem, value);\n      });\n      return;\n    }\n\n    if (element.classList) {\n      element.classList.remove(value);\n      return;\n    }\n\n    if (element.className.indexOf(value) >= 0) {\n      element.className = element.className.replace(value, '');\n    }\n  }\n  /**\n   * Add or remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be toggled.\n   * @param {boolean} added - Add only.\n   */\n\n\n  function toggleClass(element, value, added) {\n    if (!value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        toggleClass(elem, value, added);\n      });\n      return;\n    } // IE10-11 doesn't support the second parameter of `classList.toggle`\n\n\n    if (added) {\n      addClass(element, value);\n    } else {\n      removeClass(element, value);\n    }\n  }\n\n  var REGEXP_HYPHENATE = /([a-z\\d])([A-Z])/g;\n  /**\n   * Transform the given string from camelCase to kebab-case\n   * @param {string} value - The value to transform.\n   * @returns {string} The transformed value.\n   */\n\n  function hyphenate(value) {\n    return value.replace(REGEXP_HYPHENATE, '$1-$2').toLowerCase();\n  }\n  /**\n   * Get data from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to get.\n   * @returns {string} The data value.\n   */\n\n\n  function getData(element, name) {\n    if (isObject(element[name])) {\n      return element[name];\n    }\n\n    if (element.dataset) {\n      return element.dataset[name];\n    }\n\n    return element.getAttribute(\"data-\".concat(hyphenate(name)));\n  }\n  /**\n   * Set data to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to set.\n   * @param {string} data - The data value.\n   */\n\n\n  function setData(element, name, data) {\n    if (isObject(data)) {\n      element[name] = data;\n    } else if (element.dataset) {\n      element.dataset[name] = data;\n    } else {\n      element.setAttribute(\"data-\".concat(hyphenate(name)), data);\n    }\n  }\n\n  var onceSupported = function () {\n    var supported = false;\n\n    if (IS_BROWSER) {\n      var once = false;\n\n      var listener = function listener() {};\n\n      var options = Object.defineProperty({}, 'once', {\n        get: function get() {\n          supported = true;\n          return once;\n        },\n\n        /**\n         * This setter can fix a `TypeError` in strict mode\n         * {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Getter_only}\n         * @param {boolean} value - The value to set\n         */\n        set: function set(value) {\n          once = value;\n        }\n      });\n      WINDOW.addEventListener('test', listener, options);\n      WINDOW.removeEventListener('test', listener, options);\n    }\n\n    return supported;\n  }();\n  /**\n   * Remove event listener from the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n\n\n  function removeListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (!onceSupported) {\n        var listeners = element.listeners;\n\n        if (listeners && listeners[event] && listeners[event][listener]) {\n          handler = listeners[event][listener];\n          delete listeners[event][listener];\n\n          if (Object.keys(listeners[event]).length === 0) {\n            delete listeners[event];\n          }\n\n          if (Object.keys(listeners).length === 0) {\n            delete element.listeners;\n          }\n        }\n      }\n\n      element.removeEventListener(event, handler, options);\n    });\n  }\n  /**\n   * Add event listener to the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n\n\n  function addListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var _handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (options.once && !onceSupported) {\n        var _element$listeners = element.listeners,\n            listeners = _element$listeners === void 0 ? {} : _element$listeners;\n\n        _handler = function handler() {\n          delete listeners[event][listener];\n          element.removeEventListener(event, _handler, options);\n\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n\n          listener.apply(element, args);\n        };\n\n        if (!listeners[event]) {\n          listeners[event] = {};\n        }\n\n        if (listeners[event][listener]) {\n          element.removeEventListener(event, listeners[event][listener], options);\n        }\n\n        listeners[event][listener] = _handler;\n        element.listeners = listeners;\n      }\n\n      element.addEventListener(event, _handler, options);\n    });\n  }\n  /**\n   * Dispatch event on the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Object} data - The additional event data.\n   * @param {Object} options - The additional event options.\n   * @returns {boolean} Indicate if the event is default prevented or not.\n   */\n\n\n  function dispatchEvent(element, type, data, options) {\n    var event; // Event and CustomEvent on IE9-11 are global objects, not constructors\n\n    if (isFunction(Event) && isFunction(CustomEvent)) {\n      event = new CustomEvent(type, _objectSpread2({\n        bubbles: true,\n        cancelable: true,\n        detail: data\n      }, options));\n    } else {\n      event = document.createEvent('CustomEvent');\n      event.initCustomEvent(type, true, true, data);\n    }\n\n    return element.dispatchEvent(event);\n  }\n  /**\n   * Get the offset base on the document.\n   * @param {Element} element - The target element.\n   * @returns {Object} The offset data.\n   */\n\n\n  function getOffset(element) {\n    var box = element.getBoundingClientRect();\n    return {\n      left: box.left + (window.pageXOffset - document.documentElement.clientLeft),\n      top: box.top + (window.pageYOffset - document.documentElement.clientTop)\n    };\n  }\n  /**\n   * Get transforms base on the given object.\n   * @param {Object} obj - The target object.\n   * @returns {string} A string contains transform values.\n   */\n\n\n  function getTransforms(_ref) {\n    var rotate = _ref.rotate,\n        scaleX = _ref.scaleX,\n        scaleY = _ref.scaleY,\n        translateX = _ref.translateX,\n        translateY = _ref.translateY;\n    var values = [];\n\n    if (isNumber(translateX) && translateX !== 0) {\n      values.push(\"translateX(\".concat(translateX, \"px)\"));\n    }\n\n    if (isNumber(translateY) && translateY !== 0) {\n      values.push(\"translateY(\".concat(translateY, \"px)\"));\n    } // Rotate should come first before scale to match orientation transform\n\n\n    if (isNumber(rotate) && rotate !== 0) {\n      values.push(\"rotate(\".concat(rotate, \"deg)\"));\n    }\n\n    if (isNumber(scaleX) && scaleX !== 1) {\n      values.push(\"scaleX(\".concat(scaleX, \")\"));\n    }\n\n    if (isNumber(scaleY) && scaleY !== 1) {\n      values.push(\"scaleY(\".concat(scaleY, \")\"));\n    }\n\n    var transform = values.length ? values.join(' ') : 'none';\n    return {\n      WebkitTransform: transform,\n      msTransform: transform,\n      transform: transform\n    };\n  }\n  /**\n   * Get an image name from an image url.\n   * @param {string} url - The target url.\n   * @example\n   * // picture.jpg\n   * getImageNameFromURL('https://domain.com/path/to/picture.jpg?size=1280×960')\n   * @returns {string} A string contains the image name.\n   */\n\n\n  function getImageNameFromURL(url) {\n    return isString(url) ? decodeURIComponent(url.replace(/^.*\\//, '').replace(/[?&#].*$/, '')) : '';\n  }\n\n  var IS_SAFARI = WINDOW.navigator && /Version\\/\\d+(\\.\\d+)+?\\s+Safari/i.test(WINDOW.navigator.userAgent);\n  /**\n   * Get an image's natural sizes.\n   * @param {string} image - The target image.\n   * @param {Object} options - The viewer options.\n   * @param {Function} callback - The callback function.\n   * @returns {HTMLImageElement} The new image.\n   */\n\n  function getImageNaturalSizes(image, options, callback) {\n    var newImage = document.createElement('img'); // Modern browsers (except Safari)\n\n    if (image.naturalWidth && !IS_SAFARI) {\n      callback(image.naturalWidth, image.naturalHeight);\n      return newImage;\n    }\n\n    var body = document.body || document.documentElement;\n\n    newImage.onload = function () {\n      callback(newImage.width, newImage.height);\n\n      if (!IS_SAFARI) {\n        body.removeChild(newImage);\n      }\n    };\n\n    forEach(options.inheritedAttributes, function (name) {\n      var value = image.getAttribute(name);\n\n      if (value !== null) {\n        newImage.setAttribute(name, value);\n      }\n    });\n    newImage.src = image.src; // iOS Safari will convert the image automatically\n    // with its orientation once append it into DOM\n\n    if (!IS_SAFARI) {\n      newImage.style.cssText = 'left:0;' + 'max-height:none!important;' + 'max-width:none!important;' + 'min-height:0!important;' + 'min-width:0!important;' + 'opacity:0;' + 'position:absolute;' + 'top:0;' + 'z-index:-1;';\n      body.appendChild(newImage);\n    }\n\n    return newImage;\n  }\n  /**\n   * Get the related class name of a responsive type number.\n   * @param {string} type - The responsive type.\n   * @returns {string} The related class name.\n   */\n\n\n  function getResponsiveClass(type) {\n    switch (type) {\n      case 2:\n        return CLASS_HIDE_XS_DOWN;\n\n      case 3:\n        return CLASS_HIDE_SM_DOWN;\n\n      case 4:\n        return CLASS_HIDE_MD_DOWN;\n\n      default:\n        return '';\n    }\n  }\n  /**\n   * Get the max ratio of a group of pointers.\n   * @param {string} pointers - The target pointers.\n   * @returns {number} The result ratio.\n   */\n\n\n  function getMaxZoomRatio(pointers) {\n    var pointers2 = _objectSpread2({}, pointers);\n\n    var ratios = [];\n    forEach(pointers, function (pointer, pointerId) {\n      delete pointers2[pointerId];\n      forEach(pointers2, function (pointer2) {\n        var x1 = Math.abs(pointer.startX - pointer2.startX);\n        var y1 = Math.abs(pointer.startY - pointer2.startY);\n        var x2 = Math.abs(pointer.endX - pointer2.endX);\n        var y2 = Math.abs(pointer.endY - pointer2.endY);\n        var z1 = Math.sqrt(x1 * x1 + y1 * y1);\n        var z2 = Math.sqrt(x2 * x2 + y2 * y2);\n        var ratio = (z2 - z1) / z1;\n        ratios.push(ratio);\n      });\n    });\n    ratios.sort(function (a, b) {\n      return Math.abs(a) < Math.abs(b);\n    });\n    return ratios[0];\n  }\n  /**\n   * Get a pointer from an event object.\n   * @param {Object} event - The target event object.\n   * @param {boolean} endOnly - Indicates if only returns the end point coordinate or not.\n   * @returns {Object} The result pointer contains start and/or end point coordinates.\n   */\n\n\n  function getPointer(_ref2, endOnly) {\n    var pageX = _ref2.pageX,\n        pageY = _ref2.pageY;\n    var end = {\n      endX: pageX,\n      endY: pageY\n    };\n    return endOnly ? end : _objectSpread2({\n      timeStamp: Date.now(),\n      startX: pageX,\n      startY: pageY\n    }, end);\n  }\n  /**\n   * Get the center point coordinate of a group of pointers.\n   * @param {Object} pointers - The target pointers.\n   * @returns {Object} The center point coordinate.\n   */\n\n\n  function getPointersCenter(pointers) {\n    var pageX = 0;\n    var pageY = 0;\n    var count = 0;\n    forEach(pointers, function (_ref3) {\n      var startX = _ref3.startX,\n          startY = _ref3.startY;\n      pageX += startX;\n      pageY += startY;\n      count += 1;\n    });\n    pageX /= count;\n    pageY /= count;\n    return {\n      pageX: pageX,\n      pageY: pageY\n    };\n  }\n\n  var render = {\n    render: function render() {\n      this.initContainer();\n      this.initViewer();\n      this.initList();\n      this.renderViewer();\n    },\n    initBody: function initBody() {\n      var ownerDocument = this.element.ownerDocument;\n      var body = ownerDocument.body || ownerDocument.documentElement;\n      this.body = body;\n      this.scrollbarWidth = window.innerWidth - ownerDocument.documentElement.clientWidth;\n      this.initialBodyPaddingRight = body.style.paddingRight;\n      this.initialBodyComputedPaddingRight = window.getComputedStyle(body).paddingRight;\n    },\n    initContainer: function initContainer() {\n      this.containerData = {\n        width: window.innerWidth,\n        height: window.innerHeight\n      };\n    },\n    initViewer: function initViewer() {\n      var options = this.options,\n          parent = this.parent;\n      var viewerData;\n\n      if (options.inline) {\n        viewerData = {\n          width: Math.max(parent.offsetWidth, options.minWidth),\n          height: Math.max(parent.offsetHeight, options.minHeight)\n        };\n        this.parentData = viewerData;\n      }\n\n      if (this.fulled || !viewerData) {\n        viewerData = this.containerData;\n      }\n\n      this.viewerData = assign({}, viewerData);\n    },\n    renderViewer: function renderViewer() {\n      if (this.options.inline && !this.fulled) {\n        setStyle(this.viewer, this.viewerData);\n      }\n    },\n    initList: function initList() {\n      var _this = this;\n\n      var element = this.element,\n          options = this.options,\n          list = this.list;\n      var items = []; // initList may be called in this.update, so should keep idempotent\n\n      list.innerHTML = '';\n      forEach(this.images, function (image, index) {\n        var src = image.src;\n        var alt = image.alt || getImageNameFromURL(src);\n\n        var url = _this.getImageURL(image);\n\n        if (src || url) {\n          var item = document.createElement('li');\n          var img = document.createElement('img');\n          forEach(options.inheritedAttributes, function (name) {\n            var value = image.getAttribute(name);\n\n            if (value !== null) {\n              img.setAttribute(name, value);\n            }\n          });\n\n          if (options.navbar) {\n            img.src = src || url;\n          }\n\n          img.alt = alt;\n          img.setAttribute('data-original-url', url || src);\n          item.setAttribute('data-index', index);\n          item.setAttribute('data-viewer-action', 'view');\n          item.setAttribute('role', 'button');\n\n          if (options.keyboard) {\n            item.setAttribute('tabindex', 0);\n          }\n\n          item.appendChild(img);\n          list.appendChild(item);\n          items.push(item);\n        }\n      });\n      this.items = items;\n      forEach(items, function (item) {\n        var image = item.firstElementChild;\n        var onLoad;\n        var onError;\n        setData(image, 'filled', true);\n\n        if (options.loading) {\n          addClass(item, CLASS_LOADING);\n        }\n\n        addListener(image, EVENT_LOAD, onLoad = function onLoad(event) {\n          removeListener(image, EVENT_ERROR, onError);\n\n          if (options.loading) {\n            removeClass(item, CLASS_LOADING);\n          }\n\n          _this.loadImage(event);\n        }, {\n          once: true\n        });\n        addListener(image, EVENT_ERROR, onError = function onError() {\n          removeListener(image, EVENT_LOAD, onLoad);\n\n          if (options.loading) {\n            removeClass(item, CLASS_LOADING);\n          }\n        }, {\n          once: true\n        });\n      });\n\n      if (options.transition) {\n        addListener(element, EVENT_VIEWED, function () {\n          addClass(list, CLASS_TRANSITION);\n        }, {\n          once: true\n        });\n      }\n    },\n    renderList: function renderList() {\n      var index = this.index;\n      var item = this.items[index];\n\n      if (!item) {\n        return;\n      }\n\n      var next = item.nextElementSibling;\n      var gutter = parseInt(window.getComputedStyle(next || item).marginLeft, 10);\n      var offsetWidth = item.offsetWidth;\n      var outerWidth = offsetWidth + gutter; // Place the active item in the center of the screen\n\n      setStyle(this.list, assign({\n        width: outerWidth * this.length - gutter\n      }, getTransforms({\n        translateX: (this.viewerData.width - offsetWidth) / 2 - outerWidth * index\n      })));\n    },\n    resetList: function resetList() {\n      var list = this.list;\n      list.innerHTML = '';\n      removeClass(list, CLASS_TRANSITION);\n      setStyle(list, getTransforms({\n        translateX: 0\n      }));\n    },\n    initImage: function initImage(done) {\n      var _this2 = this;\n\n      var options = this.options,\n          image = this.image,\n          viewerData = this.viewerData;\n      var footerHeight = this.footer.offsetHeight;\n      var viewerWidth = viewerData.width;\n      var viewerHeight = Math.max(viewerData.height - footerHeight, footerHeight);\n      var oldImageData = this.imageData || {};\n      var sizingImage;\n      this.imageInitializing = {\n        abort: function abort() {\n          sizingImage.onload = null;\n        }\n      };\n      sizingImage = getImageNaturalSizes(image, options, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var initialCoverage = Math.max(0, Math.min(1, options.initialCoverage));\n        var width = viewerWidth;\n        var height = viewerHeight;\n        _this2.imageInitializing = false;\n\n        if (viewerHeight * aspectRatio > viewerWidth) {\n          height = viewerWidth / aspectRatio;\n        } else {\n          width = viewerHeight * aspectRatio;\n        }\n\n        initialCoverage = isNumber(initialCoverage) ? initialCoverage : 0.9;\n        width = Math.min(width * initialCoverage, naturalWidth);\n        height = Math.min(height * initialCoverage, naturalHeight);\n        var left = (viewerWidth - width) / 2;\n        var top = (viewerHeight - height) / 2;\n        var imageData = {\n          left: left,\n          top: top,\n          x: left,\n          y: top,\n          width: width,\n          height: height,\n          oldRatio: 1,\n          ratio: width / naturalWidth,\n          aspectRatio: aspectRatio,\n          naturalWidth: naturalWidth,\n          naturalHeight: naturalHeight\n        };\n        var initialImageData = assign({}, imageData);\n\n        if (options.rotatable) {\n          imageData.rotate = oldImageData.rotate || 0;\n          initialImageData.rotate = 0;\n        }\n\n        if (options.scalable) {\n          imageData.scaleX = oldImageData.scaleX || 1;\n          imageData.scaleY = oldImageData.scaleY || 1;\n          initialImageData.scaleX = 1;\n          initialImageData.scaleY = 1;\n        }\n\n        _this2.imageData = imageData;\n        _this2.initialImageData = initialImageData;\n\n        if (done) {\n          done();\n        }\n      });\n    },\n    renderImage: function renderImage(done) {\n      var _this3 = this;\n\n      var image = this.image,\n          imageData = this.imageData;\n      setStyle(image, assign({\n        width: imageData.width,\n        height: imageData.height,\n        // XXX: Not to use translateX/Y to avoid image shaking when zooming\n        marginLeft: imageData.x,\n        marginTop: imageData.y\n      }, getTransforms(imageData)));\n\n      if (done) {\n        if ((this.viewing || this.moving || this.rotating || this.scaling || this.zooming) && this.options.transition && hasClass(image, CLASS_TRANSITION)) {\n          var onTransitionEnd = function onTransitionEnd() {\n            _this3.imageRendering = false;\n            done();\n          };\n\n          this.imageRendering = {\n            abort: function abort() {\n              removeListener(image, EVENT_TRANSITION_END, onTransitionEnd);\n            }\n          };\n          addListener(image, EVENT_TRANSITION_END, onTransitionEnd, {\n            once: true\n          });\n        } else {\n          done();\n        }\n      }\n    },\n    resetImage: function resetImage() {\n      var image = this.image;\n\n      if (image) {\n        if (this.viewing) {\n          this.viewing.abort();\n        }\n\n        image.parentNode.removeChild(image);\n        this.image = null;\n        this.title.innerHTML = '';\n      }\n    }\n  };\n  var events = {\n    bind: function bind() {\n      var options = this.options,\n          viewer = this.viewer,\n          canvas = this.canvas;\n      var document = this.element.ownerDocument;\n      addListener(viewer, EVENT_CLICK, this.onClick = this.click.bind(this));\n      addListener(viewer, EVENT_DRAG_START, this.onDragStart = this.dragstart.bind(this));\n      addListener(canvas, EVENT_POINTER_DOWN, this.onPointerDown = this.pointerdown.bind(this));\n      addListener(document, EVENT_POINTER_MOVE, this.onPointerMove = this.pointermove.bind(this));\n      addListener(document, EVENT_POINTER_UP, this.onPointerUp = this.pointerup.bind(this));\n      addListener(document, EVENT_KEY_DOWN, this.onKeyDown = this.keydown.bind(this));\n      addListener(window, EVENT_RESIZE, this.onResize = this.resize.bind(this));\n\n      if (options.zoomable && options.zoomOnWheel) {\n        addListener(viewer, EVENT_WHEEL, this.onWheel = this.wheel.bind(this), {\n          passive: false,\n          capture: true\n        });\n      }\n\n      if (options.toggleOnDblclick) {\n        addListener(canvas, EVENT_DBLCLICK, this.onDblclick = this.dblclick.bind(this));\n      }\n    },\n    unbind: function unbind() {\n      var options = this.options,\n          viewer = this.viewer,\n          canvas = this.canvas;\n      var document = this.element.ownerDocument;\n      removeListener(viewer, EVENT_CLICK, this.onClick);\n      removeListener(viewer, EVENT_DRAG_START, this.onDragStart);\n      removeListener(canvas, EVENT_POINTER_DOWN, this.onPointerDown);\n      removeListener(document, EVENT_POINTER_MOVE, this.onPointerMove);\n      removeListener(document, EVENT_POINTER_UP, this.onPointerUp);\n      removeListener(document, EVENT_KEY_DOWN, this.onKeyDown);\n      removeListener(window, EVENT_RESIZE, this.onResize);\n\n      if (options.zoomable && options.zoomOnWheel) {\n        removeListener(viewer, EVENT_WHEEL, this.onWheel, {\n          passive: false,\n          capture: true\n        });\n      }\n\n      if (options.toggleOnDblclick) {\n        removeListener(canvas, EVENT_DBLCLICK, this.onDblclick);\n      }\n    }\n  };\n  var handlers = {\n    click: function click(event) {\n      var options = this.options,\n          imageData = this.imageData;\n      var target = event.target;\n      var action = getData(target, DATA_ACTION);\n\n      if (!action && target.localName === 'img' && target.parentElement.localName === 'li') {\n        target = target.parentElement;\n        action = getData(target, DATA_ACTION);\n      } // Cancel the emulated click when the native click event was triggered.\n\n\n      if (IS_TOUCH_DEVICE && event.isTrusted && target === this.canvas) {\n        clearTimeout(this.clickCanvasTimeout);\n      }\n\n      switch (action) {\n        case 'mix':\n          if (this.played) {\n            this.stop();\n          } else if (options.inline) {\n            if (this.fulled) {\n              this.exit();\n            } else {\n              this.full();\n            }\n          } else {\n            this.hide();\n          }\n\n          break;\n\n        case 'hide':\n          if (!this.pointerMoved) {\n            this.hide();\n          }\n\n          break;\n\n        case 'view':\n          this.view(getData(target, 'index'));\n          break;\n\n        case 'zoom-in':\n          this.zoom(0.1, true);\n          break;\n\n        case 'zoom-out':\n          this.zoom(-0.1, true);\n          break;\n\n        case 'one-to-one':\n          this.toggle();\n          break;\n\n        case 'reset':\n          this.reset();\n          break;\n\n        case 'prev':\n          this.prev(options.loop);\n          break;\n\n        case 'play':\n          this.play(options.fullscreen);\n          break;\n\n        case 'next':\n          this.next(options.loop);\n          break;\n\n        case 'rotate-left':\n          this.rotate(-90);\n          break;\n\n        case 'rotate-right':\n          this.rotate(90);\n          break;\n\n        case 'flip-horizontal':\n          this.scaleX(-imageData.scaleX || -1);\n          break;\n\n        case 'flip-vertical':\n          this.scaleY(-imageData.scaleY || -1);\n          break;\n\n        default:\n          if (this.played) {\n            this.stop();\n          }\n\n      }\n    },\n    dblclick: function dblclick(event) {\n      event.preventDefault();\n\n      if (this.viewed && event.target === this.image) {\n        // Cancel the emulated double click when the native dblclick event was triggered.\n        if (IS_TOUCH_DEVICE && event.isTrusted) {\n          clearTimeout(this.doubleClickImageTimeout);\n        } // XXX: No pageX/Y properties in custom event, fallback to the original event.\n\n\n        this.toggle(event.isTrusted ? event : event.detail && event.detail.originalEvent);\n      }\n    },\n    load: function load() {\n      var _this = this;\n\n      if (this.timeout) {\n        clearTimeout(this.timeout);\n        this.timeout = false;\n      }\n\n      var element = this.element,\n          options = this.options,\n          image = this.image,\n          index = this.index,\n          viewerData = this.viewerData;\n      removeClass(image, CLASS_INVISIBLE);\n\n      if (options.loading) {\n        removeClass(this.canvas, CLASS_LOADING);\n      }\n\n      image.style.cssText = 'height:0;' + \"margin-left:\".concat(viewerData.width / 2, \"px;\") + \"margin-top:\".concat(viewerData.height / 2, \"px;\") + 'max-width:none!important;' + 'position:relative;' + 'width:0;';\n      this.initImage(function () {\n        toggleClass(image, CLASS_MOVE, options.movable);\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n\n        _this.renderImage(function () {\n          _this.viewed = true;\n          _this.viewing = false;\n\n          if (isFunction(options.viewed)) {\n            addListener(element, EVENT_VIEWED, options.viewed, {\n              once: true\n            });\n          }\n\n          dispatchEvent(element, EVENT_VIEWED, {\n            originalImage: _this.images[index],\n            index: index,\n            image: image\n          }, {\n            cancelable: false\n          });\n        });\n      });\n    },\n    loadImage: function loadImage(event) {\n      var image = event.target;\n      var parent = image.parentNode;\n      var parentWidth = parent.offsetWidth || 30;\n      var parentHeight = parent.offsetHeight || 50;\n      var filled = !!getData(image, 'filled');\n      getImageNaturalSizes(image, this.options, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var width = parentWidth;\n        var height = parentHeight;\n\n        if (parentHeight * aspectRatio > parentWidth) {\n          if (filled) {\n            width = parentHeight * aspectRatio;\n          } else {\n            height = parentWidth / aspectRatio;\n          }\n        } else if (filled) {\n          height = parentWidth / aspectRatio;\n        } else {\n          width = parentHeight * aspectRatio;\n        }\n\n        setStyle(image, assign({\n          width: width,\n          height: height\n        }, getTransforms({\n          translateX: (parentWidth - width) / 2,\n          translateY: (parentHeight - height) / 2\n        })));\n      });\n    },\n    keydown: function keydown(event) {\n      var options = this.options;\n\n      if (!options.keyboard) {\n        return;\n      }\n\n      var keyCode = event.keyCode || event.which || event.charCode;\n\n      switch (keyCode) {\n        // Enter\n        case 13:\n          if (this.viewer.contains(event.target)) {\n            this.click(event);\n          }\n\n          break;\n      }\n\n      if (!this.fulled) {\n        return;\n      }\n\n      switch (keyCode) {\n        // Escape\n        case 27:\n          if (this.played) {\n            this.stop();\n          } else if (options.inline) {\n            if (this.fulled) {\n              this.exit();\n            }\n          } else {\n            this.hide();\n          }\n\n          break;\n        // Space\n\n        case 32:\n          if (this.played) {\n            this.stop();\n          }\n\n          break;\n        // ArrowLeft\n\n        case 37:\n          if (this.played && this.playing) {\n            this.playing.prev();\n          } else {\n            this.prev(options.loop);\n          }\n\n          break;\n        // ArrowUp\n\n        case 38:\n          // Prevent scroll on Firefox\n          event.preventDefault(); // Zoom in\n\n          this.zoom(options.zoomRatio, true);\n          break;\n        // ArrowRight\n\n        case 39:\n          if (this.played && this.playing) {\n            this.playing.next();\n          } else {\n            this.next(options.loop);\n          }\n\n          break;\n        // ArrowDown\n\n        case 40:\n          // Prevent scroll on Firefox\n          event.preventDefault(); // Zoom out\n\n          this.zoom(-options.zoomRatio, true);\n          break;\n        // Ctrl + 0\n\n        case 48: // Fall through\n        // Ctrl + 1\n        // eslint-disable-next-line no-fallthrough\n\n        case 49:\n          if (event.ctrlKey) {\n            event.preventDefault();\n            this.toggle();\n          }\n\n          break;\n      }\n    },\n    dragstart: function dragstart(event) {\n      if (event.target.localName === 'img') {\n        event.preventDefault();\n      }\n    },\n    pointerdown: function pointerdown(event) {\n      var options = this.options,\n          pointers = this.pointers;\n      var buttons = event.buttons,\n          button = event.button;\n      this.pointerMoved = false;\n\n      if (!this.viewed || this.showing || this.viewing || this.hiding // Handle mouse event and pointer event and ignore touch event\n      || (event.type === 'mousedown' || event.type === 'pointerdown' && event.pointerType === 'mouse') && ( // No primary button (Usually the left button)\n      isNumber(buttons) && buttons !== 1 || isNumber(button) && button !== 0 // Open context menu\n      || event.ctrlKey)) {\n        return;\n      } // Prevent default behaviours as page zooming in touch devices.\n\n\n      event.preventDefault();\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          pointers[touch.identifier] = getPointer(touch);\n        });\n      } else {\n        pointers[event.pointerId || 0] = getPointer(event);\n      }\n\n      var action = options.movable ? ACTION_MOVE : false;\n\n      if (options.zoomOnTouch && options.zoomable && Object.keys(pointers).length > 1) {\n        action = ACTION_ZOOM;\n      } else if (options.slideOnTouch && (event.pointerType === 'touch' || event.type === 'touchstart') && this.isSwitchable()) {\n        action = ACTION_SWITCH;\n      }\n\n      if (options.transition && (action === ACTION_MOVE || action === ACTION_ZOOM)) {\n        removeClass(this.image, CLASS_TRANSITION);\n      }\n\n      this.action = action;\n    },\n    pointermove: function pointermove(event) {\n      var pointers = this.pointers,\n          action = this.action;\n\n      if (!this.viewed || !action) {\n        return;\n      }\n\n      event.preventDefault();\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          assign(pointers[touch.identifier] || {}, getPointer(touch, true));\n        });\n      } else {\n        assign(pointers[event.pointerId || 0] || {}, getPointer(event, true));\n      }\n\n      this.change(event);\n    },\n    pointerup: function pointerup(event) {\n      var _this2 = this;\n\n      var options = this.options,\n          action = this.action,\n          pointers = this.pointers;\n      var pointer;\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          pointer = pointers[touch.identifier];\n          delete pointers[touch.identifier];\n        });\n      } else {\n        pointer = pointers[event.pointerId || 0];\n        delete pointers[event.pointerId || 0];\n      }\n\n      if (!action) {\n        return;\n      }\n\n      event.preventDefault();\n\n      if (options.transition && (action === ACTION_MOVE || action === ACTION_ZOOM)) {\n        addClass(this.image, CLASS_TRANSITION);\n      }\n\n      this.action = false; // Emulate click and double click in touch devices to support backdrop and image zooming (#210).\n\n      if (IS_TOUCH_DEVICE && action !== ACTION_ZOOM && pointer && Date.now() - pointer.timeStamp < 500) {\n        clearTimeout(this.clickCanvasTimeout);\n        clearTimeout(this.doubleClickImageTimeout);\n\n        if (options.toggleOnDblclick && this.viewed && event.target === this.image) {\n          if (this.imageClicked) {\n            this.imageClicked = false; // This timeout will be cleared later when a native dblclick event is triggering\n\n            this.doubleClickImageTimeout = setTimeout(function () {\n              dispatchEvent(_this2.image, EVENT_DBLCLICK, {\n                originalEvent: event\n              });\n            }, 50);\n          } else {\n            this.imageClicked = true; // The default timing of a double click in Windows is 500 ms\n\n            this.doubleClickImageTimeout = setTimeout(function () {\n              _this2.imageClicked = false;\n            }, 500);\n          }\n        } else {\n          this.imageClicked = false;\n\n          if (options.backdrop && options.backdrop !== 'static' && event.target === this.canvas) {\n            // This timeout will be cleared later when a native click event is triggering\n            this.clickCanvasTimeout = setTimeout(function () {\n              dispatchEvent(_this2.canvas, EVENT_CLICK, {\n                originalEvent: event\n              });\n            }, 50);\n          }\n        }\n      }\n    },\n    resize: function resize() {\n      var _this3 = this;\n\n      if (!this.isShown || this.hiding) {\n        return;\n      }\n\n      if (this.fulled) {\n        this.close();\n        this.initBody();\n        this.open();\n      }\n\n      this.initContainer();\n      this.initViewer();\n      this.renderViewer();\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this3.renderImage();\n        });\n      }\n\n      if (this.played) {\n        if (this.options.fullscreen && this.fulled && !(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n          this.stop();\n          return;\n        }\n\n        forEach(this.player.getElementsByTagName('img'), function (image) {\n          addListener(image, EVENT_LOAD, _this3.loadImage.bind(_this3), {\n            once: true\n          });\n          dispatchEvent(image, EVENT_LOAD);\n        });\n      }\n    },\n    wheel: function wheel(event) {\n      var _this4 = this;\n\n      if (!this.viewed) {\n        return;\n      }\n\n      event.preventDefault(); // Limit wheel speed to prevent zoom too fast\n\n      if (this.wheeling) {\n        return;\n      }\n\n      this.wheeling = true;\n      setTimeout(function () {\n        _this4.wheeling = false;\n      }, 50);\n      var ratio = Number(this.options.zoomRatio) || 0.1;\n      var delta = 1;\n\n      if (event.deltaY) {\n        delta = event.deltaY > 0 ? 1 : -1;\n      } else if (event.wheelDelta) {\n        delta = -event.wheelDelta / 120;\n      } else if (event.detail) {\n        delta = event.detail > 0 ? 1 : -1;\n      }\n\n      this.zoom(-delta * ratio, true, null, event);\n    }\n  };\n  var methods = {\n    /** Show the viewer (only available in modal mode)\n     * @param {boolean} [immediate=false] - Indicates if show the viewer immediately or not.\n     * @returns {Viewer} this\n     */\n    show: function show() {\n      var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var element = this.element,\n          options = this.options;\n\n      if (options.inline || this.showing || this.isShown || this.showing) {\n        return this;\n      }\n\n      if (!this.ready) {\n        this.build();\n\n        if (this.ready) {\n          this.show(immediate);\n        }\n\n        return this;\n      }\n\n      if (isFunction(options.show)) {\n        addListener(element, EVENT_SHOW, options.show, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_SHOW) === false || !this.ready) {\n        return this;\n      }\n\n      if (this.hiding) {\n        this.transitioning.abort();\n      }\n\n      this.showing = true;\n      this.open();\n      var viewer = this.viewer;\n      removeClass(viewer, CLASS_HIDE);\n      viewer.setAttribute('role', 'dialog');\n      viewer.setAttribute('aria-labelledby', this.title.id);\n      viewer.setAttribute('aria-modal', true);\n      viewer.removeAttribute('aria-hidden');\n\n      if (options.transition && !immediate) {\n        var shown = this.shown.bind(this);\n        this.transitioning = {\n          abort: function abort() {\n            removeListener(viewer, EVENT_TRANSITION_END, shown);\n            removeClass(viewer, CLASS_IN);\n          }\n        };\n        addClass(viewer, CLASS_TRANSITION); // Force reflow to enable CSS3 transition\n\n        viewer.initialOffsetWidth = viewer.offsetWidth;\n        addListener(viewer, EVENT_TRANSITION_END, shown, {\n          once: true\n        });\n        addClass(viewer, CLASS_IN);\n      } else {\n        addClass(viewer, CLASS_IN);\n        this.shown();\n      }\n\n      return this;\n    },\n\n    /**\n     * Hide the viewer (only available in modal mode)\n     * @param {boolean} [immediate=false] - Indicates if hide the viewer immediately or not.\n     * @returns {Viewer} this\n     */\n    hide: function hide() {\n      var _this = this;\n\n      var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var element = this.element,\n          options = this.options;\n\n      if (options.inline || this.hiding || !(this.isShown || this.showing)) {\n        return this;\n      }\n\n      if (isFunction(options.hide)) {\n        addListener(element, EVENT_HIDE, options.hide, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_HIDE) === false) {\n        return this;\n      }\n\n      if (this.showing) {\n        this.transitioning.abort();\n      }\n\n      this.hiding = true;\n\n      if (this.played) {\n        this.stop();\n      } else if (this.viewing) {\n        this.viewing.abort();\n      }\n\n      var viewer = this.viewer,\n          image = this.image;\n\n      var hideImmediately = function hideImmediately() {\n        removeClass(viewer, CLASS_IN);\n\n        _this.hidden();\n      };\n\n      if (options.transition && !immediate) {\n        var onViewerTransitionEnd = function onViewerTransitionEnd(event) {\n          // Ignore all propagating `transitionend` events (#275).\n          if (event && event.target === viewer) {\n            removeListener(viewer, EVENT_TRANSITION_END, onViewerTransitionEnd);\n\n            _this.hidden();\n          }\n        };\n\n        var onImageTransitionEnd = function onImageTransitionEnd() {\n          // In case of show the viewer by `viewer.show(true)` previously (#407).\n          if (hasClass(viewer, CLASS_TRANSITION)) {\n            addListener(viewer, EVENT_TRANSITION_END, onViewerTransitionEnd);\n            removeClass(viewer, CLASS_IN);\n          } else {\n            hideImmediately();\n          }\n        };\n\n        this.transitioning = {\n          abort: function abort() {\n            if (_this.viewed && hasClass(image, CLASS_TRANSITION)) {\n              removeListener(image, EVENT_TRANSITION_END, onImageTransitionEnd);\n            } else if (hasClass(viewer, CLASS_TRANSITION)) {\n              removeListener(viewer, EVENT_TRANSITION_END, onViewerTransitionEnd);\n            }\n          }\n        }; // In case of hiding the viewer when holding on the image (#255),\n        // note that the `CLASS_TRANSITION` class will be removed on pointer down.\n\n        if (this.viewed && hasClass(image, CLASS_TRANSITION)) {\n          addListener(image, EVENT_TRANSITION_END, onImageTransitionEnd, {\n            once: true\n          });\n          this.zoomTo(0, false, null, null, true);\n        } else {\n          onImageTransitionEnd();\n        }\n      } else {\n        hideImmediately();\n      }\n\n      return this;\n    },\n\n    /**\n     * View one of the images with image's index\n     * @param {number} index - The index of the image to view.\n     * @returns {Viewer} this\n     */\n    view: function view() {\n      var _this2 = this;\n\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.options.initialViewIndex;\n      index = Number(index) || 0;\n\n      if (this.hiding || this.played || index < 0 || index >= this.length || this.viewed && index === this.index) {\n        return this;\n      }\n\n      if (!this.isShown) {\n        this.index = index;\n        return this.show();\n      }\n\n      if (this.viewing) {\n        this.viewing.abort();\n      }\n\n      var element = this.element,\n          options = this.options,\n          title = this.title,\n          canvas = this.canvas;\n      var item = this.items[index];\n      var img = item.querySelector('img');\n      var url = getData(img, 'originalUrl');\n      var alt = img.getAttribute('alt');\n      var image = document.createElement('img');\n      forEach(options.inheritedAttributes, function (name) {\n        var value = img.getAttribute(name);\n\n        if (value !== null) {\n          image.setAttribute(name, value);\n        }\n      });\n      image.src = url;\n      image.alt = alt;\n\n      if (isFunction(options.view)) {\n        addListener(element, EVENT_VIEW, options.view, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_VIEW, {\n        originalImage: this.images[index],\n        index: index,\n        image: image\n      }) === false || !this.isShown || this.hiding || this.played) {\n        return this;\n      }\n\n      var activeItem = this.items[this.index];\n\n      if (activeItem) {\n        removeClass(activeItem, CLASS_ACTIVE);\n        activeItem.removeAttribute('aria-selected');\n      }\n\n      addClass(item, CLASS_ACTIVE);\n      item.setAttribute('aria-selected', true);\n\n      if (options.focus) {\n        item.focus();\n      }\n\n      this.image = image;\n      this.viewed = false;\n      this.index = index;\n      this.imageData = {};\n      addClass(image, CLASS_INVISIBLE);\n\n      if (options.loading) {\n        addClass(canvas, CLASS_LOADING);\n      }\n\n      canvas.innerHTML = '';\n      canvas.appendChild(image); // Center current item\n\n      this.renderList(); // Clear title\n\n      title.innerHTML = ''; // Generate title after viewed\n\n      var onViewed = function onViewed() {\n        var imageData = _this2.imageData;\n        var render = Array.isArray(options.title) ? options.title[1] : options.title;\n        title.innerHTML = escapeHTMLEntities(isFunction(render) ? render.call(_this2, image, imageData) : \"\".concat(alt, \" (\").concat(imageData.naturalWidth, \" \\xD7 \").concat(imageData.naturalHeight, \")\"));\n      };\n\n      var onLoad;\n      var onError;\n      addListener(element, EVENT_VIEWED, onViewed, {\n        once: true\n      });\n      this.viewing = {\n        abort: function abort() {\n          removeListener(element, EVENT_VIEWED, onViewed);\n\n          if (image.complete) {\n            if (_this2.imageRendering) {\n              _this2.imageRendering.abort();\n            } else if (_this2.imageInitializing) {\n              _this2.imageInitializing.abort();\n            }\n          } else {\n            // Cancel download to save bandwidth.\n            image.src = '';\n            removeListener(image, EVENT_LOAD, onLoad);\n\n            if (_this2.timeout) {\n              clearTimeout(_this2.timeout);\n            }\n          }\n        }\n      };\n\n      if (image.complete) {\n        this.load();\n      } else {\n        addListener(image, EVENT_LOAD, onLoad = function onLoad() {\n          removeListener(image, EVENT_ERROR, onError);\n\n          _this2.load();\n        }, {\n          once: true\n        });\n        addListener(image, EVENT_ERROR, onError = function onError() {\n          removeListener(image, EVENT_LOAD, onLoad);\n\n          if (_this2.timeout) {\n            clearTimeout(_this2.timeout);\n            _this2.timeout = false;\n          }\n\n          removeClass(image, CLASS_INVISIBLE);\n\n          if (options.loading) {\n            removeClass(_this2.canvas, CLASS_LOADING);\n          }\n        }, {\n          once: true\n        });\n\n        if (this.timeout) {\n          clearTimeout(this.timeout);\n        } // Make the image visible if it fails to load within 1s\n\n\n        this.timeout = setTimeout(function () {\n          removeClass(image, CLASS_INVISIBLE);\n          _this2.timeout = false;\n        }, 1000);\n      }\n\n      return this;\n    },\n\n    /**\n     * View the previous image\n     * @param {boolean} [loop=false] - Indicate if view the last one\n     * when it is the first one at present.\n     * @returns {Viewer} this\n     */\n    prev: function prev() {\n      var loop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var index = this.index - 1;\n\n      if (index < 0) {\n        index = loop ? this.length - 1 : 0;\n      }\n\n      this.view(index);\n      return this;\n    },\n\n    /**\n     * View the next image\n     * @param {boolean} [loop=false] - Indicate if view the first one\n     * when it is the last one at present.\n     * @returns {Viewer} this\n     */\n    next: function next() {\n      var loop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var maxIndex = this.length - 1;\n      var index = this.index + 1;\n\n      if (index > maxIndex) {\n        index = loop ? 0 : maxIndex;\n      }\n\n      this.view(index);\n      return this;\n    },\n\n    /**\n     * Move the image with relative offsets.\n     * @param {number} x - The moving distance in the horizontal direction.\n     * @param {number} [y=x] The moving distance in the vertical direction.\n     * @returns {Viewer} this\n     */\n    move: function move(x) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : x;\n      var imageData = this.imageData;\n      this.moveTo(isUndefined(x) ? x : imageData.x + Number(x), isUndefined(y) ? y : imageData.y + Number(y));\n      return this;\n    },\n\n    /**\n     * Move the image to an absolute point.\n     * @param {number} x - The new position in the horizontal direction.\n     * @param {number} [y=x] - The new position in the vertical direction.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @returns {Viewer} this\n     */\n    moveTo: function moveTo(x) {\n      var _this3 = this;\n\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : x;\n\n      var _originalEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var element = this.element,\n          options = this.options,\n          imageData = this.imageData;\n      x = Number(x);\n      y = Number(y);\n\n      if (this.viewed && !this.played && options.movable) {\n        var oldX = imageData.x;\n        var oldY = imageData.y;\n        var changed = false;\n\n        if (isNumber(x)) {\n          changed = true;\n        } else {\n          x = oldX;\n        }\n\n        if (isNumber(y)) {\n          changed = true;\n        } else {\n          y = oldY;\n        }\n\n        if (changed) {\n          if (isFunction(options.move)) {\n            addListener(element, EVENT_MOVE, options.move, {\n              once: true\n            });\n          }\n\n          if (dispatchEvent(element, EVENT_MOVE, {\n            x: x,\n            y: y,\n            oldX: oldX,\n            oldY: oldY,\n            originalEvent: _originalEvent\n          }) === false) {\n            return this;\n          }\n\n          imageData.x = x;\n          imageData.y = y;\n          imageData.left = x;\n          imageData.top = y;\n          this.moving = true;\n          this.renderImage(function () {\n            _this3.moving = false;\n\n            if (isFunction(options.moved)) {\n              addListener(element, EVENT_MOVED, options.moved, {\n                once: true\n              });\n            }\n\n            dispatchEvent(element, EVENT_MOVED, {\n              x: x,\n              y: y,\n              oldX: oldX,\n              oldY: oldY,\n              originalEvent: _originalEvent\n            }, {\n              cancelable: false\n            });\n          });\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Rotate the image with a relative degree.\n     * @param {number} degree - The rotate degree.\n     * @returns {Viewer} this\n     */\n    rotate: function rotate(degree) {\n      this.rotateTo((this.imageData.rotate || 0) + Number(degree));\n      return this;\n    },\n\n    /**\n     * Rotate the image to an absolute degree.\n     * @param {number} degree - The rotate degree.\n     * @returns {Viewer} this\n     */\n    rotateTo: function rotateTo(degree) {\n      var _this4 = this;\n\n      var element = this.element,\n          options = this.options,\n          imageData = this.imageData;\n      degree = Number(degree);\n\n      if (isNumber(degree) && this.viewed && !this.played && options.rotatable) {\n        var oldDegree = imageData.rotate;\n\n        if (isFunction(options.rotate)) {\n          addListener(element, EVENT_ROTATE, options.rotate, {\n            once: true\n          });\n        }\n\n        if (dispatchEvent(element, EVENT_ROTATE, {\n          degree: degree,\n          oldDegree: oldDegree\n        }) === false) {\n          return this;\n        }\n\n        imageData.rotate = degree;\n        this.rotating = true;\n        this.renderImage(function () {\n          _this4.rotating = false;\n\n          if (isFunction(options.rotated)) {\n            addListener(element, EVENT_ROTATED, options.rotated, {\n              once: true\n            });\n          }\n\n          dispatchEvent(element, EVENT_ROTATED, {\n            degree: degree,\n            oldDegree: oldDegree\n          }, {\n            cancelable: false\n          });\n        });\n      }\n\n      return this;\n    },\n\n    /**\n     * Scale the image on the x-axis.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @returns {Viewer} this\n     */\n    scaleX: function scaleX(_scaleX) {\n      this.scale(_scaleX, this.imageData.scaleY);\n      return this;\n    },\n\n    /**\n     * Scale the image on the y-axis.\n     * @param {number} scaleY - The scale ratio on the y-axis.\n     * @returns {Viewer} this\n     */\n    scaleY: function scaleY(_scaleY) {\n      this.scale(this.imageData.scaleX, _scaleY);\n      return this;\n    },\n\n    /**\n     * Scale the image.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @param {number} [scaleY=scaleX] - The scale ratio on the y-axis.\n     * @returns {Viewer} this\n     */\n    scale: function scale(scaleX) {\n      var _this5 = this;\n\n      var scaleY = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : scaleX;\n      var element = this.element,\n          options = this.options,\n          imageData = this.imageData;\n      scaleX = Number(scaleX);\n      scaleY = Number(scaleY);\n\n      if (this.viewed && !this.played && options.scalable) {\n        var oldScaleX = imageData.scaleX;\n        var oldScaleY = imageData.scaleY;\n        var changed = false;\n\n        if (isNumber(scaleX)) {\n          changed = true;\n        } else {\n          scaleX = oldScaleX;\n        }\n\n        if (isNumber(scaleY)) {\n          changed = true;\n        } else {\n          scaleY = oldScaleY;\n        }\n\n        if (changed) {\n          if (isFunction(options.scale)) {\n            addListener(element, EVENT_SCALE, options.scale, {\n              once: true\n            });\n          }\n\n          if (dispatchEvent(element, EVENT_SCALE, {\n            scaleX: scaleX,\n            scaleY: scaleY,\n            oldScaleX: oldScaleX,\n            oldScaleY: oldScaleY\n          }) === false) {\n            return this;\n          }\n\n          imageData.scaleX = scaleX;\n          imageData.scaleY = scaleY;\n          this.scaling = true;\n          this.renderImage(function () {\n            _this5.scaling = false;\n\n            if (isFunction(options.scaled)) {\n              addListener(element, EVENT_SCALED, options.scaled, {\n                once: true\n              });\n            }\n\n            dispatchEvent(element, EVENT_SCALED, {\n              scaleX: scaleX,\n              scaleY: scaleY,\n              oldScaleX: oldScaleX,\n              oldScaleY: oldScaleY\n            }, {\n              cancelable: false\n            });\n          });\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Zoom the image with a relative ratio.\n     * @param {number} ratio - The target ratio.\n     * @param {boolean} [showTooltip=false] - Indicates whether to show the tooltip.\n     * @param {Object} [pivot] - The pivot point coordinate for zooming.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @returns {Viewer} this\n     */\n    zoom: function zoom(ratio) {\n      var showTooltip = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var pivot = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var _originalEvent = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\n      var imageData = this.imageData;\n      ratio = Number(ratio);\n\n      if (ratio < 0) {\n        ratio = 1 / (1 - ratio);\n      } else {\n        ratio = 1 + ratio;\n      }\n\n      this.zoomTo(imageData.width * ratio / imageData.naturalWidth, showTooltip, pivot, _originalEvent);\n      return this;\n    },\n\n    /**\n     * Zoom the image to an absolute ratio.\n     * @param {number} ratio - The target ratio.\n     * @param {boolean} [showTooltip] - Indicates whether to show the tooltip.\n     * @param {Object} [pivot] - The pivot point coordinate for zooming.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @param {Event} [_zoomable=false] - Indicates if the current zoom is available or not.\n     * @returns {Viewer} this\n     */\n    zoomTo: function zoomTo(ratio) {\n      var _this6 = this;\n\n      var showTooltip = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var pivot = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var _originalEvent = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\n      var _zoomable = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n\n      var element = this.element,\n          options = this.options,\n          pointers = this.pointers,\n          imageData = this.imageData;\n      var x = imageData.x,\n          y = imageData.y,\n          width = imageData.width,\n          height = imageData.height,\n          naturalWidth = imageData.naturalWidth,\n          naturalHeight = imageData.naturalHeight;\n      ratio = Math.max(0, ratio);\n\n      if (isNumber(ratio) && this.viewed && !this.played && (_zoomable || options.zoomable)) {\n        if (!_zoomable) {\n          var minZoomRatio = Math.max(0.01, options.minZoomRatio);\n          var maxZoomRatio = Math.min(100, options.maxZoomRatio);\n          ratio = Math.min(Math.max(ratio, minZoomRatio), maxZoomRatio);\n        }\n\n        if (_originalEvent) {\n          switch (_originalEvent.type) {\n            case 'wheel':\n              if (options.zoomRatio >= 0.055 && ratio > 0.95 && ratio < 1.05) {\n                ratio = 1;\n              }\n\n              break;\n\n            case 'pointermove':\n            case 'touchmove':\n            case 'mousemove':\n              if (ratio > 0.99 && ratio < 1.01) {\n                ratio = 1;\n              }\n\n              break;\n          }\n        }\n\n        var newWidth = naturalWidth * ratio;\n        var newHeight = naturalHeight * ratio;\n        var offsetWidth = newWidth - width;\n        var offsetHeight = newHeight - height;\n        var oldRatio = imageData.ratio;\n\n        if (isFunction(options.zoom)) {\n          addListener(element, EVENT_ZOOM, options.zoom, {\n            once: true\n          });\n        }\n\n        if (dispatchEvent(element, EVENT_ZOOM, {\n          ratio: ratio,\n          oldRatio: oldRatio,\n          originalEvent: _originalEvent\n        }) === false) {\n          return this;\n        }\n\n        this.zooming = true;\n\n        if (_originalEvent) {\n          var offset = getOffset(this.viewer);\n          var center = pointers && Object.keys(pointers).length > 0 ? getPointersCenter(pointers) : {\n            pageX: _originalEvent.pageX,\n            pageY: _originalEvent.pageY\n          }; // Zoom from the triggering point of the event\n\n          imageData.x -= offsetWidth * ((center.pageX - offset.left - x) / width);\n          imageData.y -= offsetHeight * ((center.pageY - offset.top - y) / height);\n        } else if (isPlainObject(pivot) && isNumber(pivot.x) && isNumber(pivot.y)) {\n          imageData.x -= offsetWidth * ((pivot.x - x) / width);\n          imageData.y -= offsetHeight * ((pivot.y - y) / height);\n        } else {\n          // Zoom from the center of the image\n          imageData.x -= offsetWidth / 2;\n          imageData.y -= offsetHeight / 2;\n        }\n\n        imageData.left = imageData.x;\n        imageData.top = imageData.y;\n        imageData.width = newWidth;\n        imageData.height = newHeight;\n        imageData.oldRatio = oldRatio;\n        imageData.ratio = ratio;\n        this.renderImage(function () {\n          _this6.zooming = false;\n\n          if (isFunction(options.zoomed)) {\n            addListener(element, EVENT_ZOOMED, options.zoomed, {\n              once: true\n            });\n          }\n\n          dispatchEvent(element, EVENT_ZOOMED, {\n            ratio: ratio,\n            oldRatio: oldRatio,\n            originalEvent: _originalEvent\n          }, {\n            cancelable: false\n          });\n        });\n\n        if (showTooltip) {\n          this.tooltip();\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Play the images\n     * @param {boolean|FullscreenOptions} [fullscreen=false] - Indicate if request fullscreen or not.\n     * @returns {Viewer} this\n     */\n    play: function play() {\n      var _this7 = this;\n\n      var fullscreen = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      if (!this.isShown || this.played) {\n        return this;\n      }\n\n      var element = this.element,\n          options = this.options;\n\n      if (isFunction(options.play)) {\n        addListener(element, EVENT_PLAY, options.play, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_PLAY) === false) {\n        return this;\n      }\n\n      var player = this.player;\n      var onLoad = this.loadImage.bind(this);\n      var list = [];\n      var total = 0;\n      var index = 0;\n      this.played = true;\n      this.onLoadWhenPlay = onLoad;\n\n      if (fullscreen) {\n        this.requestFullscreen(fullscreen);\n      }\n\n      addClass(player, CLASS_SHOW);\n      forEach(this.items, function (item, i) {\n        var img = item.querySelector('img');\n        var image = document.createElement('img');\n        image.src = getData(img, 'originalUrl');\n        image.alt = img.getAttribute('alt');\n        image.referrerPolicy = img.referrerPolicy;\n        total += 1;\n        addClass(image, CLASS_FADE);\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n\n        if (hasClass(item, CLASS_ACTIVE)) {\n          addClass(image, CLASS_IN);\n          index = i;\n        }\n\n        list.push(image);\n        addListener(image, EVENT_LOAD, onLoad, {\n          once: true\n        });\n        player.appendChild(image);\n      });\n\n      if (isNumber(options.interval) && options.interval > 0) {\n        var prev = function prev() {\n          clearTimeout(_this7.playing.timeout);\n          removeClass(list[index], CLASS_IN);\n          index -= 1;\n          index = index >= 0 ? index : total - 1;\n          addClass(list[index], CLASS_IN);\n          _this7.playing.timeout = setTimeout(prev, options.interval);\n        };\n\n        var next = function next() {\n          clearTimeout(_this7.playing.timeout);\n          removeClass(list[index], CLASS_IN);\n          index += 1;\n          index = index < total ? index : 0;\n          addClass(list[index], CLASS_IN);\n          _this7.playing.timeout = setTimeout(next, options.interval);\n        };\n\n        if (total > 1) {\n          this.playing = {\n            prev: prev,\n            next: next,\n            timeout: setTimeout(next, options.interval)\n          };\n        }\n      }\n\n      return this;\n    },\n    // Stop play\n    stop: function stop() {\n      var _this8 = this;\n\n      if (!this.played) {\n        return this;\n      }\n\n      var element = this.element,\n          options = this.options;\n\n      if (isFunction(options.stop)) {\n        addListener(element, EVENT_STOP, options.stop, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_STOP) === false) {\n        return this;\n      }\n\n      var player = this.player;\n      clearTimeout(this.playing.timeout);\n      this.playing = false;\n      this.played = false;\n      forEach(player.getElementsByTagName('img'), function (image) {\n        removeListener(image, EVENT_LOAD, _this8.onLoadWhenPlay);\n      });\n      removeClass(player, CLASS_SHOW);\n      player.innerHTML = '';\n      this.exitFullscreen();\n      return this;\n    },\n    // Enter modal mode (only available in inline mode)\n    full: function full() {\n      var _this9 = this;\n\n      var options = this.options,\n          viewer = this.viewer,\n          image = this.image,\n          list = this.list;\n\n      if (!this.isShown || this.played || this.fulled || !options.inline) {\n        return this;\n      }\n\n      this.fulled = true;\n      this.open();\n      addClass(this.button, CLASS_FULLSCREEN_EXIT);\n\n      if (options.transition) {\n        removeClass(list, CLASS_TRANSITION);\n\n        if (this.viewed) {\n          removeClass(image, CLASS_TRANSITION);\n        }\n      }\n\n      addClass(viewer, CLASS_FIXED);\n      viewer.setAttribute('role', 'dialog');\n      viewer.setAttribute('aria-labelledby', this.title.id);\n      viewer.setAttribute('aria-modal', true);\n      viewer.removeAttribute('style');\n      setStyle(viewer, {\n        zIndex: options.zIndex\n      });\n\n      if (options.focus) {\n        this.enforceFocus();\n      }\n\n      this.initContainer();\n      this.viewerData = assign({}, this.containerData);\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this9.renderImage(function () {\n            if (options.transition) {\n              setTimeout(function () {\n                addClass(image, CLASS_TRANSITION);\n                addClass(list, CLASS_TRANSITION);\n              }, 0);\n            }\n          });\n        });\n      }\n\n      return this;\n    },\n    // Exit modal mode (only available in inline mode)\n    exit: function exit() {\n      var _this10 = this;\n\n      var options = this.options,\n          viewer = this.viewer,\n          image = this.image,\n          list = this.list;\n\n      if (!this.isShown || this.played || !this.fulled || !options.inline) {\n        return this;\n      }\n\n      this.fulled = false;\n      this.close();\n      removeClass(this.button, CLASS_FULLSCREEN_EXIT);\n\n      if (options.transition) {\n        removeClass(list, CLASS_TRANSITION);\n\n        if (this.viewed) {\n          removeClass(image, CLASS_TRANSITION);\n        }\n      }\n\n      if (options.focus) {\n        this.clearEnforceFocus();\n      }\n\n      viewer.removeAttribute('role');\n      viewer.removeAttribute('aria-labelledby');\n      viewer.removeAttribute('aria-modal');\n      removeClass(viewer, CLASS_FIXED);\n      setStyle(viewer, {\n        zIndex: options.zIndexInline\n      });\n      this.viewerData = assign({}, this.parentData);\n      this.renderViewer();\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this10.renderImage(function () {\n            if (options.transition) {\n              setTimeout(function () {\n                addClass(image, CLASS_TRANSITION);\n                addClass(list, CLASS_TRANSITION);\n              }, 0);\n            }\n          });\n        });\n      }\n\n      return this;\n    },\n    // Show the current ratio of the image with percentage\n    tooltip: function tooltip() {\n      var _this11 = this;\n\n      var options = this.options,\n          tooltipBox = this.tooltipBox,\n          imageData = this.imageData;\n\n      if (!this.viewed || this.played || !options.tooltip) {\n        return this;\n      }\n\n      tooltipBox.textContent = \"\".concat(Math.round(imageData.ratio * 100), \"%\");\n\n      if (!this.tooltipping) {\n        if (options.transition) {\n          if (this.fading) {\n            dispatchEvent(tooltipBox, EVENT_TRANSITION_END);\n          }\n\n          addClass(tooltipBox, CLASS_SHOW);\n          addClass(tooltipBox, CLASS_FADE);\n          addClass(tooltipBox, CLASS_TRANSITION);\n          tooltipBox.removeAttribute('aria-hidden'); // Force reflow to enable CSS3 transition\n\n          tooltipBox.initialOffsetWidth = tooltipBox.offsetWidth;\n          addClass(tooltipBox, CLASS_IN);\n        } else {\n          addClass(tooltipBox, CLASS_SHOW);\n          tooltipBox.removeAttribute('aria-hidden');\n        }\n      } else {\n        clearTimeout(this.tooltipping);\n      }\n\n      this.tooltipping = setTimeout(function () {\n        if (options.transition) {\n          addListener(tooltipBox, EVENT_TRANSITION_END, function () {\n            removeClass(tooltipBox, CLASS_SHOW);\n            removeClass(tooltipBox, CLASS_FADE);\n            removeClass(tooltipBox, CLASS_TRANSITION);\n            tooltipBox.setAttribute('aria-hidden', true);\n            _this11.fading = false;\n          }, {\n            once: true\n          });\n          removeClass(tooltipBox, CLASS_IN);\n          _this11.fading = true;\n        } else {\n          removeClass(tooltipBox, CLASS_SHOW);\n          tooltipBox.setAttribute('aria-hidden', true);\n        }\n\n        _this11.tooltipping = false;\n      }, 1000);\n      return this;\n    },\n\n    /**\n     * Toggle the image size between its current size and natural size\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @returns {Viewer} this\n     */\n    toggle: function toggle() {\n      var _originalEvent = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n      if (this.imageData.ratio === 1) {\n        this.zoomTo(this.imageData.oldRatio, true, null, _originalEvent);\n      } else {\n        this.zoomTo(1, true, null, _originalEvent);\n      }\n\n      return this;\n    },\n    // Reset the image to its initial state\n    reset: function reset() {\n      if (this.viewed && !this.played) {\n        this.imageData = assign({}, this.initialImageData);\n        this.renderImage();\n      }\n\n      return this;\n    },\n    // Update viewer when images changed\n    update: function update() {\n      var _this12 = this;\n\n      var element = this.element,\n          options = this.options,\n          isImg = this.isImg; // Destroy viewer if the target image was deleted\n\n      if (isImg && !element.parentNode) {\n        return this.destroy();\n      }\n\n      var images = [];\n      forEach(isImg ? [element] : element.querySelectorAll('img'), function (image) {\n        if (isFunction(options.filter)) {\n          if (options.filter.call(_this12, image)) {\n            images.push(image);\n          }\n        } else if (_this12.getImageURL(image)) {\n          images.push(image);\n        }\n      });\n\n      if (!images.length) {\n        return this;\n      }\n\n      this.images = images;\n      this.length = images.length;\n\n      if (this.ready) {\n        var changedIndexes = [];\n        forEach(this.items, function (item, i) {\n          var img = item.querySelector('img');\n          var image = images[i];\n\n          if (image && img) {\n            if (image.src !== img.src // Title changed (#408)\n            || image.alt !== img.alt) {\n              changedIndexes.push(i);\n            }\n          } else {\n            changedIndexes.push(i);\n          }\n        });\n        setStyle(this.list, {\n          width: 'auto'\n        });\n        this.initList();\n\n        if (this.isShown) {\n          if (this.length) {\n            if (this.viewed) {\n              var changedIndex = changedIndexes.indexOf(this.index);\n\n              if (changedIndex >= 0) {\n                this.viewed = false;\n                this.view(Math.max(Math.min(this.index - changedIndex, this.length - 1), 0));\n              } else {\n                var activeItem = this.items[this.index]; // Reactivate the current viewing item after reset the list.\n\n                addClass(activeItem, CLASS_ACTIVE);\n                activeItem.setAttribute('aria-selected', true);\n              }\n            }\n          } else {\n            this.image = null;\n            this.viewed = false;\n            this.index = 0;\n            this.imageData = {};\n            this.canvas.innerHTML = '';\n            this.title.innerHTML = '';\n          }\n        }\n      } else {\n        this.build();\n      }\n\n      return this;\n    },\n    // Destroy the viewer\n    destroy: function destroy() {\n      var element = this.element,\n          options = this.options;\n\n      if (!element[NAMESPACE]) {\n        return this;\n      }\n\n      this.destroyed = true;\n\n      if (this.ready) {\n        if (this.played) {\n          this.stop();\n        }\n\n        if (options.inline) {\n          if (this.fulled) {\n            this.exit();\n          }\n\n          this.unbind();\n        } else if (this.isShown) {\n          if (this.viewing) {\n            if (this.imageRendering) {\n              this.imageRendering.abort();\n            } else if (this.imageInitializing) {\n              this.imageInitializing.abort();\n            }\n          }\n\n          if (this.hiding) {\n            this.transitioning.abort();\n          }\n\n          this.hidden();\n        } else if (this.showing) {\n          this.transitioning.abort();\n          this.hidden();\n        }\n\n        this.ready = false;\n        this.viewer.parentNode.removeChild(this.viewer);\n      } else if (options.inline) {\n        if (this.delaying) {\n          this.delaying.abort();\n        } else if (this.initializing) {\n          this.initializing.abort();\n        }\n      }\n\n      if (!options.inline) {\n        removeListener(element, EVENT_CLICK, this.onStart);\n      }\n\n      element[NAMESPACE] = undefined;\n      return this;\n    }\n  };\n  var others = {\n    getImageURL: function getImageURL(image) {\n      var url = this.options.url;\n\n      if (isString(url)) {\n        url = image.getAttribute(url);\n      } else if (isFunction(url)) {\n        url = url.call(this, image);\n      } else {\n        url = '';\n      }\n\n      return url;\n    },\n    enforceFocus: function enforceFocus() {\n      var _this = this;\n\n      this.clearEnforceFocus();\n      addListener(document, EVENT_FOCUSIN, this.onFocusin = function (event) {\n        var viewer = _this.viewer;\n        var target = event.target;\n\n        if (target === document || target === viewer || viewer.contains(target)) {\n          return;\n        }\n\n        while (target) {\n          // Avoid conflicts with other modals (#474, #540)\n          if (target.getAttribute('tabindex') !== null || target.getAttribute('aria-modal') === 'true') {\n            return;\n          }\n\n          target = target.parentElement;\n        }\n\n        viewer.focus();\n      });\n    },\n    clearEnforceFocus: function clearEnforceFocus() {\n      if (this.onFocusin) {\n        removeListener(document, EVENT_FOCUSIN, this.onFocusin);\n        this.onFocusin = null;\n      }\n    },\n    open: function open() {\n      var body = this.body;\n      addClass(body, CLASS_OPEN);\n\n      if (this.scrollbarWidth > 0) {\n        body.style.paddingRight = \"\".concat(this.scrollbarWidth + (parseFloat(this.initialBodyComputedPaddingRight) || 0), \"px\");\n      }\n    },\n    close: function close() {\n      var body = this.body;\n      removeClass(body, CLASS_OPEN);\n\n      if (this.scrollbarWidth > 0) {\n        body.style.paddingRight = this.initialBodyPaddingRight;\n      }\n    },\n    shown: function shown() {\n      var element = this.element,\n          options = this.options,\n          viewer = this.viewer;\n      this.fulled = true;\n      this.isShown = true;\n      this.render();\n      this.bind();\n      this.showing = false;\n\n      if (options.focus) {\n        viewer.focus();\n        this.enforceFocus();\n      }\n\n      if (isFunction(options.shown)) {\n        addListener(element, EVENT_SHOWN, options.shown, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_SHOWN) === false) {\n        return;\n      }\n\n      if (this.ready && this.isShown && !this.hiding) {\n        this.view(this.index);\n      }\n    },\n    hidden: function hidden() {\n      var element = this.element,\n          options = this.options,\n          viewer = this.viewer;\n\n      if (options.fucus) {\n        this.clearEnforceFocus();\n      }\n\n      this.close();\n      this.unbind();\n      addClass(viewer, CLASS_HIDE);\n      viewer.removeAttribute('role');\n      viewer.removeAttribute('aria-labelledby');\n      viewer.removeAttribute('aria-modal');\n      viewer.setAttribute('aria-hidden', true);\n      this.resetList();\n      this.resetImage();\n      this.fulled = false;\n      this.viewed = false;\n      this.isShown = false;\n      this.hiding = false;\n\n      if (!this.destroyed) {\n        if (isFunction(options.hidden)) {\n          addListener(element, EVENT_HIDDEN, options.hidden, {\n            once: true\n          });\n        }\n\n        dispatchEvent(element, EVENT_HIDDEN, null, {\n          cancelable: false\n        });\n      }\n    },\n    requestFullscreen: function requestFullscreen(options) {\n      var document = this.element.ownerDocument;\n\n      if (this.fulled && !(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n        var documentElement = document.documentElement; // Element.requestFullscreen()\n\n        if (documentElement.requestFullscreen) {\n          // Avoid TypeError when convert `options` to dictionary\n          if (isPlainObject(options)) {\n            documentElement.requestFullscreen(options);\n          } else {\n            documentElement.requestFullscreen();\n          }\n        } else if (documentElement.webkitRequestFullscreen) {\n          documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n        } else if (documentElement.mozRequestFullScreen) {\n          documentElement.mozRequestFullScreen();\n        } else if (documentElement.msRequestFullscreen) {\n          documentElement.msRequestFullscreen();\n        }\n      }\n    },\n    exitFullscreen: function exitFullscreen() {\n      var document = this.element.ownerDocument;\n\n      if (this.fulled && (document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n        // Document.exitFullscreen()\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        }\n      }\n    },\n    change: function change(event) {\n      var options = this.options,\n          pointers = this.pointers;\n      var pointer = pointers[Object.keys(pointers)[0]]; // In the case of the `pointers` object is empty (#421)\n\n      if (!pointer) {\n        return;\n      }\n\n      var offsetX = pointer.endX - pointer.startX;\n      var offsetY = pointer.endY - pointer.startY;\n\n      switch (this.action) {\n        // Move the current image\n        case ACTION_MOVE:\n          if (offsetX !== 0 || offsetY !== 0) {\n            this.pointerMoved = true;\n            this.move(offsetX, offsetY, event);\n          }\n\n          break;\n        // Zoom the current image\n\n        case ACTION_ZOOM:\n          this.zoom(getMaxZoomRatio(pointers), false, null, event);\n          break;\n\n        case ACTION_SWITCH:\n          {\n            this.action = 'switched';\n            var absoluteOffsetX = Math.abs(offsetX);\n\n            if (absoluteOffsetX > 1 && absoluteOffsetX > Math.abs(offsetY)) {\n              // Empty `pointers` as `touchend` event will not be fired after swiped in iOS browsers.\n              this.pointers = {};\n\n              if (offsetX > 1) {\n                this.prev(options.loop);\n              } else if (offsetX < -1) {\n                this.next(options.loop);\n              }\n            }\n\n            break;\n          }\n      } // Override\n\n\n      forEach(pointers, function (p) {\n        p.startX = p.endX;\n        p.startY = p.endY;\n      });\n    },\n    isSwitchable: function isSwitchable() {\n      var imageData = this.imageData,\n          viewerData = this.viewerData;\n      return this.length > 1 && imageData.x >= 0 && imageData.y >= 0 && imageData.width <= viewerData.width && imageData.height <= viewerData.height;\n    }\n  };\n  var AnotherViewer = WINDOW.Viewer;\n\n  var getUniqueID = function (id) {\n    return function () {\n      id += 1;\n      return id;\n    };\n  }(-1);\n\n  var Viewer = /*#__PURE__*/function () {\n    /**\n     * Create a new Viewer.\n     * @param {Element} element - The target element for viewing.\n     * @param {Object} [options={}] - The configuration options.\n     */\n    function Viewer(element) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      _classCallCheck(this, Viewer);\n\n      if (!element || element.nodeType !== 1) {\n        throw new Error('The first argument is required and must be an element.');\n      }\n\n      this.element = element;\n      this.options = assign({}, DEFAULTS, isPlainObject(options) && options);\n      this.action = false;\n      this.fading = false;\n      this.fulled = false;\n      this.hiding = false;\n      this.imageClicked = false;\n      this.imageData = {};\n      this.index = this.options.initialViewIndex;\n      this.isImg = false;\n      this.isShown = false;\n      this.length = 0;\n      this.moving = false;\n      this.played = false;\n      this.playing = false;\n      this.pointers = {};\n      this.ready = false;\n      this.rotating = false;\n      this.scaling = false;\n      this.showing = false;\n      this.timeout = false;\n      this.tooltipping = false;\n      this.viewed = false;\n      this.viewing = false;\n      this.wheeling = false;\n      this.zooming = false;\n      this.pointerMoved = false;\n      this.id = getUniqueID();\n      this.init();\n    }\n\n    _createClass(Viewer, [{\n      key: \"init\",\n      value: function init() {\n        var _this = this;\n\n        var element = this.element,\n            options = this.options;\n\n        if (element[NAMESPACE]) {\n          return;\n        }\n\n        element[NAMESPACE] = this; // The `focus` option requires the `keyboard` option set to `true`.\n\n        if (options.focus && !options.keyboard) {\n          options.focus = false;\n        }\n\n        var isImg = element.localName === 'img';\n        var images = [];\n        forEach(isImg ? [element] : element.querySelectorAll('img'), function (image) {\n          if (isFunction(options.filter)) {\n            if (options.filter.call(_this, image)) {\n              images.push(image);\n            }\n          } else if (_this.getImageURL(image)) {\n            images.push(image);\n          }\n        });\n        this.isImg = isImg;\n        this.length = images.length;\n        this.images = images;\n        this.initBody(); // Override `transition` option if it is not supported\n\n        if (isUndefined(document.createElement(NAMESPACE).style.transition)) {\n          options.transition = false;\n        }\n\n        if (options.inline) {\n          var count = 0;\n\n          var progress = function progress() {\n            count += 1;\n\n            if (count === _this.length) {\n              var timeout;\n              _this.initializing = false;\n              _this.delaying = {\n                abort: function abort() {\n                  clearTimeout(timeout);\n                }\n              }; // build asynchronously to keep `this.viewer` is accessible in `ready` event handler.\n\n              timeout = setTimeout(function () {\n                _this.delaying = false;\n\n                _this.build();\n              }, 0);\n            }\n          };\n\n          this.initializing = {\n            abort: function abort() {\n              forEach(images, function (image) {\n                if (!image.complete) {\n                  removeListener(image, EVENT_LOAD, progress);\n                  removeListener(image, EVENT_ERROR, progress);\n                }\n              });\n            }\n          };\n          forEach(images, function (image) {\n            if (image.complete) {\n              progress();\n            } else {\n              var onLoad;\n              var onError;\n              addListener(image, EVENT_LOAD, onLoad = function onLoad() {\n                removeListener(image, EVENT_ERROR, onError);\n                progress();\n              }, {\n                once: true\n              });\n              addListener(image, EVENT_ERROR, onError = function onError() {\n                removeListener(image, EVENT_LOAD, onLoad);\n                progress();\n              }, {\n                once: true\n              });\n            }\n          });\n        } else {\n          addListener(element, EVENT_CLICK, this.onStart = function (_ref) {\n            var target = _ref.target;\n\n            if (target.localName === 'img' && (!isFunction(options.filter) || options.filter.call(_this, target))) {\n              _this.view(_this.images.indexOf(target));\n            }\n          });\n        }\n      }\n    }, {\n      key: \"build\",\n      value: function build() {\n        if (this.ready) {\n          return;\n        }\n\n        var element = this.element,\n            options = this.options;\n        var parent = element.parentNode;\n        var template = document.createElement('div');\n        template.innerHTML = TEMPLATE;\n        var viewer = template.querySelector(\".\".concat(NAMESPACE, \"-container\"));\n        var title = viewer.querySelector(\".\".concat(NAMESPACE, \"-title\"));\n        var toolbar = viewer.querySelector(\".\".concat(NAMESPACE, \"-toolbar\"));\n        var navbar = viewer.querySelector(\".\".concat(NAMESPACE, \"-navbar\"));\n        var button = viewer.querySelector(\".\".concat(NAMESPACE, \"-button\"));\n        var canvas = viewer.querySelector(\".\".concat(NAMESPACE, \"-canvas\"));\n        this.parent = parent;\n        this.viewer = viewer;\n        this.title = title;\n        this.toolbar = toolbar;\n        this.navbar = navbar;\n        this.button = button;\n        this.canvas = canvas;\n        this.footer = viewer.querySelector(\".\".concat(NAMESPACE, \"-footer\"));\n        this.tooltipBox = viewer.querySelector(\".\".concat(NAMESPACE, \"-tooltip\"));\n        this.player = viewer.querySelector(\".\".concat(NAMESPACE, \"-player\"));\n        this.list = viewer.querySelector(\".\".concat(NAMESPACE, \"-list\"));\n        viewer.id = \"\".concat(NAMESPACE).concat(this.id);\n        title.id = \"\".concat(NAMESPACE, \"Title\").concat(this.id);\n        addClass(title, !options.title ? CLASS_HIDE : getResponsiveClass(Array.isArray(options.title) ? options.title[0] : options.title));\n        addClass(navbar, !options.navbar ? CLASS_HIDE : getResponsiveClass(options.navbar));\n        toggleClass(button, CLASS_HIDE, !options.button);\n\n        if (options.keyboard) {\n          button.setAttribute('tabindex', 0);\n        }\n\n        if (options.backdrop) {\n          addClass(viewer, \"\".concat(NAMESPACE, \"-backdrop\"));\n\n          if (!options.inline && options.backdrop !== 'static') {\n            setData(canvas, DATA_ACTION, 'hide');\n          }\n        }\n\n        if (isString(options.className) && options.className) {\n          // In case there are multiple class names\n          options.className.split(REGEXP_SPACES).forEach(function (className) {\n            addClass(viewer, className);\n          });\n        }\n\n        if (options.toolbar) {\n          var list = document.createElement('ul');\n          var custom = isPlainObject(options.toolbar);\n          var zoomButtons = BUTTONS.slice(0, 3);\n          var rotateButtons = BUTTONS.slice(7, 9);\n          var scaleButtons = BUTTONS.slice(9);\n\n          if (!custom) {\n            addClass(toolbar, getResponsiveClass(options.toolbar));\n          }\n\n          forEach(custom ? options.toolbar : BUTTONS, function (value, index) {\n            var deep = custom && isPlainObject(value);\n            var name = custom ? hyphenate(index) : value;\n            var show = deep && !isUndefined(value.show) ? value.show : value;\n\n            if (!show || !options.zoomable && zoomButtons.indexOf(name) !== -1 || !options.rotatable && rotateButtons.indexOf(name) !== -1 || !options.scalable && scaleButtons.indexOf(name) !== -1) {\n              return;\n            }\n\n            var size = deep && !isUndefined(value.size) ? value.size : value;\n            var click = deep && !isUndefined(value.click) ? value.click : value;\n            var item = document.createElement('li');\n\n            if (options.keyboard) {\n              item.setAttribute('tabindex', 0);\n            }\n\n            item.setAttribute('role', 'button');\n            addClass(item, \"\".concat(NAMESPACE, \"-\").concat(name));\n\n            if (!isFunction(click)) {\n              setData(item, DATA_ACTION, name);\n            }\n\n            if (isNumber(show)) {\n              addClass(item, getResponsiveClass(show));\n            }\n\n            if (['small', 'large'].indexOf(size) !== -1) {\n              addClass(item, \"\".concat(NAMESPACE, \"-\").concat(size));\n            } else if (name === 'play') {\n              addClass(item, \"\".concat(NAMESPACE, \"-large\"));\n            }\n\n            if (isFunction(click)) {\n              addListener(item, EVENT_CLICK, click);\n            }\n\n            list.appendChild(item);\n          });\n          toolbar.appendChild(list);\n        } else {\n          addClass(toolbar, CLASS_HIDE);\n        }\n\n        if (!options.rotatable) {\n          var rotates = toolbar.querySelectorAll('li[class*=\"rotate\"]');\n          addClass(rotates, CLASS_INVISIBLE);\n          forEach(rotates, function (rotate) {\n            toolbar.appendChild(rotate);\n          });\n        }\n\n        if (options.inline) {\n          addClass(button, CLASS_FULLSCREEN);\n          setStyle(viewer, {\n            zIndex: options.zIndexInline\n          });\n\n          if (window.getComputedStyle(parent).position === 'static') {\n            setStyle(parent, {\n              position: 'relative'\n            });\n          }\n\n          parent.insertBefore(viewer, element.nextSibling);\n        } else {\n          addClass(button, CLASS_CLOSE);\n          addClass(viewer, CLASS_FIXED);\n          addClass(viewer, CLASS_FADE);\n          addClass(viewer, CLASS_HIDE);\n          setStyle(viewer, {\n            zIndex: options.zIndex\n          });\n          var container = options.container;\n\n          if (isString(container)) {\n            container = element.ownerDocument.querySelector(container);\n          }\n\n          if (!container) {\n            container = this.body;\n          }\n\n          container.appendChild(viewer);\n        }\n\n        if (options.inline) {\n          this.render();\n          this.bind();\n          this.isShown = true;\n        }\n\n        this.ready = true;\n\n        if (isFunction(options.ready)) {\n          addListener(element, EVENT_READY, options.ready, {\n            once: true\n          });\n        }\n\n        if (dispatchEvent(element, EVENT_READY) === false) {\n          this.ready = false;\n          return;\n        }\n\n        if (this.ready && options.inline) {\n          this.view(this.index);\n        }\n      }\n      /**\n       * Get the no conflict viewer class.\n       * @returns {Viewer} The viewer class.\n       */\n\n    }], [{\n      key: \"noConflict\",\n      value: function noConflict() {\n        window.Viewer = AnotherViewer;\n        return Viewer;\n      }\n      /**\n       * Change the default options.\n       * @param {Object} options - The new default options.\n       */\n\n    }, {\n      key: \"setDefaults\",\n      value: function setDefaults(options) {\n        assign(DEFAULTS, isPlainObject(options) && options);\n      }\n    }]);\n\n    return Viewer;\n  }();\n\n  assign(Viewer.prototype, render, events, handlers, methods, others);\n  return Viewer;\n});","map":{"version":3,"sources":["/Users/kevindavilabenavides/Documents/projects/ko-sama/node_modules/viewerjs/dist/viewer.js"],"names":["global","factory","exports","module","define","amd","globalThis","self","Viewer","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread2","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_typeof","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","descriptor","configurable","writable","_toPropertyKey","key","_createClass","protoProps","staticProps","obj","value","_toPrimitive","input","hint","prim","toPrimitive","undefined","res","call","String","Number","arg","DEFAULTS","backdrop","button","navbar","title","toolbar","className","container","fullscreen","inheritedAttributes","initialCoverage","initialViewIndex","inline","interval","keyboard","focus","loading","loop","minWidth","minHeight","movable","rotatable","scalable","zoomable","zoomOnTouch","zoomOnWheel","slideOnTouch","toggleOnDblclick","tooltip","transition","zIndex","zIndexInline","zoomRatio","minZoomRatio","maxZoomRatio","url","ready","show","shown","hide","hidden","view","viewed","move","moved","rotate","rotated","scale","scaled","zoom","zoomed","play","stop","TEMPLATE","IS_BROWSER","window","document","WINDOW","IS_TOUCH_DEVICE","documentElement","HAS_POINTER_EVENT","NAMESPACE","ACTION_MOVE","ACTION_SWITCH","ACTION_ZOOM","CLASS_ACTIVE","concat","CLASS_CLOSE","CLASS_FADE","CLASS_FIXED","CLASS_FULLSCREEN","CLASS_FULLSCREEN_EXIT","CLASS_HIDE","CLASS_HIDE_MD_DOWN","CLASS_HIDE_SM_DOWN","CLASS_HIDE_XS_DOWN","CLASS_IN","CLASS_INVISIBLE","CLASS_LOADING","CLASS_MOVE","CLASS_OPEN","CLASS_SHOW","CLASS_TRANSITION","EVENT_CLICK","EVENT_DBLCLICK","EVENT_DRAG_START","EVENT_FOCUSIN","EVENT_KEY_DOWN","EVENT_LOAD","EVENT_ERROR","EVENT_TOUCH_END","EVENT_TOUCH_MOVE","EVENT_TOUCH_START","EVENT_POINTER_DOWN","EVENT_POINTER_MOVE","EVENT_POINTER_UP","EVENT_RESIZE","EVENT_TRANSITION_END","EVENT_WHEEL","EVENT_READY","EVENT_SHOW","EVENT_SHOWN","EVENT_HIDE","EVENT_HIDDEN","EVENT_VIEW","EVENT_VIEWED","EVENT_MOVE","EVENT_MOVED","EVENT_ROTATE","EVENT_ROTATED","EVENT_SCALE","EVENT_SCALED","EVENT_ZOOM","EVENT_ZOOMED","EVENT_PLAY","EVENT_STOP","DATA_ACTION","REGEXP_SPACES","BUTTONS","isString","isNaN","isNumber","isUndefined","isObject","hasOwnProperty","isPlainObject","_constructor","error","isFunction","data","callback","Array","isArray","assign","_len","args","_key","REGEXP_SUFFIX","setStyle","element","styles","style","property","test","escapeHTMLEntities","replace","hasClass","classList","contains","indexOf","addClass","elem","add","trim","removeClass","remove","toggleClass","added","REGEXP_HYPHENATE","hyphenate","toLowerCase","getData","name","dataset","getAttribute","setData","setAttribute","onceSupported","supported","once","listener","options","get","set","addEventListener","removeEventListener","removeListener","type","handler","split","event","listeners","addListener","_handler","_element$listeners","_len2","_key2","dispatchEvent","Event","CustomEvent","bubbles","cancelable","detail","createEvent","initCustomEvent","getOffset","box","getBoundingClientRect","left","pageXOffset","clientLeft","top","pageYOffset","clientTop","getTransforms","_ref","scaleX","scaleY","translateX","translateY","values","transform","join","WebkitTransform","msTransform","getImageNameFromURL","decodeURIComponent","IS_SAFARI","navigator","userAgent","getImageNaturalSizes","image","newImage","createElement","naturalWidth","naturalHeight","body","onload","width","height","removeChild","src","cssText","appendChild","getResponsiveClass","getMaxZoomRatio","pointers","pointers2","ratios","pointer","pointerId","pointer2","x1","Math","abs","startX","y1","startY","x2","endX","y2","endY","z1","sqrt","z2","ratio","sort","a","b","getPointer","_ref2","endOnly","pageX","pageY","end","timeStamp","Date","now","getPointersCenter","count","_ref3","render","initContainer","initViewer","initList","renderViewer","initBody","ownerDocument","scrollbarWidth","innerWidth","clientWidth","initialBodyPaddingRight","paddingRight","initialBodyComputedPaddingRight","getComputedStyle","containerData","innerHeight","parent","viewerData","max","offsetWidth","offsetHeight","parentData","fulled","viewer","_this","list","items","innerHTML","images","index","alt","getImageURL","item","img","firstElementChild","onLoad","onError","loadImage","renderList","next","nextElementSibling","gutter","parseInt","marginLeft","outerWidth","resetList","initImage","done","_this2","footerHeight","footer","viewerWidth","viewerHeight","oldImageData","imageData","sizingImage","imageInitializing","abort","aspectRatio","min","x","y","oldRatio","initialImageData","renderImage","_this3","marginTop","viewing","moving","rotating","scaling","zooming","onTransitionEnd","imageRendering","resetImage","parentNode","events","bind","canvas","onClick","click","onDragStart","dragstart","onPointerDown","pointerdown","onPointerMove","pointermove","onPointerUp","pointerup","onKeyDown","keydown","onResize","resize","onWheel","wheel","passive","capture","onDblclick","dblclick","unbind","handlers","action","localName","parentElement","isTrusted","clearTimeout","clickCanvasTimeout","played","exit","full","pointerMoved","toggle","reset","prev","preventDefault","doubleClickImageTimeout","originalEvent","load","timeout","originalImage","parentWidth","parentHeight","filled","keyCode","which","charCode","playing","ctrlKey","buttons","showing","hiding","pointerType","changedTouches","touch","identifier","isSwitchable","change","imageClicked","setTimeout","isShown","close","open","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","player","getElementsByTagName","_this4","wheeling","delta","deltaY","wheelDelta","methods","immediate","build","transitioning","id","removeAttribute","initialOffsetWidth","hideImmediately","onViewerTransitionEnd","onImageTransitionEnd","zoomTo","querySelector","activeItem","onViewed","complete","maxIndex","moveTo","_originalEvent","oldX","oldY","changed","degree","rotateTo","oldDegree","_scaleX","_scaleY","_this5","oldScaleX","oldScaleY","showTooltip","pivot","_this6","_zoomable","newWidth","newHeight","offset","center","_this7","total","onLoadWhenPlay","requestFullscreen","referrerPolicy","_this8","exitFullscreen","_this9","enforceFocus","_this10","clearEnforceFocus","_this11","tooltipBox","textContent","round","tooltipping","fading","update","_this12","isImg","destroy","querySelectorAll","changedIndexes","changedIndex","destroyed","delaying","initializing","onStart","others","onFocusin","parseFloat","fucus","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","mozRequestFullScreen","msRequestFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen","offsetX","offsetY","absoluteOffsetX","p","AnotherViewer","getUniqueID","nodeType","Error","init","progress","template","custom","zoomButtons","slice","rotateButtons","scaleButtons","deep","size","rotates","position","insertBefore","nextSibling","noConflict","setDefaults"],"mappings":"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","sourcesContent":["/*!\n * Viewer.js v1.11.6\n * https://fengyuanchen.github.io/viewerjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2023-09-17T03:16:38.052Z\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.Viewer = factory());\n})(this, (function () { 'use strict';\n\n  function ownKeys(e, r) {\n    var t = Object.keys(e);\n    if (Object.getOwnPropertySymbols) {\n      var o = Object.getOwnPropertySymbols(e);\n      r && (o = o.filter(function (r) {\n        return Object.getOwnPropertyDescriptor(e, r).enumerable;\n      })), t.push.apply(t, o);\n    }\n    return t;\n  }\n  function _objectSpread2(e) {\n    for (var r = 1; r < arguments.length; r++) {\n      var t = null != arguments[r] ? arguments[r] : {};\n      r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n        _defineProperty(e, r, t[r]);\n      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n        Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n      });\n    }\n    return e;\n  }\n  function _typeof(o) {\n    \"@babel/helpers - typeof\";\n\n    return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n      return typeof o;\n    } : function (o) {\n      return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n    }, _typeof(o);\n  }\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor);\n    }\n  }\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    Object.defineProperty(Constructor, \"prototype\", {\n      writable: false\n    });\n    return Constructor;\n  }\n  function _defineProperty(obj, key, value) {\n    key = _toPropertyKey(key);\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n    return obj;\n  }\n  function _toPrimitive(input, hint) {\n    if (typeof input !== \"object\" || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || \"default\");\n      if (typeof res !== \"object\") return res;\n      throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n    }\n    return (hint === \"string\" ? String : Number)(input);\n  }\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, \"string\");\n    return typeof key === \"symbol\" ? key : String(key);\n  }\n\n  var DEFAULTS = {\n    /**\n     * Enable a modal backdrop, specify `static` for a backdrop\n     * which doesn't close the modal on click.\n     * @type {boolean}\n     */\n    backdrop: true,\n    /**\n     * Show the button on the top-right of the viewer.\n     * @type {boolean}\n     */\n    button: true,\n    /**\n     * Show the navbar.\n     * @type {boolean | number}\n     */\n    navbar: true,\n    /**\n     * Specify the visibility and the content of the title.\n     * @type {boolean | number | Function | Array}\n     */\n    title: true,\n    /**\n     * Show the toolbar.\n     * @type {boolean | number | Object}\n     */\n    toolbar: true,\n    /**\n     * Custom class name(s) to add to the viewer's root element.\n     * @type {string}\n     */\n    className: '',\n    /**\n     * Define where to put the viewer in modal mode.\n     * @type {string | Element}\n     */\n    container: 'body',\n    /**\n     * Filter the images for viewing. Return true if the image is viewable.\n     * @type {Function}\n     */\n    filter: null,\n    /**\n     * Enable to request fullscreen when play.\n     * {@link https://developer.mozilla.org/en-US/docs/Web/API/FullscreenOptions}\n     * @type {boolean|FullscreenOptions}\n     */\n    fullscreen: true,\n    /**\n     * Define the extra attributes to inherit from the original image.\n     * @type {Array}\n     */\n    inheritedAttributes: ['crossOrigin', 'decoding', 'isMap', 'loading', 'referrerPolicy', 'sizes', 'srcset', 'useMap'],\n    /**\n     * Define the initial coverage of the viewing image.\n     * @type {number}\n     */\n    initialCoverage: 0.9,\n    /**\n     * Define the initial index of the image for viewing.\n     * @type {number}\n     */\n    initialViewIndex: 0,\n    /**\n     * Enable inline mode.\n     * @type {boolean}\n     */\n    inline: false,\n    /**\n     * The amount of time to delay between automatically cycling an image when playing.\n     * @type {number}\n     */\n    interval: 5000,\n    /**\n     * Enable keyboard support.\n     * @type {boolean}\n     */\n    keyboard: true,\n    /**\n     * Focus the viewer when initialized.\n     * @type {boolean}\n     */\n    focus: true,\n    /**\n     * Indicate if show a loading spinner when load image or not.\n     * @type {boolean}\n     */\n    loading: true,\n    /**\n     * Indicate if enable loop viewing or not.\n     * @type {boolean}\n     */\n    loop: true,\n    /**\n     * Min width of the viewer in inline mode.\n     * @type {number}\n     */\n    minWidth: 200,\n    /**\n     * Min height of the viewer in inline mode.\n     * @type {number}\n     */\n    minHeight: 100,\n    /**\n     * Enable to move the image.\n     * @type {boolean}\n     */\n    movable: true,\n    /**\n     * Enable to rotate the image.\n     * @type {boolean}\n     */\n    rotatable: true,\n    /**\n     * Enable to scale the image.\n     * @type {boolean}\n     */\n    scalable: true,\n    /**\n     * Enable to zoom the image.\n     * @type {boolean}\n     */\n    zoomable: true,\n    /**\n     * Enable to zoom the current image by dragging on the touch screen.\n     * @type {boolean}\n     */\n    zoomOnTouch: true,\n    /**\n     * Enable to zoom the image by wheeling mouse.\n     * @type {boolean}\n     */\n    zoomOnWheel: true,\n    /**\n     * Enable to slide to the next or previous image by swiping on the touch screen.\n     * @type {boolean}\n     */\n    slideOnTouch: true,\n    /**\n     * Indicate if toggle the image size between its natural size\n     * and initial size when double click on the image or not.\n     * @type {boolean}\n     */\n    toggleOnDblclick: true,\n    /**\n     * Show the tooltip with image ratio (percentage) when zoom in or zoom out.\n     * @type {boolean}\n     */\n    tooltip: true,\n    /**\n     * Enable CSS3 Transition for some special elements.\n     * @type {boolean}\n     */\n    transition: true,\n    /**\n     * Define the CSS `z-index` value of viewer in modal mode.\n     * @type {number}\n     */\n    zIndex: 2015,\n    /**\n     * Define the CSS `z-index` value of viewer in inline mode.\n     * @type {number}\n     */\n    zIndexInline: 0,\n    /**\n     * Define the ratio when zoom the image by wheeling mouse.\n     * @type {number}\n     */\n    zoomRatio: 0.1,\n    /**\n     * Define the min ratio of the image when zoom out.\n     * @type {number}\n     */\n    minZoomRatio: 0.01,\n    /**\n     * Define the max ratio of the image when zoom in.\n     * @type {number}\n     */\n    maxZoomRatio: 100,\n    /**\n     * Define where to get the original image URL for viewing.\n     * @type {string | Function}\n     */\n    url: 'src',\n    /**\n     * Event shortcuts.\n     * @type {Function}\n     */\n    ready: null,\n    show: null,\n    shown: null,\n    hide: null,\n    hidden: null,\n    view: null,\n    viewed: null,\n    move: null,\n    moved: null,\n    rotate: null,\n    rotated: null,\n    scale: null,\n    scaled: null,\n    zoom: null,\n    zoomed: null,\n    play: null,\n    stop: null\n  };\n\n  var TEMPLATE = '<div class=\"viewer-container\" tabindex=\"-1\" touch-action=\"none\">' + '<div class=\"viewer-canvas\"></div>' + '<div class=\"viewer-footer\">' + '<div class=\"viewer-title\"></div>' + '<div class=\"viewer-toolbar\"></div>' + '<div class=\"viewer-navbar\">' + '<ul class=\"viewer-list\" role=\"navigation\"></ul>' + '</div>' + '</div>' + '<div class=\"viewer-tooltip\" role=\"alert\" aria-hidden=\"true\"></div>' + '<div class=\"viewer-button\" data-viewer-action=\"mix\" role=\"button\"></div>' + '<div class=\"viewer-player\"></div>' + '</div>';\n\n  var IS_BROWSER = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  var WINDOW = IS_BROWSER ? window : {};\n  var IS_TOUCH_DEVICE = IS_BROWSER && WINDOW.document.documentElement ? 'ontouchstart' in WINDOW.document.documentElement : false;\n  var HAS_POINTER_EVENT = IS_BROWSER ? 'PointerEvent' in WINDOW : false;\n  var NAMESPACE = 'viewer';\n\n  // Actions\n  var ACTION_MOVE = 'move';\n  var ACTION_SWITCH = 'switch';\n  var ACTION_ZOOM = 'zoom';\n\n  // Classes\n  var CLASS_ACTIVE = \"\".concat(NAMESPACE, \"-active\");\n  var CLASS_CLOSE = \"\".concat(NAMESPACE, \"-close\");\n  var CLASS_FADE = \"\".concat(NAMESPACE, \"-fade\");\n  var CLASS_FIXED = \"\".concat(NAMESPACE, \"-fixed\");\n  var CLASS_FULLSCREEN = \"\".concat(NAMESPACE, \"-fullscreen\");\n  var CLASS_FULLSCREEN_EXIT = \"\".concat(NAMESPACE, \"-fullscreen-exit\");\n  var CLASS_HIDE = \"\".concat(NAMESPACE, \"-hide\");\n  var CLASS_HIDE_MD_DOWN = \"\".concat(NAMESPACE, \"-hide-md-down\");\n  var CLASS_HIDE_SM_DOWN = \"\".concat(NAMESPACE, \"-hide-sm-down\");\n  var CLASS_HIDE_XS_DOWN = \"\".concat(NAMESPACE, \"-hide-xs-down\");\n  var CLASS_IN = \"\".concat(NAMESPACE, \"-in\");\n  var CLASS_INVISIBLE = \"\".concat(NAMESPACE, \"-invisible\");\n  var CLASS_LOADING = \"\".concat(NAMESPACE, \"-loading\");\n  var CLASS_MOVE = \"\".concat(NAMESPACE, \"-move\");\n  var CLASS_OPEN = \"\".concat(NAMESPACE, \"-open\");\n  var CLASS_SHOW = \"\".concat(NAMESPACE, \"-show\");\n  var CLASS_TRANSITION = \"\".concat(NAMESPACE, \"-transition\");\n\n  // Native events\n  var EVENT_CLICK = 'click';\n  var EVENT_DBLCLICK = 'dblclick';\n  var EVENT_DRAG_START = 'dragstart';\n  var EVENT_FOCUSIN = 'focusin';\n  var EVENT_KEY_DOWN = 'keydown';\n  var EVENT_LOAD = 'load';\n  var EVENT_ERROR = 'error';\n  var EVENT_TOUCH_END = IS_TOUCH_DEVICE ? 'touchend touchcancel' : 'mouseup';\n  var EVENT_TOUCH_MOVE = IS_TOUCH_DEVICE ? 'touchmove' : 'mousemove';\n  var EVENT_TOUCH_START = IS_TOUCH_DEVICE ? 'touchstart' : 'mousedown';\n  var EVENT_POINTER_DOWN = HAS_POINTER_EVENT ? 'pointerdown' : EVENT_TOUCH_START;\n  var EVENT_POINTER_MOVE = HAS_POINTER_EVENT ? 'pointermove' : EVENT_TOUCH_MOVE;\n  var EVENT_POINTER_UP = HAS_POINTER_EVENT ? 'pointerup pointercancel' : EVENT_TOUCH_END;\n  var EVENT_RESIZE = 'resize';\n  var EVENT_TRANSITION_END = 'transitionend';\n  var EVENT_WHEEL = 'wheel';\n\n  // Custom events\n  var EVENT_READY = 'ready';\n  var EVENT_SHOW = 'show';\n  var EVENT_SHOWN = 'shown';\n  var EVENT_HIDE = 'hide';\n  var EVENT_HIDDEN = 'hidden';\n  var EVENT_VIEW = 'view';\n  var EVENT_VIEWED = 'viewed';\n  var EVENT_MOVE = 'move';\n  var EVENT_MOVED = 'moved';\n  var EVENT_ROTATE = 'rotate';\n  var EVENT_ROTATED = 'rotated';\n  var EVENT_SCALE = 'scale';\n  var EVENT_SCALED = 'scaled';\n  var EVENT_ZOOM = 'zoom';\n  var EVENT_ZOOMED = 'zoomed';\n  var EVENT_PLAY = 'play';\n  var EVENT_STOP = 'stop';\n\n  // Data keys\n  var DATA_ACTION = \"\".concat(NAMESPACE, \"Action\");\n\n  // RegExps\n  var REGEXP_SPACES = /\\s\\s*/;\n\n  // Misc\n  var BUTTONS = ['zoom-in', 'zoom-out', 'one-to-one', 'reset', 'prev', 'play', 'next', 'rotate-left', 'rotate-right', 'flip-horizontal', 'flip-vertical'];\n\n  /**\n   * Check if the given value is a string.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a string, else `false`.\n   */\n  function isString(value) {\n    return typeof value === 'string';\n  }\n\n  /**\n   * Check if the given value is not a number.\n   */\n  var isNaN = Number.isNaN || WINDOW.isNaN;\n\n  /**\n   * Check if the given value is a number.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a number, else `false`.\n   */\n  function isNumber(value) {\n    return typeof value === 'number' && !isNaN(value);\n  }\n\n  /**\n   * Check if the given value is undefined.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is undefined, else `false`.\n   */\n  function isUndefined(value) {\n    return typeof value === 'undefined';\n  }\n\n  /**\n   * Check if the given value is an object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is an object, else `false`.\n   */\n  function isObject(value) {\n    return _typeof(value) === 'object' && value !== null;\n  }\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n\n  /**\n   * Check if the given value is a plain object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a plain object, else `false`.\n   */\n  function isPlainObject(value) {\n    if (!isObject(value)) {\n      return false;\n    }\n    try {\n      var _constructor = value.constructor;\n      var prototype = _constructor.prototype;\n      return _constructor && prototype && hasOwnProperty.call(prototype, 'isPrototypeOf');\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * Check if the given value is a function.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a function, else `false`.\n   */\n  function isFunction(value) {\n    return typeof value === 'function';\n  }\n\n  /**\n   * Iterate the given data.\n   * @param {*} data - The data to iterate.\n   * @param {Function} callback - The process function for each element.\n   * @returns {*} The original data.\n   */\n  function forEach(data, callback) {\n    if (data && isFunction(callback)) {\n      if (Array.isArray(data) || isNumber(data.length) /* array-like */) {\n        var length = data.length;\n        var i;\n        for (i = 0; i < length; i += 1) {\n          if (callback.call(data, data[i], i, data) === false) {\n            break;\n          }\n        }\n      } else if (isObject(data)) {\n        Object.keys(data).forEach(function (key) {\n          callback.call(data, data[key], key, data);\n        });\n      }\n    }\n    return data;\n  }\n\n  /**\n   * Extend the given object.\n   * @param {*} obj - The object to be extended.\n   * @param {*} args - The rest objects which will be merged to the first object.\n   * @returns {Object} The extended object.\n   */\n  var assign = Object.assign || function assign(obj) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n    if (isObject(obj) && args.length > 0) {\n      args.forEach(function (arg) {\n        if (isObject(arg)) {\n          Object.keys(arg).forEach(function (key) {\n            obj[key] = arg[key];\n          });\n        }\n      });\n    }\n    return obj;\n  };\n  var REGEXP_SUFFIX = /^(?:width|height|left|top|marginLeft|marginTop)$/;\n\n  /**\n   * Apply styles to the given element.\n   * @param {Element} element - The target element.\n   * @param {Object} styles - The styles for applying.\n   */\n  function setStyle(element, styles) {\n    var style = element.style;\n    forEach(styles, function (value, property) {\n      if (REGEXP_SUFFIX.test(property) && isNumber(value)) {\n        value += 'px';\n      }\n      style[property] = value;\n    });\n  }\n\n  /**\n   * Escape a string for using in HTML.\n   * @param {String} value - The string to escape.\n   * @returns {String} Returns the escaped string.\n   */\n  function escapeHTMLEntities(value) {\n    return isString(value) ? value.replace(/&(?!amp;|quot;|#39;|lt;|gt;)/g, '&amp;').replace(/\"/g, '&quot;').replace(/'/g, '&#39;').replace(/</g, '&lt;').replace(/>/g, '&gt;') : value;\n  }\n\n  /**\n   * Check if the given element has a special class.\n   * @param {Element} element - The element to check.\n   * @param {string} value - The class to search.\n   * @returns {boolean} Returns `true` if the special class was found.\n   */\n  function hasClass(element, value) {\n    if (!element || !value) {\n      return false;\n    }\n    return element.classList ? element.classList.contains(value) : element.className.indexOf(value) > -1;\n  }\n\n  /**\n   * Add classes to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be added.\n   */\n  function addClass(element, value) {\n    if (!element || !value) {\n      return;\n    }\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        addClass(elem, value);\n      });\n      return;\n    }\n    if (element.classList) {\n      element.classList.add(value);\n      return;\n    }\n    var className = element.className.trim();\n    if (!className) {\n      element.className = value;\n    } else if (className.indexOf(value) < 0) {\n      element.className = \"\".concat(className, \" \").concat(value);\n    }\n  }\n\n  /**\n   * Remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be removed.\n   */\n  function removeClass(element, value) {\n    if (!element || !value) {\n      return;\n    }\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        removeClass(elem, value);\n      });\n      return;\n    }\n    if (element.classList) {\n      element.classList.remove(value);\n      return;\n    }\n    if (element.className.indexOf(value) >= 0) {\n      element.className = element.className.replace(value, '');\n    }\n  }\n\n  /**\n   * Add or remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be toggled.\n   * @param {boolean} added - Add only.\n   */\n  function toggleClass(element, value, added) {\n    if (!value) {\n      return;\n    }\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        toggleClass(elem, value, added);\n      });\n      return;\n    }\n\n    // IE10-11 doesn't support the second parameter of `classList.toggle`\n    if (added) {\n      addClass(element, value);\n    } else {\n      removeClass(element, value);\n    }\n  }\n  var REGEXP_HYPHENATE = /([a-z\\d])([A-Z])/g;\n\n  /**\n   * Transform the given string from camelCase to kebab-case\n   * @param {string} value - The value to transform.\n   * @returns {string} The transformed value.\n   */\n  function hyphenate(value) {\n    return value.replace(REGEXP_HYPHENATE, '$1-$2').toLowerCase();\n  }\n\n  /**\n   * Get data from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to get.\n   * @returns {string} The data value.\n   */\n  function getData(element, name) {\n    if (isObject(element[name])) {\n      return element[name];\n    }\n    if (element.dataset) {\n      return element.dataset[name];\n    }\n    return element.getAttribute(\"data-\".concat(hyphenate(name)));\n  }\n\n  /**\n   * Set data to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to set.\n   * @param {string} data - The data value.\n   */\n  function setData(element, name, data) {\n    if (isObject(data)) {\n      element[name] = data;\n    } else if (element.dataset) {\n      element.dataset[name] = data;\n    } else {\n      element.setAttribute(\"data-\".concat(hyphenate(name)), data);\n    }\n  }\n  var onceSupported = function () {\n    var supported = false;\n    if (IS_BROWSER) {\n      var once = false;\n      var listener = function listener() {};\n      var options = Object.defineProperty({}, 'once', {\n        get: function get() {\n          supported = true;\n          return once;\n        },\n        /**\n         * This setter can fix a `TypeError` in strict mode\n         * {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Getter_only}\n         * @param {boolean} value - The value to set\n         */\n        set: function set(value) {\n          once = value;\n        }\n      });\n      WINDOW.addEventListener('test', listener, options);\n      WINDOW.removeEventListener('test', listener, options);\n    }\n    return supported;\n  }();\n\n  /**\n   * Remove event listener from the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n  function removeListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (!onceSupported) {\n        var listeners = element.listeners;\n        if (listeners && listeners[event] && listeners[event][listener]) {\n          handler = listeners[event][listener];\n          delete listeners[event][listener];\n          if (Object.keys(listeners[event]).length === 0) {\n            delete listeners[event];\n          }\n          if (Object.keys(listeners).length === 0) {\n            delete element.listeners;\n          }\n        }\n      }\n      element.removeEventListener(event, handler, options);\n    });\n  }\n\n  /**\n   * Add event listener to the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n  function addListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var _handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (options.once && !onceSupported) {\n        var _element$listeners = element.listeners,\n          listeners = _element$listeners === void 0 ? {} : _element$listeners;\n        _handler = function handler() {\n          delete listeners[event][listener];\n          element.removeEventListener(event, _handler, options);\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n          listener.apply(element, args);\n        };\n        if (!listeners[event]) {\n          listeners[event] = {};\n        }\n        if (listeners[event][listener]) {\n          element.removeEventListener(event, listeners[event][listener], options);\n        }\n        listeners[event][listener] = _handler;\n        element.listeners = listeners;\n      }\n      element.addEventListener(event, _handler, options);\n    });\n  }\n\n  /**\n   * Dispatch event on the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Object} data - The additional event data.\n   * @param {Object} options - The additional event options.\n   * @returns {boolean} Indicate if the event is default prevented or not.\n   */\n  function dispatchEvent(element, type, data, options) {\n    var event;\n\n    // Event and CustomEvent on IE9-11 are global objects, not constructors\n    if (isFunction(Event) && isFunction(CustomEvent)) {\n      event = new CustomEvent(type, _objectSpread2({\n        bubbles: true,\n        cancelable: true,\n        detail: data\n      }, options));\n    } else {\n      event = document.createEvent('CustomEvent');\n      event.initCustomEvent(type, true, true, data);\n    }\n    return element.dispatchEvent(event);\n  }\n\n  /**\n   * Get the offset base on the document.\n   * @param {Element} element - The target element.\n   * @returns {Object} The offset data.\n   */\n  function getOffset(element) {\n    var box = element.getBoundingClientRect();\n    return {\n      left: box.left + (window.pageXOffset - document.documentElement.clientLeft),\n      top: box.top + (window.pageYOffset - document.documentElement.clientTop)\n    };\n  }\n\n  /**\n   * Get transforms base on the given object.\n   * @param {Object} obj - The target object.\n   * @returns {string} A string contains transform values.\n   */\n  function getTransforms(_ref) {\n    var rotate = _ref.rotate,\n      scaleX = _ref.scaleX,\n      scaleY = _ref.scaleY,\n      translateX = _ref.translateX,\n      translateY = _ref.translateY;\n    var values = [];\n    if (isNumber(translateX) && translateX !== 0) {\n      values.push(\"translateX(\".concat(translateX, \"px)\"));\n    }\n    if (isNumber(translateY) && translateY !== 0) {\n      values.push(\"translateY(\".concat(translateY, \"px)\"));\n    }\n\n    // Rotate should come first before scale to match orientation transform\n    if (isNumber(rotate) && rotate !== 0) {\n      values.push(\"rotate(\".concat(rotate, \"deg)\"));\n    }\n    if (isNumber(scaleX) && scaleX !== 1) {\n      values.push(\"scaleX(\".concat(scaleX, \")\"));\n    }\n    if (isNumber(scaleY) && scaleY !== 1) {\n      values.push(\"scaleY(\".concat(scaleY, \")\"));\n    }\n    var transform = values.length ? values.join(' ') : 'none';\n    return {\n      WebkitTransform: transform,\n      msTransform: transform,\n      transform: transform\n    };\n  }\n\n  /**\n   * Get an image name from an image url.\n   * @param {string} url - The target url.\n   * @example\n   * // picture.jpg\n   * getImageNameFromURL('https://domain.com/path/to/picture.jpg?size=1280×960')\n   * @returns {string} A string contains the image name.\n   */\n  function getImageNameFromURL(url) {\n    return isString(url) ? decodeURIComponent(url.replace(/^.*\\//, '').replace(/[?&#].*$/, '')) : '';\n  }\n  var IS_SAFARI = WINDOW.navigator && /Version\\/\\d+(\\.\\d+)+?\\s+Safari/i.test(WINDOW.navigator.userAgent);\n\n  /**\n   * Get an image's natural sizes.\n   * @param {string} image - The target image.\n   * @param {Object} options - The viewer options.\n   * @param {Function} callback - The callback function.\n   * @returns {HTMLImageElement} The new image.\n   */\n  function getImageNaturalSizes(image, options, callback) {\n    var newImage = document.createElement('img');\n\n    // Modern browsers (except Safari)\n    if (image.naturalWidth && !IS_SAFARI) {\n      callback(image.naturalWidth, image.naturalHeight);\n      return newImage;\n    }\n    var body = document.body || document.documentElement;\n    newImage.onload = function () {\n      callback(newImage.width, newImage.height);\n      if (!IS_SAFARI) {\n        body.removeChild(newImage);\n      }\n    };\n    forEach(options.inheritedAttributes, function (name) {\n      var value = image.getAttribute(name);\n      if (value !== null) {\n        newImage.setAttribute(name, value);\n      }\n    });\n    newImage.src = image.src;\n\n    // iOS Safari will convert the image automatically\n    // with its orientation once append it into DOM\n    if (!IS_SAFARI) {\n      newImage.style.cssText = 'left:0;' + 'max-height:none!important;' + 'max-width:none!important;' + 'min-height:0!important;' + 'min-width:0!important;' + 'opacity:0;' + 'position:absolute;' + 'top:0;' + 'z-index:-1;';\n      body.appendChild(newImage);\n    }\n    return newImage;\n  }\n\n  /**\n   * Get the related class name of a responsive type number.\n   * @param {string} type - The responsive type.\n   * @returns {string} The related class name.\n   */\n  function getResponsiveClass(type) {\n    switch (type) {\n      case 2:\n        return CLASS_HIDE_XS_DOWN;\n      case 3:\n        return CLASS_HIDE_SM_DOWN;\n      case 4:\n        return CLASS_HIDE_MD_DOWN;\n      default:\n        return '';\n    }\n  }\n\n  /**\n   * Get the max ratio of a group of pointers.\n   * @param {string} pointers - The target pointers.\n   * @returns {number} The result ratio.\n   */\n  function getMaxZoomRatio(pointers) {\n    var pointers2 = _objectSpread2({}, pointers);\n    var ratios = [];\n    forEach(pointers, function (pointer, pointerId) {\n      delete pointers2[pointerId];\n      forEach(pointers2, function (pointer2) {\n        var x1 = Math.abs(pointer.startX - pointer2.startX);\n        var y1 = Math.abs(pointer.startY - pointer2.startY);\n        var x2 = Math.abs(pointer.endX - pointer2.endX);\n        var y2 = Math.abs(pointer.endY - pointer2.endY);\n        var z1 = Math.sqrt(x1 * x1 + y1 * y1);\n        var z2 = Math.sqrt(x2 * x2 + y2 * y2);\n        var ratio = (z2 - z1) / z1;\n        ratios.push(ratio);\n      });\n    });\n    ratios.sort(function (a, b) {\n      return Math.abs(a) < Math.abs(b);\n    });\n    return ratios[0];\n  }\n\n  /**\n   * Get a pointer from an event object.\n   * @param {Object} event - The target event object.\n   * @param {boolean} endOnly - Indicates if only returns the end point coordinate or not.\n   * @returns {Object} The result pointer contains start and/or end point coordinates.\n   */\n  function getPointer(_ref2, endOnly) {\n    var pageX = _ref2.pageX,\n      pageY = _ref2.pageY;\n    var end = {\n      endX: pageX,\n      endY: pageY\n    };\n    return endOnly ? end : _objectSpread2({\n      timeStamp: Date.now(),\n      startX: pageX,\n      startY: pageY\n    }, end);\n  }\n\n  /**\n   * Get the center point coordinate of a group of pointers.\n   * @param {Object} pointers - The target pointers.\n   * @returns {Object} The center point coordinate.\n   */\n  function getPointersCenter(pointers) {\n    var pageX = 0;\n    var pageY = 0;\n    var count = 0;\n    forEach(pointers, function (_ref3) {\n      var startX = _ref3.startX,\n        startY = _ref3.startY;\n      pageX += startX;\n      pageY += startY;\n      count += 1;\n    });\n    pageX /= count;\n    pageY /= count;\n    return {\n      pageX: pageX,\n      pageY: pageY\n    };\n  }\n\n  var render = {\n    render: function render() {\n      this.initContainer();\n      this.initViewer();\n      this.initList();\n      this.renderViewer();\n    },\n    initBody: function initBody() {\n      var ownerDocument = this.element.ownerDocument;\n      var body = ownerDocument.body || ownerDocument.documentElement;\n      this.body = body;\n      this.scrollbarWidth = window.innerWidth - ownerDocument.documentElement.clientWidth;\n      this.initialBodyPaddingRight = body.style.paddingRight;\n      this.initialBodyComputedPaddingRight = window.getComputedStyle(body).paddingRight;\n    },\n    initContainer: function initContainer() {\n      this.containerData = {\n        width: window.innerWidth,\n        height: window.innerHeight\n      };\n    },\n    initViewer: function initViewer() {\n      var options = this.options,\n        parent = this.parent;\n      var viewerData;\n      if (options.inline) {\n        viewerData = {\n          width: Math.max(parent.offsetWidth, options.minWidth),\n          height: Math.max(parent.offsetHeight, options.minHeight)\n        };\n        this.parentData = viewerData;\n      }\n      if (this.fulled || !viewerData) {\n        viewerData = this.containerData;\n      }\n      this.viewerData = assign({}, viewerData);\n    },\n    renderViewer: function renderViewer() {\n      if (this.options.inline && !this.fulled) {\n        setStyle(this.viewer, this.viewerData);\n      }\n    },\n    initList: function initList() {\n      var _this = this;\n      var element = this.element,\n        options = this.options,\n        list = this.list;\n      var items = [];\n\n      // initList may be called in this.update, so should keep idempotent\n      list.innerHTML = '';\n      forEach(this.images, function (image, index) {\n        var src = image.src;\n        var alt = image.alt || getImageNameFromURL(src);\n        var url = _this.getImageURL(image);\n        if (src || url) {\n          var item = document.createElement('li');\n          var img = document.createElement('img');\n          forEach(options.inheritedAttributes, function (name) {\n            var value = image.getAttribute(name);\n            if (value !== null) {\n              img.setAttribute(name, value);\n            }\n          });\n          if (options.navbar) {\n            img.src = src || url;\n          }\n          img.alt = alt;\n          img.setAttribute('data-original-url', url || src);\n          item.setAttribute('data-index', index);\n          item.setAttribute('data-viewer-action', 'view');\n          item.setAttribute('role', 'button');\n          if (options.keyboard) {\n            item.setAttribute('tabindex', 0);\n          }\n          item.appendChild(img);\n          list.appendChild(item);\n          items.push(item);\n        }\n      });\n      this.items = items;\n      forEach(items, function (item) {\n        var image = item.firstElementChild;\n        var onLoad;\n        var onError;\n        setData(image, 'filled', true);\n        if (options.loading) {\n          addClass(item, CLASS_LOADING);\n        }\n        addListener(image, EVENT_LOAD, onLoad = function onLoad(event) {\n          removeListener(image, EVENT_ERROR, onError);\n          if (options.loading) {\n            removeClass(item, CLASS_LOADING);\n          }\n          _this.loadImage(event);\n        }, {\n          once: true\n        });\n        addListener(image, EVENT_ERROR, onError = function onError() {\n          removeListener(image, EVENT_LOAD, onLoad);\n          if (options.loading) {\n            removeClass(item, CLASS_LOADING);\n          }\n        }, {\n          once: true\n        });\n      });\n      if (options.transition) {\n        addListener(element, EVENT_VIEWED, function () {\n          addClass(list, CLASS_TRANSITION);\n        }, {\n          once: true\n        });\n      }\n    },\n    renderList: function renderList() {\n      var index = this.index;\n      var item = this.items[index];\n      if (!item) {\n        return;\n      }\n      var next = item.nextElementSibling;\n      var gutter = parseInt(window.getComputedStyle(next || item).marginLeft, 10);\n      var offsetWidth = item.offsetWidth;\n      var outerWidth = offsetWidth + gutter;\n\n      // Place the active item in the center of the screen\n      setStyle(this.list, assign({\n        width: outerWidth * this.length - gutter\n      }, getTransforms({\n        translateX: (this.viewerData.width - offsetWidth) / 2 - outerWidth * index\n      })));\n    },\n    resetList: function resetList() {\n      var list = this.list;\n      list.innerHTML = '';\n      removeClass(list, CLASS_TRANSITION);\n      setStyle(list, getTransforms({\n        translateX: 0\n      }));\n    },\n    initImage: function initImage(done) {\n      var _this2 = this;\n      var options = this.options,\n        image = this.image,\n        viewerData = this.viewerData;\n      var footerHeight = this.footer.offsetHeight;\n      var viewerWidth = viewerData.width;\n      var viewerHeight = Math.max(viewerData.height - footerHeight, footerHeight);\n      var oldImageData = this.imageData || {};\n      var sizingImage;\n      this.imageInitializing = {\n        abort: function abort() {\n          sizingImage.onload = null;\n        }\n      };\n      sizingImage = getImageNaturalSizes(image, options, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var initialCoverage = Math.max(0, Math.min(1, options.initialCoverage));\n        var width = viewerWidth;\n        var height = viewerHeight;\n        _this2.imageInitializing = false;\n        if (viewerHeight * aspectRatio > viewerWidth) {\n          height = viewerWidth / aspectRatio;\n        } else {\n          width = viewerHeight * aspectRatio;\n        }\n        initialCoverage = isNumber(initialCoverage) ? initialCoverage : 0.9;\n        width = Math.min(width * initialCoverage, naturalWidth);\n        height = Math.min(height * initialCoverage, naturalHeight);\n        var left = (viewerWidth - width) / 2;\n        var top = (viewerHeight - height) / 2;\n        var imageData = {\n          left: left,\n          top: top,\n          x: left,\n          y: top,\n          width: width,\n          height: height,\n          oldRatio: 1,\n          ratio: width / naturalWidth,\n          aspectRatio: aspectRatio,\n          naturalWidth: naturalWidth,\n          naturalHeight: naturalHeight\n        };\n        var initialImageData = assign({}, imageData);\n        if (options.rotatable) {\n          imageData.rotate = oldImageData.rotate || 0;\n          initialImageData.rotate = 0;\n        }\n        if (options.scalable) {\n          imageData.scaleX = oldImageData.scaleX || 1;\n          imageData.scaleY = oldImageData.scaleY || 1;\n          initialImageData.scaleX = 1;\n          initialImageData.scaleY = 1;\n        }\n        _this2.imageData = imageData;\n        _this2.initialImageData = initialImageData;\n        if (done) {\n          done();\n        }\n      });\n    },\n    renderImage: function renderImage(done) {\n      var _this3 = this;\n      var image = this.image,\n        imageData = this.imageData;\n      setStyle(image, assign({\n        width: imageData.width,\n        height: imageData.height,\n        // XXX: Not to use translateX/Y to avoid image shaking when zooming\n        marginLeft: imageData.x,\n        marginTop: imageData.y\n      }, getTransforms(imageData)));\n      if (done) {\n        if ((this.viewing || this.moving || this.rotating || this.scaling || this.zooming) && this.options.transition && hasClass(image, CLASS_TRANSITION)) {\n          var onTransitionEnd = function onTransitionEnd() {\n            _this3.imageRendering = false;\n            done();\n          };\n          this.imageRendering = {\n            abort: function abort() {\n              removeListener(image, EVENT_TRANSITION_END, onTransitionEnd);\n            }\n          };\n          addListener(image, EVENT_TRANSITION_END, onTransitionEnd, {\n            once: true\n          });\n        } else {\n          done();\n        }\n      }\n    },\n    resetImage: function resetImage() {\n      var image = this.image;\n      if (image) {\n        if (this.viewing) {\n          this.viewing.abort();\n        }\n        image.parentNode.removeChild(image);\n        this.image = null;\n        this.title.innerHTML = '';\n      }\n    }\n  };\n\n  var events = {\n    bind: function bind() {\n      var options = this.options,\n        viewer = this.viewer,\n        canvas = this.canvas;\n      var document = this.element.ownerDocument;\n      addListener(viewer, EVENT_CLICK, this.onClick = this.click.bind(this));\n      addListener(viewer, EVENT_DRAG_START, this.onDragStart = this.dragstart.bind(this));\n      addListener(canvas, EVENT_POINTER_DOWN, this.onPointerDown = this.pointerdown.bind(this));\n      addListener(document, EVENT_POINTER_MOVE, this.onPointerMove = this.pointermove.bind(this));\n      addListener(document, EVENT_POINTER_UP, this.onPointerUp = this.pointerup.bind(this));\n      addListener(document, EVENT_KEY_DOWN, this.onKeyDown = this.keydown.bind(this));\n      addListener(window, EVENT_RESIZE, this.onResize = this.resize.bind(this));\n      if (options.zoomable && options.zoomOnWheel) {\n        addListener(viewer, EVENT_WHEEL, this.onWheel = this.wheel.bind(this), {\n          passive: false,\n          capture: true\n        });\n      }\n      if (options.toggleOnDblclick) {\n        addListener(canvas, EVENT_DBLCLICK, this.onDblclick = this.dblclick.bind(this));\n      }\n    },\n    unbind: function unbind() {\n      var options = this.options,\n        viewer = this.viewer,\n        canvas = this.canvas;\n      var document = this.element.ownerDocument;\n      removeListener(viewer, EVENT_CLICK, this.onClick);\n      removeListener(viewer, EVENT_DRAG_START, this.onDragStart);\n      removeListener(canvas, EVENT_POINTER_DOWN, this.onPointerDown);\n      removeListener(document, EVENT_POINTER_MOVE, this.onPointerMove);\n      removeListener(document, EVENT_POINTER_UP, this.onPointerUp);\n      removeListener(document, EVENT_KEY_DOWN, this.onKeyDown);\n      removeListener(window, EVENT_RESIZE, this.onResize);\n      if (options.zoomable && options.zoomOnWheel) {\n        removeListener(viewer, EVENT_WHEEL, this.onWheel, {\n          passive: false,\n          capture: true\n        });\n      }\n      if (options.toggleOnDblclick) {\n        removeListener(canvas, EVENT_DBLCLICK, this.onDblclick);\n      }\n    }\n  };\n\n  var handlers = {\n    click: function click(event) {\n      var options = this.options,\n        imageData = this.imageData;\n      var target = event.target;\n      var action = getData(target, DATA_ACTION);\n      if (!action && target.localName === 'img' && target.parentElement.localName === 'li') {\n        target = target.parentElement;\n        action = getData(target, DATA_ACTION);\n      }\n\n      // Cancel the emulated click when the native click event was triggered.\n      if (IS_TOUCH_DEVICE && event.isTrusted && target === this.canvas) {\n        clearTimeout(this.clickCanvasTimeout);\n      }\n      switch (action) {\n        case 'mix':\n          if (this.played) {\n            this.stop();\n          } else if (options.inline) {\n            if (this.fulled) {\n              this.exit();\n            } else {\n              this.full();\n            }\n          } else {\n            this.hide();\n          }\n          break;\n        case 'hide':\n          if (!this.pointerMoved) {\n            this.hide();\n          }\n          break;\n        case 'view':\n          this.view(getData(target, 'index'));\n          break;\n        case 'zoom-in':\n          this.zoom(0.1, true);\n          break;\n        case 'zoom-out':\n          this.zoom(-0.1, true);\n          break;\n        case 'one-to-one':\n          this.toggle();\n          break;\n        case 'reset':\n          this.reset();\n          break;\n        case 'prev':\n          this.prev(options.loop);\n          break;\n        case 'play':\n          this.play(options.fullscreen);\n          break;\n        case 'next':\n          this.next(options.loop);\n          break;\n        case 'rotate-left':\n          this.rotate(-90);\n          break;\n        case 'rotate-right':\n          this.rotate(90);\n          break;\n        case 'flip-horizontal':\n          this.scaleX(-imageData.scaleX || -1);\n          break;\n        case 'flip-vertical':\n          this.scaleY(-imageData.scaleY || -1);\n          break;\n        default:\n          if (this.played) {\n            this.stop();\n          }\n      }\n    },\n    dblclick: function dblclick(event) {\n      event.preventDefault();\n      if (this.viewed && event.target === this.image) {\n        // Cancel the emulated double click when the native dblclick event was triggered.\n        if (IS_TOUCH_DEVICE && event.isTrusted) {\n          clearTimeout(this.doubleClickImageTimeout);\n        }\n\n        // XXX: No pageX/Y properties in custom event, fallback to the original event.\n        this.toggle(event.isTrusted ? event : event.detail && event.detail.originalEvent);\n      }\n    },\n    load: function load() {\n      var _this = this;\n      if (this.timeout) {\n        clearTimeout(this.timeout);\n        this.timeout = false;\n      }\n      var element = this.element,\n        options = this.options,\n        image = this.image,\n        index = this.index,\n        viewerData = this.viewerData;\n      removeClass(image, CLASS_INVISIBLE);\n      if (options.loading) {\n        removeClass(this.canvas, CLASS_LOADING);\n      }\n      image.style.cssText = 'height:0;' + \"margin-left:\".concat(viewerData.width / 2, \"px;\") + \"margin-top:\".concat(viewerData.height / 2, \"px;\") + 'max-width:none!important;' + 'position:relative;' + 'width:0;';\n      this.initImage(function () {\n        toggleClass(image, CLASS_MOVE, options.movable);\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n        _this.renderImage(function () {\n          _this.viewed = true;\n          _this.viewing = false;\n          if (isFunction(options.viewed)) {\n            addListener(element, EVENT_VIEWED, options.viewed, {\n              once: true\n            });\n          }\n          dispatchEvent(element, EVENT_VIEWED, {\n            originalImage: _this.images[index],\n            index: index,\n            image: image\n          }, {\n            cancelable: false\n          });\n        });\n      });\n    },\n    loadImage: function loadImage(event) {\n      var image = event.target;\n      var parent = image.parentNode;\n      var parentWidth = parent.offsetWidth || 30;\n      var parentHeight = parent.offsetHeight || 50;\n      var filled = !!getData(image, 'filled');\n      getImageNaturalSizes(image, this.options, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var width = parentWidth;\n        var height = parentHeight;\n        if (parentHeight * aspectRatio > parentWidth) {\n          if (filled) {\n            width = parentHeight * aspectRatio;\n          } else {\n            height = parentWidth / aspectRatio;\n          }\n        } else if (filled) {\n          height = parentWidth / aspectRatio;\n        } else {\n          width = parentHeight * aspectRatio;\n        }\n        setStyle(image, assign({\n          width: width,\n          height: height\n        }, getTransforms({\n          translateX: (parentWidth - width) / 2,\n          translateY: (parentHeight - height) / 2\n        })));\n      });\n    },\n    keydown: function keydown(event) {\n      var options = this.options;\n      if (!options.keyboard) {\n        return;\n      }\n      var keyCode = event.keyCode || event.which || event.charCode;\n      switch (keyCode) {\n        // Enter\n        case 13:\n          if (this.viewer.contains(event.target)) {\n            this.click(event);\n          }\n          break;\n      }\n      if (!this.fulled) {\n        return;\n      }\n      switch (keyCode) {\n        // Escape\n        case 27:\n          if (this.played) {\n            this.stop();\n          } else if (options.inline) {\n            if (this.fulled) {\n              this.exit();\n            }\n          } else {\n            this.hide();\n          }\n          break;\n\n        // Space\n        case 32:\n          if (this.played) {\n            this.stop();\n          }\n          break;\n\n        // ArrowLeft\n        case 37:\n          if (this.played && this.playing) {\n            this.playing.prev();\n          } else {\n            this.prev(options.loop);\n          }\n          break;\n\n        // ArrowUp\n        case 38:\n          // Prevent scroll on Firefox\n          event.preventDefault();\n\n          // Zoom in\n          this.zoom(options.zoomRatio, true);\n          break;\n\n        // ArrowRight\n        case 39:\n          if (this.played && this.playing) {\n            this.playing.next();\n          } else {\n            this.next(options.loop);\n          }\n          break;\n\n        // ArrowDown\n        case 40:\n          // Prevent scroll on Firefox\n          event.preventDefault();\n\n          // Zoom out\n          this.zoom(-options.zoomRatio, true);\n          break;\n\n        // Ctrl + 0\n        case 48:\n        // Fall through\n\n        // Ctrl + 1\n        // eslint-disable-next-line no-fallthrough\n        case 49:\n          if (event.ctrlKey) {\n            event.preventDefault();\n            this.toggle();\n          }\n          break;\n      }\n    },\n    dragstart: function dragstart(event) {\n      if (event.target.localName === 'img') {\n        event.preventDefault();\n      }\n    },\n    pointerdown: function pointerdown(event) {\n      var options = this.options,\n        pointers = this.pointers;\n      var buttons = event.buttons,\n        button = event.button;\n      this.pointerMoved = false;\n      if (!this.viewed || this.showing || this.viewing || this.hiding\n\n      // Handle mouse event and pointer event and ignore touch event\n      || (event.type === 'mousedown' || event.type === 'pointerdown' && event.pointerType === 'mouse') && (\n      // No primary button (Usually the left button)\n      isNumber(buttons) && buttons !== 1 || isNumber(button) && button !== 0\n\n      // Open context menu\n      || event.ctrlKey)) {\n        return;\n      }\n\n      // Prevent default behaviours as page zooming in touch devices.\n      event.preventDefault();\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          pointers[touch.identifier] = getPointer(touch);\n        });\n      } else {\n        pointers[event.pointerId || 0] = getPointer(event);\n      }\n      var action = options.movable ? ACTION_MOVE : false;\n      if (options.zoomOnTouch && options.zoomable && Object.keys(pointers).length > 1) {\n        action = ACTION_ZOOM;\n      } else if (options.slideOnTouch && (event.pointerType === 'touch' || event.type === 'touchstart') && this.isSwitchable()) {\n        action = ACTION_SWITCH;\n      }\n      if (options.transition && (action === ACTION_MOVE || action === ACTION_ZOOM)) {\n        removeClass(this.image, CLASS_TRANSITION);\n      }\n      this.action = action;\n    },\n    pointermove: function pointermove(event) {\n      var pointers = this.pointers,\n        action = this.action;\n      if (!this.viewed || !action) {\n        return;\n      }\n      event.preventDefault();\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          assign(pointers[touch.identifier] || {}, getPointer(touch, true));\n        });\n      } else {\n        assign(pointers[event.pointerId || 0] || {}, getPointer(event, true));\n      }\n      this.change(event);\n    },\n    pointerup: function pointerup(event) {\n      var _this2 = this;\n      var options = this.options,\n        action = this.action,\n        pointers = this.pointers;\n      var pointer;\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          pointer = pointers[touch.identifier];\n          delete pointers[touch.identifier];\n        });\n      } else {\n        pointer = pointers[event.pointerId || 0];\n        delete pointers[event.pointerId || 0];\n      }\n      if (!action) {\n        return;\n      }\n      event.preventDefault();\n      if (options.transition && (action === ACTION_MOVE || action === ACTION_ZOOM)) {\n        addClass(this.image, CLASS_TRANSITION);\n      }\n      this.action = false;\n\n      // Emulate click and double click in touch devices to support backdrop and image zooming (#210).\n      if (IS_TOUCH_DEVICE && action !== ACTION_ZOOM && pointer && Date.now() - pointer.timeStamp < 500) {\n        clearTimeout(this.clickCanvasTimeout);\n        clearTimeout(this.doubleClickImageTimeout);\n        if (options.toggleOnDblclick && this.viewed && event.target === this.image) {\n          if (this.imageClicked) {\n            this.imageClicked = false;\n\n            // This timeout will be cleared later when a native dblclick event is triggering\n            this.doubleClickImageTimeout = setTimeout(function () {\n              dispatchEvent(_this2.image, EVENT_DBLCLICK, {\n                originalEvent: event\n              });\n            }, 50);\n          } else {\n            this.imageClicked = true;\n\n            // The default timing of a double click in Windows is 500 ms\n            this.doubleClickImageTimeout = setTimeout(function () {\n              _this2.imageClicked = false;\n            }, 500);\n          }\n        } else {\n          this.imageClicked = false;\n          if (options.backdrop && options.backdrop !== 'static' && event.target === this.canvas) {\n            // This timeout will be cleared later when a native click event is triggering\n            this.clickCanvasTimeout = setTimeout(function () {\n              dispatchEvent(_this2.canvas, EVENT_CLICK, {\n                originalEvent: event\n              });\n            }, 50);\n          }\n        }\n      }\n    },\n    resize: function resize() {\n      var _this3 = this;\n      if (!this.isShown || this.hiding) {\n        return;\n      }\n      if (this.fulled) {\n        this.close();\n        this.initBody();\n        this.open();\n      }\n      this.initContainer();\n      this.initViewer();\n      this.renderViewer();\n      this.renderList();\n      if (this.viewed) {\n        this.initImage(function () {\n          _this3.renderImage();\n        });\n      }\n      if (this.played) {\n        if (this.options.fullscreen && this.fulled && !(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n          this.stop();\n          return;\n        }\n        forEach(this.player.getElementsByTagName('img'), function (image) {\n          addListener(image, EVENT_LOAD, _this3.loadImage.bind(_this3), {\n            once: true\n          });\n          dispatchEvent(image, EVENT_LOAD);\n        });\n      }\n    },\n    wheel: function wheel(event) {\n      var _this4 = this;\n      if (!this.viewed) {\n        return;\n      }\n      event.preventDefault();\n\n      // Limit wheel speed to prevent zoom too fast\n      if (this.wheeling) {\n        return;\n      }\n      this.wheeling = true;\n      setTimeout(function () {\n        _this4.wheeling = false;\n      }, 50);\n      var ratio = Number(this.options.zoomRatio) || 0.1;\n      var delta = 1;\n      if (event.deltaY) {\n        delta = event.deltaY > 0 ? 1 : -1;\n      } else if (event.wheelDelta) {\n        delta = -event.wheelDelta / 120;\n      } else if (event.detail) {\n        delta = event.detail > 0 ? 1 : -1;\n      }\n      this.zoom(-delta * ratio, true, null, event);\n    }\n  };\n\n  var methods = {\n    /** Show the viewer (only available in modal mode)\n     * @param {boolean} [immediate=false] - Indicates if show the viewer immediately or not.\n     * @returns {Viewer} this\n     */\n    show: function show() {\n      var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var element = this.element,\n        options = this.options;\n      if (options.inline || this.showing || this.isShown || this.showing) {\n        return this;\n      }\n      if (!this.ready) {\n        this.build();\n        if (this.ready) {\n          this.show(immediate);\n        }\n        return this;\n      }\n      if (isFunction(options.show)) {\n        addListener(element, EVENT_SHOW, options.show, {\n          once: true\n        });\n      }\n      if (dispatchEvent(element, EVENT_SHOW) === false || !this.ready) {\n        return this;\n      }\n      if (this.hiding) {\n        this.transitioning.abort();\n      }\n      this.showing = true;\n      this.open();\n      var viewer = this.viewer;\n      removeClass(viewer, CLASS_HIDE);\n      viewer.setAttribute('role', 'dialog');\n      viewer.setAttribute('aria-labelledby', this.title.id);\n      viewer.setAttribute('aria-modal', true);\n      viewer.removeAttribute('aria-hidden');\n      if (options.transition && !immediate) {\n        var shown = this.shown.bind(this);\n        this.transitioning = {\n          abort: function abort() {\n            removeListener(viewer, EVENT_TRANSITION_END, shown);\n            removeClass(viewer, CLASS_IN);\n          }\n        };\n        addClass(viewer, CLASS_TRANSITION);\n\n        // Force reflow to enable CSS3 transition\n        viewer.initialOffsetWidth = viewer.offsetWidth;\n        addListener(viewer, EVENT_TRANSITION_END, shown, {\n          once: true\n        });\n        addClass(viewer, CLASS_IN);\n      } else {\n        addClass(viewer, CLASS_IN);\n        this.shown();\n      }\n      return this;\n    },\n    /**\n     * Hide the viewer (only available in modal mode)\n     * @param {boolean} [immediate=false] - Indicates if hide the viewer immediately or not.\n     * @returns {Viewer} this\n     */\n    hide: function hide() {\n      var _this = this;\n      var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var element = this.element,\n        options = this.options;\n      if (options.inline || this.hiding || !(this.isShown || this.showing)) {\n        return this;\n      }\n      if (isFunction(options.hide)) {\n        addListener(element, EVENT_HIDE, options.hide, {\n          once: true\n        });\n      }\n      if (dispatchEvent(element, EVENT_HIDE) === false) {\n        return this;\n      }\n      if (this.showing) {\n        this.transitioning.abort();\n      }\n      this.hiding = true;\n      if (this.played) {\n        this.stop();\n      } else if (this.viewing) {\n        this.viewing.abort();\n      }\n      var viewer = this.viewer,\n        image = this.image;\n      var hideImmediately = function hideImmediately() {\n        removeClass(viewer, CLASS_IN);\n        _this.hidden();\n      };\n      if (options.transition && !immediate) {\n        var onViewerTransitionEnd = function onViewerTransitionEnd(event) {\n          // Ignore all propagating `transitionend` events (#275).\n          if (event && event.target === viewer) {\n            removeListener(viewer, EVENT_TRANSITION_END, onViewerTransitionEnd);\n            _this.hidden();\n          }\n        };\n        var onImageTransitionEnd = function onImageTransitionEnd() {\n          // In case of show the viewer by `viewer.show(true)` previously (#407).\n          if (hasClass(viewer, CLASS_TRANSITION)) {\n            addListener(viewer, EVENT_TRANSITION_END, onViewerTransitionEnd);\n            removeClass(viewer, CLASS_IN);\n          } else {\n            hideImmediately();\n          }\n        };\n        this.transitioning = {\n          abort: function abort() {\n            if (_this.viewed && hasClass(image, CLASS_TRANSITION)) {\n              removeListener(image, EVENT_TRANSITION_END, onImageTransitionEnd);\n            } else if (hasClass(viewer, CLASS_TRANSITION)) {\n              removeListener(viewer, EVENT_TRANSITION_END, onViewerTransitionEnd);\n            }\n          }\n        };\n\n        // In case of hiding the viewer when holding on the image (#255),\n        // note that the `CLASS_TRANSITION` class will be removed on pointer down.\n        if (this.viewed && hasClass(image, CLASS_TRANSITION)) {\n          addListener(image, EVENT_TRANSITION_END, onImageTransitionEnd, {\n            once: true\n          });\n          this.zoomTo(0, false, null, null, true);\n        } else {\n          onImageTransitionEnd();\n        }\n      } else {\n        hideImmediately();\n      }\n      return this;\n    },\n    /**\n     * View one of the images with image's index\n     * @param {number} index - The index of the image to view.\n     * @returns {Viewer} this\n     */\n    view: function view() {\n      var _this2 = this;\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.options.initialViewIndex;\n      index = Number(index) || 0;\n      if (this.hiding || this.played || index < 0 || index >= this.length || this.viewed && index === this.index) {\n        return this;\n      }\n      if (!this.isShown) {\n        this.index = index;\n        return this.show();\n      }\n      if (this.viewing) {\n        this.viewing.abort();\n      }\n      var element = this.element,\n        options = this.options,\n        title = this.title,\n        canvas = this.canvas;\n      var item = this.items[index];\n      var img = item.querySelector('img');\n      var url = getData(img, 'originalUrl');\n      var alt = img.getAttribute('alt');\n      var image = document.createElement('img');\n      forEach(options.inheritedAttributes, function (name) {\n        var value = img.getAttribute(name);\n        if (value !== null) {\n          image.setAttribute(name, value);\n        }\n      });\n      image.src = url;\n      image.alt = alt;\n      if (isFunction(options.view)) {\n        addListener(element, EVENT_VIEW, options.view, {\n          once: true\n        });\n      }\n      if (dispatchEvent(element, EVENT_VIEW, {\n        originalImage: this.images[index],\n        index: index,\n        image: image\n      }) === false || !this.isShown || this.hiding || this.played) {\n        return this;\n      }\n      var activeItem = this.items[this.index];\n      if (activeItem) {\n        removeClass(activeItem, CLASS_ACTIVE);\n        activeItem.removeAttribute('aria-selected');\n      }\n      addClass(item, CLASS_ACTIVE);\n      item.setAttribute('aria-selected', true);\n      if (options.focus) {\n        item.focus();\n      }\n      this.image = image;\n      this.viewed = false;\n      this.index = index;\n      this.imageData = {};\n      addClass(image, CLASS_INVISIBLE);\n      if (options.loading) {\n        addClass(canvas, CLASS_LOADING);\n      }\n      canvas.innerHTML = '';\n      canvas.appendChild(image);\n\n      // Center current item\n      this.renderList();\n\n      // Clear title\n      title.innerHTML = '';\n\n      // Generate title after viewed\n      var onViewed = function onViewed() {\n        var imageData = _this2.imageData;\n        var render = Array.isArray(options.title) ? options.title[1] : options.title;\n        title.innerHTML = escapeHTMLEntities(isFunction(render) ? render.call(_this2, image, imageData) : \"\".concat(alt, \" (\").concat(imageData.naturalWidth, \" \\xD7 \").concat(imageData.naturalHeight, \")\"));\n      };\n      var onLoad;\n      var onError;\n      addListener(element, EVENT_VIEWED, onViewed, {\n        once: true\n      });\n      this.viewing = {\n        abort: function abort() {\n          removeListener(element, EVENT_VIEWED, onViewed);\n          if (image.complete) {\n            if (_this2.imageRendering) {\n              _this2.imageRendering.abort();\n            } else if (_this2.imageInitializing) {\n              _this2.imageInitializing.abort();\n            }\n          } else {\n            // Cancel download to save bandwidth.\n            image.src = '';\n            removeListener(image, EVENT_LOAD, onLoad);\n            if (_this2.timeout) {\n              clearTimeout(_this2.timeout);\n            }\n          }\n        }\n      };\n      if (image.complete) {\n        this.load();\n      } else {\n        addListener(image, EVENT_LOAD, onLoad = function onLoad() {\n          removeListener(image, EVENT_ERROR, onError);\n          _this2.load();\n        }, {\n          once: true\n        });\n        addListener(image, EVENT_ERROR, onError = function onError() {\n          removeListener(image, EVENT_LOAD, onLoad);\n          if (_this2.timeout) {\n            clearTimeout(_this2.timeout);\n            _this2.timeout = false;\n          }\n          removeClass(image, CLASS_INVISIBLE);\n          if (options.loading) {\n            removeClass(_this2.canvas, CLASS_LOADING);\n          }\n        }, {\n          once: true\n        });\n        if (this.timeout) {\n          clearTimeout(this.timeout);\n        }\n\n        // Make the image visible if it fails to load within 1s\n        this.timeout = setTimeout(function () {\n          removeClass(image, CLASS_INVISIBLE);\n          _this2.timeout = false;\n        }, 1000);\n      }\n      return this;\n    },\n    /**\n     * View the previous image\n     * @param {boolean} [loop=false] - Indicate if view the last one\n     * when it is the first one at present.\n     * @returns {Viewer} this\n     */\n    prev: function prev() {\n      var loop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var index = this.index - 1;\n      if (index < 0) {\n        index = loop ? this.length - 1 : 0;\n      }\n      this.view(index);\n      return this;\n    },\n    /**\n     * View the next image\n     * @param {boolean} [loop=false] - Indicate if view the first one\n     * when it is the last one at present.\n     * @returns {Viewer} this\n     */\n    next: function next() {\n      var loop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var maxIndex = this.length - 1;\n      var index = this.index + 1;\n      if (index > maxIndex) {\n        index = loop ? 0 : maxIndex;\n      }\n      this.view(index);\n      return this;\n    },\n    /**\n     * Move the image with relative offsets.\n     * @param {number} x - The moving distance in the horizontal direction.\n     * @param {number} [y=x] The moving distance in the vertical direction.\n     * @returns {Viewer} this\n     */\n    move: function move(x) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : x;\n      var imageData = this.imageData;\n      this.moveTo(isUndefined(x) ? x : imageData.x + Number(x), isUndefined(y) ? y : imageData.y + Number(y));\n      return this;\n    },\n    /**\n     * Move the image to an absolute point.\n     * @param {number} x - The new position in the horizontal direction.\n     * @param {number} [y=x] - The new position in the vertical direction.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @returns {Viewer} this\n     */\n    moveTo: function moveTo(x) {\n      var _this3 = this;\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : x;\n      var _originalEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      var element = this.element,\n        options = this.options,\n        imageData = this.imageData;\n      x = Number(x);\n      y = Number(y);\n      if (this.viewed && !this.played && options.movable) {\n        var oldX = imageData.x;\n        var oldY = imageData.y;\n        var changed = false;\n        if (isNumber(x)) {\n          changed = true;\n        } else {\n          x = oldX;\n        }\n        if (isNumber(y)) {\n          changed = true;\n        } else {\n          y = oldY;\n        }\n        if (changed) {\n          if (isFunction(options.move)) {\n            addListener(element, EVENT_MOVE, options.move, {\n              once: true\n            });\n          }\n          if (dispatchEvent(element, EVENT_MOVE, {\n            x: x,\n            y: y,\n            oldX: oldX,\n            oldY: oldY,\n            originalEvent: _originalEvent\n          }) === false) {\n            return this;\n          }\n          imageData.x = x;\n          imageData.y = y;\n          imageData.left = x;\n          imageData.top = y;\n          this.moving = true;\n          this.renderImage(function () {\n            _this3.moving = false;\n            if (isFunction(options.moved)) {\n              addListener(element, EVENT_MOVED, options.moved, {\n                once: true\n              });\n            }\n            dispatchEvent(element, EVENT_MOVED, {\n              x: x,\n              y: y,\n              oldX: oldX,\n              oldY: oldY,\n              originalEvent: _originalEvent\n            }, {\n              cancelable: false\n            });\n          });\n        }\n      }\n      return this;\n    },\n    /**\n     * Rotate the image with a relative degree.\n     * @param {number} degree - The rotate degree.\n     * @returns {Viewer} this\n     */\n    rotate: function rotate(degree) {\n      this.rotateTo((this.imageData.rotate || 0) + Number(degree));\n      return this;\n    },\n    /**\n     * Rotate the image to an absolute degree.\n     * @param {number} degree - The rotate degree.\n     * @returns {Viewer} this\n     */\n    rotateTo: function rotateTo(degree) {\n      var _this4 = this;\n      var element = this.element,\n        options = this.options,\n        imageData = this.imageData;\n      degree = Number(degree);\n      if (isNumber(degree) && this.viewed && !this.played && options.rotatable) {\n        var oldDegree = imageData.rotate;\n        if (isFunction(options.rotate)) {\n          addListener(element, EVENT_ROTATE, options.rotate, {\n            once: true\n          });\n        }\n        if (dispatchEvent(element, EVENT_ROTATE, {\n          degree: degree,\n          oldDegree: oldDegree\n        }) === false) {\n          return this;\n        }\n        imageData.rotate = degree;\n        this.rotating = true;\n        this.renderImage(function () {\n          _this4.rotating = false;\n          if (isFunction(options.rotated)) {\n            addListener(element, EVENT_ROTATED, options.rotated, {\n              once: true\n            });\n          }\n          dispatchEvent(element, EVENT_ROTATED, {\n            degree: degree,\n            oldDegree: oldDegree\n          }, {\n            cancelable: false\n          });\n        });\n      }\n      return this;\n    },\n    /**\n     * Scale the image on the x-axis.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @returns {Viewer} this\n     */\n    scaleX: function scaleX(_scaleX) {\n      this.scale(_scaleX, this.imageData.scaleY);\n      return this;\n    },\n    /**\n     * Scale the image on the y-axis.\n     * @param {number} scaleY - The scale ratio on the y-axis.\n     * @returns {Viewer} this\n     */\n    scaleY: function scaleY(_scaleY) {\n      this.scale(this.imageData.scaleX, _scaleY);\n      return this;\n    },\n    /**\n     * Scale the image.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @param {number} [scaleY=scaleX] - The scale ratio on the y-axis.\n     * @returns {Viewer} this\n     */\n    scale: function scale(scaleX) {\n      var _this5 = this;\n      var scaleY = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : scaleX;\n      var element = this.element,\n        options = this.options,\n        imageData = this.imageData;\n      scaleX = Number(scaleX);\n      scaleY = Number(scaleY);\n      if (this.viewed && !this.played && options.scalable) {\n        var oldScaleX = imageData.scaleX;\n        var oldScaleY = imageData.scaleY;\n        var changed = false;\n        if (isNumber(scaleX)) {\n          changed = true;\n        } else {\n          scaleX = oldScaleX;\n        }\n        if (isNumber(scaleY)) {\n          changed = true;\n        } else {\n          scaleY = oldScaleY;\n        }\n        if (changed) {\n          if (isFunction(options.scale)) {\n            addListener(element, EVENT_SCALE, options.scale, {\n              once: true\n            });\n          }\n          if (dispatchEvent(element, EVENT_SCALE, {\n            scaleX: scaleX,\n            scaleY: scaleY,\n            oldScaleX: oldScaleX,\n            oldScaleY: oldScaleY\n          }) === false) {\n            return this;\n          }\n          imageData.scaleX = scaleX;\n          imageData.scaleY = scaleY;\n          this.scaling = true;\n          this.renderImage(function () {\n            _this5.scaling = false;\n            if (isFunction(options.scaled)) {\n              addListener(element, EVENT_SCALED, options.scaled, {\n                once: true\n              });\n            }\n            dispatchEvent(element, EVENT_SCALED, {\n              scaleX: scaleX,\n              scaleY: scaleY,\n              oldScaleX: oldScaleX,\n              oldScaleY: oldScaleY\n            }, {\n              cancelable: false\n            });\n          });\n        }\n      }\n      return this;\n    },\n    /**\n     * Zoom the image with a relative ratio.\n     * @param {number} ratio - The target ratio.\n     * @param {boolean} [showTooltip=false] - Indicates whether to show the tooltip.\n     * @param {Object} [pivot] - The pivot point coordinate for zooming.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @returns {Viewer} this\n     */\n    zoom: function zoom(ratio) {\n      var showTooltip = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var pivot = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      var _originalEvent = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n      var imageData = this.imageData;\n      ratio = Number(ratio);\n      if (ratio < 0) {\n        ratio = 1 / (1 - ratio);\n      } else {\n        ratio = 1 + ratio;\n      }\n      this.zoomTo(imageData.width * ratio / imageData.naturalWidth, showTooltip, pivot, _originalEvent);\n      return this;\n    },\n    /**\n     * Zoom the image to an absolute ratio.\n     * @param {number} ratio - The target ratio.\n     * @param {boolean} [showTooltip] - Indicates whether to show the tooltip.\n     * @param {Object} [pivot] - The pivot point coordinate for zooming.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @param {Event} [_zoomable=false] - Indicates if the current zoom is available or not.\n     * @returns {Viewer} this\n     */\n    zoomTo: function zoomTo(ratio) {\n      var _this6 = this;\n      var showTooltip = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var pivot = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      var _originalEvent = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n      var _zoomable = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n      var element = this.element,\n        options = this.options,\n        pointers = this.pointers,\n        imageData = this.imageData;\n      var x = imageData.x,\n        y = imageData.y,\n        width = imageData.width,\n        height = imageData.height,\n        naturalWidth = imageData.naturalWidth,\n        naturalHeight = imageData.naturalHeight;\n      ratio = Math.max(0, ratio);\n      if (isNumber(ratio) && this.viewed && !this.played && (_zoomable || options.zoomable)) {\n        if (!_zoomable) {\n          var minZoomRatio = Math.max(0.01, options.minZoomRatio);\n          var maxZoomRatio = Math.min(100, options.maxZoomRatio);\n          ratio = Math.min(Math.max(ratio, minZoomRatio), maxZoomRatio);\n        }\n        if (_originalEvent) {\n          switch (_originalEvent.type) {\n            case 'wheel':\n              if (options.zoomRatio >= 0.055 && ratio > 0.95 && ratio < 1.05) {\n                ratio = 1;\n              }\n              break;\n            case 'pointermove':\n            case 'touchmove':\n            case 'mousemove':\n              if (ratio > 0.99 && ratio < 1.01) {\n                ratio = 1;\n              }\n              break;\n          }\n        }\n        var newWidth = naturalWidth * ratio;\n        var newHeight = naturalHeight * ratio;\n        var offsetWidth = newWidth - width;\n        var offsetHeight = newHeight - height;\n        var oldRatio = imageData.ratio;\n        if (isFunction(options.zoom)) {\n          addListener(element, EVENT_ZOOM, options.zoom, {\n            once: true\n          });\n        }\n        if (dispatchEvent(element, EVENT_ZOOM, {\n          ratio: ratio,\n          oldRatio: oldRatio,\n          originalEvent: _originalEvent\n        }) === false) {\n          return this;\n        }\n        this.zooming = true;\n        if (_originalEvent) {\n          var offset = getOffset(this.viewer);\n          var center = pointers && Object.keys(pointers).length > 0 ? getPointersCenter(pointers) : {\n            pageX: _originalEvent.pageX,\n            pageY: _originalEvent.pageY\n          };\n\n          // Zoom from the triggering point of the event\n          imageData.x -= offsetWidth * ((center.pageX - offset.left - x) / width);\n          imageData.y -= offsetHeight * ((center.pageY - offset.top - y) / height);\n        } else if (isPlainObject(pivot) && isNumber(pivot.x) && isNumber(pivot.y)) {\n          imageData.x -= offsetWidth * ((pivot.x - x) / width);\n          imageData.y -= offsetHeight * ((pivot.y - y) / height);\n        } else {\n          // Zoom from the center of the image\n          imageData.x -= offsetWidth / 2;\n          imageData.y -= offsetHeight / 2;\n        }\n        imageData.left = imageData.x;\n        imageData.top = imageData.y;\n        imageData.width = newWidth;\n        imageData.height = newHeight;\n        imageData.oldRatio = oldRatio;\n        imageData.ratio = ratio;\n        this.renderImage(function () {\n          _this6.zooming = false;\n          if (isFunction(options.zoomed)) {\n            addListener(element, EVENT_ZOOMED, options.zoomed, {\n              once: true\n            });\n          }\n          dispatchEvent(element, EVENT_ZOOMED, {\n            ratio: ratio,\n            oldRatio: oldRatio,\n            originalEvent: _originalEvent\n          }, {\n            cancelable: false\n          });\n        });\n        if (showTooltip) {\n          this.tooltip();\n        }\n      }\n      return this;\n    },\n    /**\n     * Play the images\n     * @param {boolean|FullscreenOptions} [fullscreen=false] - Indicate if request fullscreen or not.\n     * @returns {Viewer} this\n     */\n    play: function play() {\n      var _this7 = this;\n      var fullscreen = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      if (!this.isShown || this.played) {\n        return this;\n      }\n      var element = this.element,\n        options = this.options;\n      if (isFunction(options.play)) {\n        addListener(element, EVENT_PLAY, options.play, {\n          once: true\n        });\n      }\n      if (dispatchEvent(element, EVENT_PLAY) === false) {\n        return this;\n      }\n      var player = this.player;\n      var onLoad = this.loadImage.bind(this);\n      var list = [];\n      var total = 0;\n      var index = 0;\n      this.played = true;\n      this.onLoadWhenPlay = onLoad;\n      if (fullscreen) {\n        this.requestFullscreen(fullscreen);\n      }\n      addClass(player, CLASS_SHOW);\n      forEach(this.items, function (item, i) {\n        var img = item.querySelector('img');\n        var image = document.createElement('img');\n        image.src = getData(img, 'originalUrl');\n        image.alt = img.getAttribute('alt');\n        image.referrerPolicy = img.referrerPolicy;\n        total += 1;\n        addClass(image, CLASS_FADE);\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n        if (hasClass(item, CLASS_ACTIVE)) {\n          addClass(image, CLASS_IN);\n          index = i;\n        }\n        list.push(image);\n        addListener(image, EVENT_LOAD, onLoad, {\n          once: true\n        });\n        player.appendChild(image);\n      });\n      if (isNumber(options.interval) && options.interval > 0) {\n        var prev = function prev() {\n          clearTimeout(_this7.playing.timeout);\n          removeClass(list[index], CLASS_IN);\n          index -= 1;\n          index = index >= 0 ? index : total - 1;\n          addClass(list[index], CLASS_IN);\n          _this7.playing.timeout = setTimeout(prev, options.interval);\n        };\n        var next = function next() {\n          clearTimeout(_this7.playing.timeout);\n          removeClass(list[index], CLASS_IN);\n          index += 1;\n          index = index < total ? index : 0;\n          addClass(list[index], CLASS_IN);\n          _this7.playing.timeout = setTimeout(next, options.interval);\n        };\n        if (total > 1) {\n          this.playing = {\n            prev: prev,\n            next: next,\n            timeout: setTimeout(next, options.interval)\n          };\n        }\n      }\n      return this;\n    },\n    // Stop play\n    stop: function stop() {\n      var _this8 = this;\n      if (!this.played) {\n        return this;\n      }\n      var element = this.element,\n        options = this.options;\n      if (isFunction(options.stop)) {\n        addListener(element, EVENT_STOP, options.stop, {\n          once: true\n        });\n      }\n      if (dispatchEvent(element, EVENT_STOP) === false) {\n        return this;\n      }\n      var player = this.player;\n      clearTimeout(this.playing.timeout);\n      this.playing = false;\n      this.played = false;\n      forEach(player.getElementsByTagName('img'), function (image) {\n        removeListener(image, EVENT_LOAD, _this8.onLoadWhenPlay);\n      });\n      removeClass(player, CLASS_SHOW);\n      player.innerHTML = '';\n      this.exitFullscreen();\n      return this;\n    },\n    // Enter modal mode (only available in inline mode)\n    full: function full() {\n      var _this9 = this;\n      var options = this.options,\n        viewer = this.viewer,\n        image = this.image,\n        list = this.list;\n      if (!this.isShown || this.played || this.fulled || !options.inline) {\n        return this;\n      }\n      this.fulled = true;\n      this.open();\n      addClass(this.button, CLASS_FULLSCREEN_EXIT);\n      if (options.transition) {\n        removeClass(list, CLASS_TRANSITION);\n        if (this.viewed) {\n          removeClass(image, CLASS_TRANSITION);\n        }\n      }\n      addClass(viewer, CLASS_FIXED);\n      viewer.setAttribute('role', 'dialog');\n      viewer.setAttribute('aria-labelledby', this.title.id);\n      viewer.setAttribute('aria-modal', true);\n      viewer.removeAttribute('style');\n      setStyle(viewer, {\n        zIndex: options.zIndex\n      });\n      if (options.focus) {\n        this.enforceFocus();\n      }\n      this.initContainer();\n      this.viewerData = assign({}, this.containerData);\n      this.renderList();\n      if (this.viewed) {\n        this.initImage(function () {\n          _this9.renderImage(function () {\n            if (options.transition) {\n              setTimeout(function () {\n                addClass(image, CLASS_TRANSITION);\n                addClass(list, CLASS_TRANSITION);\n              }, 0);\n            }\n          });\n        });\n      }\n      return this;\n    },\n    // Exit modal mode (only available in inline mode)\n    exit: function exit() {\n      var _this10 = this;\n      var options = this.options,\n        viewer = this.viewer,\n        image = this.image,\n        list = this.list;\n      if (!this.isShown || this.played || !this.fulled || !options.inline) {\n        return this;\n      }\n      this.fulled = false;\n      this.close();\n      removeClass(this.button, CLASS_FULLSCREEN_EXIT);\n      if (options.transition) {\n        removeClass(list, CLASS_TRANSITION);\n        if (this.viewed) {\n          removeClass(image, CLASS_TRANSITION);\n        }\n      }\n      if (options.focus) {\n        this.clearEnforceFocus();\n      }\n      viewer.removeAttribute('role');\n      viewer.removeAttribute('aria-labelledby');\n      viewer.removeAttribute('aria-modal');\n      removeClass(viewer, CLASS_FIXED);\n      setStyle(viewer, {\n        zIndex: options.zIndexInline\n      });\n      this.viewerData = assign({}, this.parentData);\n      this.renderViewer();\n      this.renderList();\n      if (this.viewed) {\n        this.initImage(function () {\n          _this10.renderImage(function () {\n            if (options.transition) {\n              setTimeout(function () {\n                addClass(image, CLASS_TRANSITION);\n                addClass(list, CLASS_TRANSITION);\n              }, 0);\n            }\n          });\n        });\n      }\n      return this;\n    },\n    // Show the current ratio of the image with percentage\n    tooltip: function tooltip() {\n      var _this11 = this;\n      var options = this.options,\n        tooltipBox = this.tooltipBox,\n        imageData = this.imageData;\n      if (!this.viewed || this.played || !options.tooltip) {\n        return this;\n      }\n      tooltipBox.textContent = \"\".concat(Math.round(imageData.ratio * 100), \"%\");\n      if (!this.tooltipping) {\n        if (options.transition) {\n          if (this.fading) {\n            dispatchEvent(tooltipBox, EVENT_TRANSITION_END);\n          }\n          addClass(tooltipBox, CLASS_SHOW);\n          addClass(tooltipBox, CLASS_FADE);\n          addClass(tooltipBox, CLASS_TRANSITION);\n          tooltipBox.removeAttribute('aria-hidden');\n\n          // Force reflow to enable CSS3 transition\n          tooltipBox.initialOffsetWidth = tooltipBox.offsetWidth;\n          addClass(tooltipBox, CLASS_IN);\n        } else {\n          addClass(tooltipBox, CLASS_SHOW);\n          tooltipBox.removeAttribute('aria-hidden');\n        }\n      } else {\n        clearTimeout(this.tooltipping);\n      }\n      this.tooltipping = setTimeout(function () {\n        if (options.transition) {\n          addListener(tooltipBox, EVENT_TRANSITION_END, function () {\n            removeClass(tooltipBox, CLASS_SHOW);\n            removeClass(tooltipBox, CLASS_FADE);\n            removeClass(tooltipBox, CLASS_TRANSITION);\n            tooltipBox.setAttribute('aria-hidden', true);\n            _this11.fading = false;\n          }, {\n            once: true\n          });\n          removeClass(tooltipBox, CLASS_IN);\n          _this11.fading = true;\n        } else {\n          removeClass(tooltipBox, CLASS_SHOW);\n          tooltipBox.setAttribute('aria-hidden', true);\n        }\n        _this11.tooltipping = false;\n      }, 1000);\n      return this;\n    },\n    /**\n     * Toggle the image size between its current size and natural size\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @returns {Viewer} this\n     */\n    toggle: function toggle() {\n      var _originalEvent = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      if (this.imageData.ratio === 1) {\n        this.zoomTo(this.imageData.oldRatio, true, null, _originalEvent);\n      } else {\n        this.zoomTo(1, true, null, _originalEvent);\n      }\n      return this;\n    },\n    // Reset the image to its initial state\n    reset: function reset() {\n      if (this.viewed && !this.played) {\n        this.imageData = assign({}, this.initialImageData);\n        this.renderImage();\n      }\n      return this;\n    },\n    // Update viewer when images changed\n    update: function update() {\n      var _this12 = this;\n      var element = this.element,\n        options = this.options,\n        isImg = this.isImg;\n\n      // Destroy viewer if the target image was deleted\n      if (isImg && !element.parentNode) {\n        return this.destroy();\n      }\n      var images = [];\n      forEach(isImg ? [element] : element.querySelectorAll('img'), function (image) {\n        if (isFunction(options.filter)) {\n          if (options.filter.call(_this12, image)) {\n            images.push(image);\n          }\n        } else if (_this12.getImageURL(image)) {\n          images.push(image);\n        }\n      });\n      if (!images.length) {\n        return this;\n      }\n      this.images = images;\n      this.length = images.length;\n      if (this.ready) {\n        var changedIndexes = [];\n        forEach(this.items, function (item, i) {\n          var img = item.querySelector('img');\n          var image = images[i];\n          if (image && img) {\n            if (image.src !== img.src\n\n            // Title changed (#408)\n            || image.alt !== img.alt) {\n              changedIndexes.push(i);\n            }\n          } else {\n            changedIndexes.push(i);\n          }\n        });\n        setStyle(this.list, {\n          width: 'auto'\n        });\n        this.initList();\n        if (this.isShown) {\n          if (this.length) {\n            if (this.viewed) {\n              var changedIndex = changedIndexes.indexOf(this.index);\n              if (changedIndex >= 0) {\n                this.viewed = false;\n                this.view(Math.max(Math.min(this.index - changedIndex, this.length - 1), 0));\n              } else {\n                var activeItem = this.items[this.index];\n\n                // Reactivate the current viewing item after reset the list.\n                addClass(activeItem, CLASS_ACTIVE);\n                activeItem.setAttribute('aria-selected', true);\n              }\n            }\n          } else {\n            this.image = null;\n            this.viewed = false;\n            this.index = 0;\n            this.imageData = {};\n            this.canvas.innerHTML = '';\n            this.title.innerHTML = '';\n          }\n        }\n      } else {\n        this.build();\n      }\n      return this;\n    },\n    // Destroy the viewer\n    destroy: function destroy() {\n      var element = this.element,\n        options = this.options;\n      if (!element[NAMESPACE]) {\n        return this;\n      }\n      this.destroyed = true;\n      if (this.ready) {\n        if (this.played) {\n          this.stop();\n        }\n        if (options.inline) {\n          if (this.fulled) {\n            this.exit();\n          }\n          this.unbind();\n        } else if (this.isShown) {\n          if (this.viewing) {\n            if (this.imageRendering) {\n              this.imageRendering.abort();\n            } else if (this.imageInitializing) {\n              this.imageInitializing.abort();\n            }\n          }\n          if (this.hiding) {\n            this.transitioning.abort();\n          }\n          this.hidden();\n        } else if (this.showing) {\n          this.transitioning.abort();\n          this.hidden();\n        }\n        this.ready = false;\n        this.viewer.parentNode.removeChild(this.viewer);\n      } else if (options.inline) {\n        if (this.delaying) {\n          this.delaying.abort();\n        } else if (this.initializing) {\n          this.initializing.abort();\n        }\n      }\n      if (!options.inline) {\n        removeListener(element, EVENT_CLICK, this.onStart);\n      }\n      element[NAMESPACE] = undefined;\n      return this;\n    }\n  };\n\n  var others = {\n    getImageURL: function getImageURL(image) {\n      var url = this.options.url;\n      if (isString(url)) {\n        url = image.getAttribute(url);\n      } else if (isFunction(url)) {\n        url = url.call(this, image);\n      } else {\n        url = '';\n      }\n      return url;\n    },\n    enforceFocus: function enforceFocus() {\n      var _this = this;\n      this.clearEnforceFocus();\n      addListener(document, EVENT_FOCUSIN, this.onFocusin = function (event) {\n        var viewer = _this.viewer;\n        var target = event.target;\n        if (target === document || target === viewer || viewer.contains(target)) {\n          return;\n        }\n        while (target) {\n          // Avoid conflicts with other modals (#474, #540)\n          if (target.getAttribute('tabindex') !== null || target.getAttribute('aria-modal') === 'true') {\n            return;\n          }\n          target = target.parentElement;\n        }\n        viewer.focus();\n      });\n    },\n    clearEnforceFocus: function clearEnforceFocus() {\n      if (this.onFocusin) {\n        removeListener(document, EVENT_FOCUSIN, this.onFocusin);\n        this.onFocusin = null;\n      }\n    },\n    open: function open() {\n      var body = this.body;\n      addClass(body, CLASS_OPEN);\n      if (this.scrollbarWidth > 0) {\n        body.style.paddingRight = \"\".concat(this.scrollbarWidth + (parseFloat(this.initialBodyComputedPaddingRight) || 0), \"px\");\n      }\n    },\n    close: function close() {\n      var body = this.body;\n      removeClass(body, CLASS_OPEN);\n      if (this.scrollbarWidth > 0) {\n        body.style.paddingRight = this.initialBodyPaddingRight;\n      }\n    },\n    shown: function shown() {\n      var element = this.element,\n        options = this.options,\n        viewer = this.viewer;\n      this.fulled = true;\n      this.isShown = true;\n      this.render();\n      this.bind();\n      this.showing = false;\n      if (options.focus) {\n        viewer.focus();\n        this.enforceFocus();\n      }\n      if (isFunction(options.shown)) {\n        addListener(element, EVENT_SHOWN, options.shown, {\n          once: true\n        });\n      }\n      if (dispatchEvent(element, EVENT_SHOWN) === false) {\n        return;\n      }\n      if (this.ready && this.isShown && !this.hiding) {\n        this.view(this.index);\n      }\n    },\n    hidden: function hidden() {\n      var element = this.element,\n        options = this.options,\n        viewer = this.viewer;\n      if (options.fucus) {\n        this.clearEnforceFocus();\n      }\n      this.close();\n      this.unbind();\n      addClass(viewer, CLASS_HIDE);\n      viewer.removeAttribute('role');\n      viewer.removeAttribute('aria-labelledby');\n      viewer.removeAttribute('aria-modal');\n      viewer.setAttribute('aria-hidden', true);\n      this.resetList();\n      this.resetImage();\n      this.fulled = false;\n      this.viewed = false;\n      this.isShown = false;\n      this.hiding = false;\n      if (!this.destroyed) {\n        if (isFunction(options.hidden)) {\n          addListener(element, EVENT_HIDDEN, options.hidden, {\n            once: true\n          });\n        }\n        dispatchEvent(element, EVENT_HIDDEN, null, {\n          cancelable: false\n        });\n      }\n    },\n    requestFullscreen: function requestFullscreen(options) {\n      var document = this.element.ownerDocument;\n      if (this.fulled && !(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n        var documentElement = document.documentElement;\n\n        // Element.requestFullscreen()\n        if (documentElement.requestFullscreen) {\n          // Avoid TypeError when convert `options` to dictionary\n          if (isPlainObject(options)) {\n            documentElement.requestFullscreen(options);\n          } else {\n            documentElement.requestFullscreen();\n          }\n        } else if (documentElement.webkitRequestFullscreen) {\n          documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n        } else if (documentElement.mozRequestFullScreen) {\n          documentElement.mozRequestFullScreen();\n        } else if (documentElement.msRequestFullscreen) {\n          documentElement.msRequestFullscreen();\n        }\n      }\n    },\n    exitFullscreen: function exitFullscreen() {\n      var document = this.element.ownerDocument;\n      if (this.fulled && (document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n        // Document.exitFullscreen()\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        }\n      }\n    },\n    change: function change(event) {\n      var options = this.options,\n        pointers = this.pointers;\n      var pointer = pointers[Object.keys(pointers)[0]];\n\n      // In the case of the `pointers` object is empty (#421)\n      if (!pointer) {\n        return;\n      }\n      var offsetX = pointer.endX - pointer.startX;\n      var offsetY = pointer.endY - pointer.startY;\n      switch (this.action) {\n        // Move the current image\n        case ACTION_MOVE:\n          if (offsetX !== 0 || offsetY !== 0) {\n            this.pointerMoved = true;\n            this.move(offsetX, offsetY, event);\n          }\n          break;\n\n        // Zoom the current image\n        case ACTION_ZOOM:\n          this.zoom(getMaxZoomRatio(pointers), false, null, event);\n          break;\n        case ACTION_SWITCH:\n          {\n            this.action = 'switched';\n            var absoluteOffsetX = Math.abs(offsetX);\n            if (absoluteOffsetX > 1 && absoluteOffsetX > Math.abs(offsetY)) {\n              // Empty `pointers` as `touchend` event will not be fired after swiped in iOS browsers.\n              this.pointers = {};\n              if (offsetX > 1) {\n                this.prev(options.loop);\n              } else if (offsetX < -1) {\n                this.next(options.loop);\n              }\n            }\n            break;\n          }\n      }\n\n      // Override\n      forEach(pointers, function (p) {\n        p.startX = p.endX;\n        p.startY = p.endY;\n      });\n    },\n    isSwitchable: function isSwitchable() {\n      var imageData = this.imageData,\n        viewerData = this.viewerData;\n      return this.length > 1 && imageData.x >= 0 && imageData.y >= 0 && imageData.width <= viewerData.width && imageData.height <= viewerData.height;\n    }\n  };\n\n  var AnotherViewer = WINDOW.Viewer;\n  var getUniqueID = function (id) {\n    return function () {\n      id += 1;\n      return id;\n    };\n  }(-1);\n  var Viewer = /*#__PURE__*/function () {\n    /**\n     * Create a new Viewer.\n     * @param {Element} element - The target element for viewing.\n     * @param {Object} [options={}] - The configuration options.\n     */\n    function Viewer(element) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      _classCallCheck(this, Viewer);\n      if (!element || element.nodeType !== 1) {\n        throw new Error('The first argument is required and must be an element.');\n      }\n      this.element = element;\n      this.options = assign({}, DEFAULTS, isPlainObject(options) && options);\n      this.action = false;\n      this.fading = false;\n      this.fulled = false;\n      this.hiding = false;\n      this.imageClicked = false;\n      this.imageData = {};\n      this.index = this.options.initialViewIndex;\n      this.isImg = false;\n      this.isShown = false;\n      this.length = 0;\n      this.moving = false;\n      this.played = false;\n      this.playing = false;\n      this.pointers = {};\n      this.ready = false;\n      this.rotating = false;\n      this.scaling = false;\n      this.showing = false;\n      this.timeout = false;\n      this.tooltipping = false;\n      this.viewed = false;\n      this.viewing = false;\n      this.wheeling = false;\n      this.zooming = false;\n      this.pointerMoved = false;\n      this.id = getUniqueID();\n      this.init();\n    }\n    _createClass(Viewer, [{\n      key: \"init\",\n      value: function init() {\n        var _this = this;\n        var element = this.element,\n          options = this.options;\n        if (element[NAMESPACE]) {\n          return;\n        }\n        element[NAMESPACE] = this;\n\n        // The `focus` option requires the `keyboard` option set to `true`.\n        if (options.focus && !options.keyboard) {\n          options.focus = false;\n        }\n        var isImg = element.localName === 'img';\n        var images = [];\n        forEach(isImg ? [element] : element.querySelectorAll('img'), function (image) {\n          if (isFunction(options.filter)) {\n            if (options.filter.call(_this, image)) {\n              images.push(image);\n            }\n          } else if (_this.getImageURL(image)) {\n            images.push(image);\n          }\n        });\n        this.isImg = isImg;\n        this.length = images.length;\n        this.images = images;\n        this.initBody();\n\n        // Override `transition` option if it is not supported\n        if (isUndefined(document.createElement(NAMESPACE).style.transition)) {\n          options.transition = false;\n        }\n        if (options.inline) {\n          var count = 0;\n          var progress = function progress() {\n            count += 1;\n            if (count === _this.length) {\n              var timeout;\n              _this.initializing = false;\n              _this.delaying = {\n                abort: function abort() {\n                  clearTimeout(timeout);\n                }\n              };\n\n              // build asynchronously to keep `this.viewer` is accessible in `ready` event handler.\n              timeout = setTimeout(function () {\n                _this.delaying = false;\n                _this.build();\n              }, 0);\n            }\n          };\n          this.initializing = {\n            abort: function abort() {\n              forEach(images, function (image) {\n                if (!image.complete) {\n                  removeListener(image, EVENT_LOAD, progress);\n                  removeListener(image, EVENT_ERROR, progress);\n                }\n              });\n            }\n          };\n          forEach(images, function (image) {\n            if (image.complete) {\n              progress();\n            } else {\n              var onLoad;\n              var onError;\n              addListener(image, EVENT_LOAD, onLoad = function onLoad() {\n                removeListener(image, EVENT_ERROR, onError);\n                progress();\n              }, {\n                once: true\n              });\n              addListener(image, EVENT_ERROR, onError = function onError() {\n                removeListener(image, EVENT_LOAD, onLoad);\n                progress();\n              }, {\n                once: true\n              });\n            }\n          });\n        } else {\n          addListener(element, EVENT_CLICK, this.onStart = function (_ref) {\n            var target = _ref.target;\n            if (target.localName === 'img' && (!isFunction(options.filter) || options.filter.call(_this, target))) {\n              _this.view(_this.images.indexOf(target));\n            }\n          });\n        }\n      }\n    }, {\n      key: \"build\",\n      value: function build() {\n        if (this.ready) {\n          return;\n        }\n        var element = this.element,\n          options = this.options;\n        var parent = element.parentNode;\n        var template = document.createElement('div');\n        template.innerHTML = TEMPLATE;\n        var viewer = template.querySelector(\".\".concat(NAMESPACE, \"-container\"));\n        var title = viewer.querySelector(\".\".concat(NAMESPACE, \"-title\"));\n        var toolbar = viewer.querySelector(\".\".concat(NAMESPACE, \"-toolbar\"));\n        var navbar = viewer.querySelector(\".\".concat(NAMESPACE, \"-navbar\"));\n        var button = viewer.querySelector(\".\".concat(NAMESPACE, \"-button\"));\n        var canvas = viewer.querySelector(\".\".concat(NAMESPACE, \"-canvas\"));\n        this.parent = parent;\n        this.viewer = viewer;\n        this.title = title;\n        this.toolbar = toolbar;\n        this.navbar = navbar;\n        this.button = button;\n        this.canvas = canvas;\n        this.footer = viewer.querySelector(\".\".concat(NAMESPACE, \"-footer\"));\n        this.tooltipBox = viewer.querySelector(\".\".concat(NAMESPACE, \"-tooltip\"));\n        this.player = viewer.querySelector(\".\".concat(NAMESPACE, \"-player\"));\n        this.list = viewer.querySelector(\".\".concat(NAMESPACE, \"-list\"));\n        viewer.id = \"\".concat(NAMESPACE).concat(this.id);\n        title.id = \"\".concat(NAMESPACE, \"Title\").concat(this.id);\n        addClass(title, !options.title ? CLASS_HIDE : getResponsiveClass(Array.isArray(options.title) ? options.title[0] : options.title));\n        addClass(navbar, !options.navbar ? CLASS_HIDE : getResponsiveClass(options.navbar));\n        toggleClass(button, CLASS_HIDE, !options.button);\n        if (options.keyboard) {\n          button.setAttribute('tabindex', 0);\n        }\n        if (options.backdrop) {\n          addClass(viewer, \"\".concat(NAMESPACE, \"-backdrop\"));\n          if (!options.inline && options.backdrop !== 'static') {\n            setData(canvas, DATA_ACTION, 'hide');\n          }\n        }\n        if (isString(options.className) && options.className) {\n          // In case there are multiple class names\n          options.className.split(REGEXP_SPACES).forEach(function (className) {\n            addClass(viewer, className);\n          });\n        }\n        if (options.toolbar) {\n          var list = document.createElement('ul');\n          var custom = isPlainObject(options.toolbar);\n          var zoomButtons = BUTTONS.slice(0, 3);\n          var rotateButtons = BUTTONS.slice(7, 9);\n          var scaleButtons = BUTTONS.slice(9);\n          if (!custom) {\n            addClass(toolbar, getResponsiveClass(options.toolbar));\n          }\n          forEach(custom ? options.toolbar : BUTTONS, function (value, index) {\n            var deep = custom && isPlainObject(value);\n            var name = custom ? hyphenate(index) : value;\n            var show = deep && !isUndefined(value.show) ? value.show : value;\n            if (!show || !options.zoomable && zoomButtons.indexOf(name) !== -1 || !options.rotatable && rotateButtons.indexOf(name) !== -1 || !options.scalable && scaleButtons.indexOf(name) !== -1) {\n              return;\n            }\n            var size = deep && !isUndefined(value.size) ? value.size : value;\n            var click = deep && !isUndefined(value.click) ? value.click : value;\n            var item = document.createElement('li');\n            if (options.keyboard) {\n              item.setAttribute('tabindex', 0);\n            }\n            item.setAttribute('role', 'button');\n            addClass(item, \"\".concat(NAMESPACE, \"-\").concat(name));\n            if (!isFunction(click)) {\n              setData(item, DATA_ACTION, name);\n            }\n            if (isNumber(show)) {\n              addClass(item, getResponsiveClass(show));\n            }\n            if (['small', 'large'].indexOf(size) !== -1) {\n              addClass(item, \"\".concat(NAMESPACE, \"-\").concat(size));\n            } else if (name === 'play') {\n              addClass(item, \"\".concat(NAMESPACE, \"-large\"));\n            }\n            if (isFunction(click)) {\n              addListener(item, EVENT_CLICK, click);\n            }\n            list.appendChild(item);\n          });\n          toolbar.appendChild(list);\n        } else {\n          addClass(toolbar, CLASS_HIDE);\n        }\n        if (!options.rotatable) {\n          var rotates = toolbar.querySelectorAll('li[class*=\"rotate\"]');\n          addClass(rotates, CLASS_INVISIBLE);\n          forEach(rotates, function (rotate) {\n            toolbar.appendChild(rotate);\n          });\n        }\n        if (options.inline) {\n          addClass(button, CLASS_FULLSCREEN);\n          setStyle(viewer, {\n            zIndex: options.zIndexInline\n          });\n          if (window.getComputedStyle(parent).position === 'static') {\n            setStyle(parent, {\n              position: 'relative'\n            });\n          }\n          parent.insertBefore(viewer, element.nextSibling);\n        } else {\n          addClass(button, CLASS_CLOSE);\n          addClass(viewer, CLASS_FIXED);\n          addClass(viewer, CLASS_FADE);\n          addClass(viewer, CLASS_HIDE);\n          setStyle(viewer, {\n            zIndex: options.zIndex\n          });\n          var container = options.container;\n          if (isString(container)) {\n            container = element.ownerDocument.querySelector(container);\n          }\n          if (!container) {\n            container = this.body;\n          }\n          container.appendChild(viewer);\n        }\n        if (options.inline) {\n          this.render();\n          this.bind();\n          this.isShown = true;\n        }\n        this.ready = true;\n        if (isFunction(options.ready)) {\n          addListener(element, EVENT_READY, options.ready, {\n            once: true\n          });\n        }\n        if (dispatchEvent(element, EVENT_READY) === false) {\n          this.ready = false;\n          return;\n        }\n        if (this.ready && options.inline) {\n          this.view(this.index);\n        }\n      }\n\n      /**\n       * Get the no conflict viewer class.\n       * @returns {Viewer} The viewer class.\n       */\n    }], [{\n      key: \"noConflict\",\n      value: function noConflict() {\n        window.Viewer = AnotherViewer;\n        return Viewer;\n      }\n\n      /**\n       * Change the default options.\n       * @param {Object} options - The new default options.\n       */\n    }, {\n      key: \"setDefaults\",\n      value: function setDefaults(options) {\n        assign(DEFAULTS, isPlainObject(options) && options);\n      }\n    }]);\n    return Viewer;\n  }();\n  assign(Viewer.prototype, render, events, handlers, methods, others);\n\n  return Viewer;\n\n}));\n"]},"metadata":{},"sourceType":"script"}